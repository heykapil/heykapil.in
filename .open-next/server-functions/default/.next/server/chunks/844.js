"use strict";exports.id=844,exports.ids=[844],exports.modules={94320:(e,t,r)=>{r.d(t,{kHw:()=>t0});let i=async(e,t,r)=>await t({name:e,setAttributes:()=>{}}),n={KIND:"xata.trace.kind",VERSION:"xata.sdk.version",TABLE:"xata.table",HTTP_REQUEST_ID:"http.request_id",HTTP_STATUS_CODE:"http.status_code",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_ROUTE:"http.route",HTTP_TARGET:"http.target",CLOUDFLARE_RAY_ID:"cf.ray"};function s(e){return null!=e}function o(e){return e.filter(s)}function a(e){return Object.fromEntries(Object.entries(e).filter(([,e])=>s(e)))}function d(e){try{return e instanceof Blob}catch(e){return!1}}function h(e){return!!e&&"object"==typeof e&&!Array.isArray(e)&&!(e instanceof Date)&&!d(e)}function l(e){return null!=e}function c(e){return l(e)&&"string"==typeof e}function u(e){return l(e)&&Array.isArray(e)&&e.every(c)}function p(e){return l(e)&&"number"==typeof e}function m(e,t){let r=[];for(let i=0;i<e.length;i+=t)r.push(e.slice(i,i+t));return r}async function f(e){return new Promise(t=>setTimeout(t,e))}function y(e,t){return e.reduce((e,r)=>e.then(e=>t(r).then(t=>(e.push(t),e))),Promise.resolve([]))}function N(){try{if(l(process)&&l(process.env))return{apiKey:process.env.XATA_API_KEY??b(),databaseURL:process.env.XATA_DATABASE_URL??w(),branch:process.env.XATA_BRANCH??g(),deployPreview:process.env.XATA_PREVIEW,deployPreviewBranch:process.env.XATA_PREVIEW_BRANCH,vercelGitCommitRef:process.env.VERCEL_GIT_COMMIT_REF,vercelGitRepoOwner:process.env.VERCEL_GIT_REPO_OWNER}}catch(e){}try{if(h(Deno)&&h(Deno.env))return{apiKey:Deno.env.get("XATA_API_KEY")??b(),databaseURL:Deno.env.get("XATA_DATABASE_URL")??w(),branch:Deno.env.get("XATA_BRANCH")??g(),deployPreview:Deno.env.get("XATA_PREVIEW"),deployPreviewBranch:Deno.env.get("XATA_PREVIEW_BRANCH"),vercelGitCommitRef:Deno.env.get("VERCEL_GIT_COMMIT_REF"),vercelGitRepoOwner:Deno.env.get("VERCEL_GIT_REPO_OWNER")}}catch(e){}return{apiKey:b(),databaseURL:w(),branch:g(),deployPreview:void 0,deployPreviewBranch:void 0,vercelGitCommitRef:void 0,vercelGitRepoOwner:void 0}}function b(){try{return XATA_API_KEY}catch(e){return}}function w(){try{return XATA_DATABASE_URL}catch(e){return}}function g(){try{return XATA_BRANCH}catch(e){return}}var v,k,x,I,T,O,C,B,W,V,A,q,S,E,P,D,_,L,R,M,U,F,j,$,Q,J,K,z,H,G,X,Z,Y,ee,et,er,ei,en,es,eo,ea,ed,eh,el,ec,eu,ep,em,ef,ey,eN=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},eb=(e,t,r)=>(eN(e,t,"read from private field"),r?r.call(e):t.get(e)),ew=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},eg=(e,t,r,i)=>(eN(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),ev=(e,t,r)=>(eN(e,t,"access private method"),r);class ek{constructor(e=10){ew(this,I),ew(this,v,void 0),ew(this,k,void 0),ew(this,x,void 0),eg(this,k,[]),eg(this,x,e),this.running=0,this.started=0}setFetch(e){eg(this,v,e)}getFetch(){if(!eb(this,v))throw Error("Fetch not set");return eb(this,v)}request(e,t){let r=new Date,i=this.getFetch(),n=async(s=!1)=>{let o;let{promise:a,cancel:d}={cancel:()=>clearTimeout(o),promise:new Promise(e=>{o=setTimeout(()=>{e()},3e5)})},h=await Promise.race([i(e,t),a.then(()=>null)]).finally(d);if(!h)throw Error("Request timed out");if(429===h.status){let e=function(e){if(p(e))return e;if(c(e)){let t=Number(e);if(!Number.isNaN(t))return t}}(h.headers?.get("x-ratelimit-reset"))??1;return await f(1e3*e),await n(!0)}if(s){let e=new Date().getTime()-r.getTime();console.warn(`A request to Xata hit branch rate limits, was retried and stalled for ${e}ms`)}return h};return ev(this,I,T).call(this,async()=>await n())}}function ex(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}async function eI(e,t){let r;let i=e.getReader();for(;!(r=await i.read()).done;)t(r.value)}function eT(){return{data:"",event:"",id:"",retry:void 0}}v=new WeakMap,k=new WeakMap,x=new WeakMap,I=new WeakSet,T=function(e){let t=new Promise(e=>eb(this,k).push(e)).finally(()=>{this.started--,this.running++}).then(()=>e()).finally(()=>{this.running--;let e=eb(this,k).shift();void 0!==e&&(this.started++,e())});if(this.running+this.started<eb(this,x)){let e=eb(this,k).shift();void 0!==e&&(this.started++,e())}return t};let eO="text/event-stream",eC="last-event-id";function eB(e){let t=e.headers?.get("content-type");if(!t?.startsWith(eO))throw Error(`Expected content-type to be ${eO}, Actual: ${t}`)}let eW="0.28.4";class eV extends Error{constructor(e,t){super(e,t)}}class eA extends eV{constructor(e,t,r){super(eS(t)),this.status=e,this.errors=eq(t)?t.errors:[{message:eS(t),status:e}],this.requestId=r,t instanceof Error&&(this.stack=t.stack,this.cause=t.cause)}toString(){let e=super.toString();return`[${this.status}] (${this.requestId??"Unknown"}): ${e}`}}function eq(e){return h(e)&&Array.isArray(e.errors)}function eS(e){return e instanceof Error?e.message:c(e)?e:h(e)&&c(e.message)?e.message:eq(e)?"Bulk operation failed":"Unexpected error"}let eE={production:{main:"https://api.xata.io",workspaces:"https://{workspaceId}.{region}.xata.sh"},staging:{main:"https://api.staging-xata.dev",workspaces:"https://{workspaceId}.{region}.staging-xata.dev"},dev:{main:"https://api.dev-xata.dev",workspaces:"https://{workspaceId}.{region}.dev-xata.dev"},local:{main:"http://localhost:6001",workspaces:"http://{workspaceId}.{region}.localhost:6001"}},eP=new ek,eD=(e,t={},r={})=>{let i=new URLSearchParams(Object.entries(t).reduce((e,[t,r])=>null==r?e:{...e,[t]:r},{})).toString(),n=i.length>0?`?${i}`:"",s=Object.entries(r).reduce((e,[t,r])=>({...e,[t]:encodeURIComponent(String(r??"")).replace("%3A",":")}),{});return e.replace(/\{\w*\}/g,e=>s[e.slice(1,-1)])+n};function e_({method:e,endpoint:t,path:r,workspacesApiUrl:i,apiUrl:n,pathParams:s={}}){if("dataPlane"===t){let t=c(i)?`${i}${r}`:i(r,s);if("PUT"===e.toUpperCase()&&["/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file","/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}"].includes(r)){let{host:e}=function(e){if(!c(e))return null;let[t,r]=Object.entries({production:e.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.xata\.sh.*/),staging:e.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.staging-xata\.dev.*/),dev:e.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.dev-xata\.dev.*/),local:e.match(/(?:https?:\/\/)?([^.]+)(?:\.([^.]+))\.localhost:(\d+)/)}).find(([,e])=>null!==e)??[];return c(t)&&Object.keys(eE).includes(t)&&r?{workspace:r[1],region:r[2],host:t}:null}(t)??{};switch(e){case"production":t=t.replace("xata.sh","upload.xata.sh");break;case"staging":t=t.replace("staging-xata.dev","upload.staging-xata.dev");break;case"dev":t=t.replace("dev-xata.dev","upload.dev-xata.dev")}}let n=c(s.workspace)?t.replace("{workspaceId}",String(s.workspace)):t;return c(s.region)?n.replace("{region}",String(s.region)):n}return`${n}${r}`}async function eL(e,t){if(!l(e))return;if(d(e)||"function"==typeof e.text)return e;let{"Content-Type":r}=t??{};return"application/json"===String(r).toLowerCase()&&h(e)?JSON.stringify(e):e}let eR=ex();async function eM({url:e,method:t,body:r,headers:i,pathParams:s,queryParams:d,fetch:h,apiKey:c,endpoint:u,apiUrl:p,workspacesApiUrl:m,trace:f,signal:y,clientID:N,sessionID:b,clientName:w,xataAgentExtra:g,fetchOptions:v={},rawResponse:k=!1}){return eP.setFetch(h),await f(`${t.toUpperCase()} ${e}`,async({setAttributes:h})=>{let f=eD(e_({method:t,endpoint:u,path:e,workspacesApiUrl:m,pathParams:s,apiUrl:p}),d,s),x=f.includes("localhost")?f.replace(/^[^.]+\.[^.]+\./,"http://"):f;h({[n.HTTP_URL]:x,[n.HTTP_TARGET]:eD(e,d,s)});let I=o([["client","TS_SDK"],["version",eW],l(w)?["service",w]:void 0,...Object.entries(g??{})]).map(([e,t])=>`${e}=${t}`).join("; "),T=a({"Accept-Encoding":"identity","Content-Type":"application/json","X-Xata-Client-ID":N??eR,"X-Xata-Session-ID":b??ex(),"X-Xata-Agent":I,...i,...function(e){let{groups:t}=/.*:\/\/(?<host>[^/]+).*/.exec(e)??{};return t?.host?{Host:t.host}:{}}(f),Authorization:`Bearer ${c}`}),O=await eP.request(x,{...v,method:t.toUpperCase(),body:await eL(r,T),headers:T,signal:y}),{host:C,protocol:B}=function(e){try{let{host:t,protocol:r}=new URL(e);return{host:t,protocol:r}}catch(e){return{}}}(O.url),W=O.headers?.get("x-request-id")??void 0;h({[n.KIND]:"http",[n.HTTP_REQUEST_ID]:W,[n.HTTP_STATUS_CODE]:O.status,[n.HTTP_HOST]:C,[n.HTTP_SCHEME]:B?.replace(":",""),[n.CLOUDFLARE_RAY_ID]:O.headers?.get("cf-ray")??void 0});let V=O.headers?.get("x-xata-message");if(V&&console.warn(V),204===O.status)return{};if(429===O.status)throw new eA(O.status,"Rate limit exceeded",W);try{let e=k?await O.blob():await O.json();if(O.ok)return e;throw new eA(O.status,e,W)}catch(e){throw new eA(O.status,e,W)}},{[n.HTTP_METHOD]:t.toUpperCase(),[n.HTTP_ROUTE]:e})}let eU=async e=>eM({...e,endpoint:"dataPlane"}),eF=(e,t)=>eU({url:"/db/{dbBranchName}",method:"get",...e,signal:t}),ej=(e,t)=>eU({url:"/db/{dbBranchName}/transaction",method:"post",...e,signal:t}),e$=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data",method:"post",...e,signal:t}),eQ=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"get",...e,signal:t}),eJ=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"put",...e,signal:t}),eK=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"delete",...e,signal:t}),ez=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"get",...e,signal:t}),eH=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"put",...e,signal:t}),eG=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"patch",...e,signal:t}),eX=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"post",...e,signal:t}),eZ=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"delete",...e,signal:t}),eY=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/query",method:"post",...e,signal:t}),e0=(e,t)=>eU({url:"/db/{dbBranchName}/search",method:"post",...e,signal:t}),e1=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/search",method:"post",...e,signal:t}),e2=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/vectorSearch",method:"post",...e,signal:t}),e8=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/ask/{sessionId}",method:"post",...e,signal:t}),e4=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/summarize",method:"post",...e,signal:t}),e6=(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/aggregate",method:"post",...e,signal:t}),e5=(e,t)=>eU({url:"/db/{dbBranchName}/sql",method:"post",...e,signal:t}),e3=async e=>eM({...e,endpoint:"controlPlane"});!function e(t,r){let i={...t};for(let[t,n]of Object.entries(r))h(n)&&h(i[t])?i[t]=e(i[t],n):i[t]=n;return i}({branch:{applyMigration:(e,t)=>eU({url:"/db/{dbBranchName}/pgroll/apply",method:"post",...e,signal:t}),pgRollStatus:(e,t)=>eU({url:"/db/{dbBranchName}/pgroll/status",method:"get",...e,signal:t}),pgRollJobStatus:(e,t)=>eU({url:"/db/{dbBranchName}/pgroll/jobs/{jobId}",method:"get",...e,signal:t}),pgRollMigrationHistory:(e,t)=>eU({url:"/db/{dbBranchName}/pgroll/migrations",method:"get",...e,signal:t}),getBranchList:(e,t)=>eU({url:"/dbs/{dbName}",method:"get",...e,signal:t}),getBranchDetails:eF,createBranch:(e,t)=>eU({url:"/db/{dbBranchName}",method:"put",...e,signal:t}),deleteBranch:(e,t)=>eU({url:"/db/{dbBranchName}",method:"delete",...e,signal:t}),copyBranch:(e,t)=>eU({url:"/db/{dbBranchName}/copy",method:"post",...e,signal:t}),updateBranchMetadata:(e,t)=>eU({url:"/db/{dbBranchName}/metadata",method:"put",...e,signal:t}),getBranchMetadata:(e,t)=>eU({url:"/db/{dbBranchName}/metadata",method:"get",...e,signal:t}),getBranchStats:(e,t)=>eU({url:"/db/{dbBranchName}/stats",method:"get",...e,signal:t}),getGitBranchesMapping:(e,t)=>eU({url:"/dbs/{dbName}/gitBranches",method:"get",...e,signal:t}),addGitBranchesEntry:(e,t)=>eU({url:"/dbs/{dbName}/gitBranches",method:"post",...e,signal:t}),removeGitBranchesEntry:(e,t)=>eU({url:"/dbs/{dbName}/gitBranches",method:"delete",...e,signal:t}),resolveBranch:(e,t)=>eU({url:"/dbs/{dbName}/resolveBranch",method:"get",...e,signal:t})},migrations:{getSchema:(e,t)=>eU({url:"/db/{dbBranchName}/schema",method:"get",...e,signal:t}),getBranchMigrationHistory:(e,t)=>eU({url:"/db/{dbBranchName}/migrations",method:"get",...e,signal:t}),getBranchMigrationPlan:(e,t)=>eU({url:"/db/{dbBranchName}/migrations/plan",method:"post",...e,signal:t}),executeBranchMigrationPlan:(e,t)=>eU({url:"/db/{dbBranchName}/migrations/execute",method:"post",...e,signal:t}),getBranchSchemaHistory:(e,t)=>eU({url:"/db/{dbBranchName}/schema/history",method:"post",...e,signal:t}),compareBranchWithUserSchema:(e,t)=>eU({url:"/db/{dbBranchName}/schema/compare",method:"post",...e,signal:t}),compareBranchSchemas:(e,t)=>eU({url:"/db/{dbBranchName}/schema/compare/{branchName}",method:"post",...e,signal:t}),updateBranchSchema:(e,t)=>eU({url:"/db/{dbBranchName}/schema/update",method:"post",...e,signal:t}),previewBranchSchemaEdit:(e,t)=>eU({url:"/db/{dbBranchName}/schema/preview",method:"post",...e,signal:t}),applyBranchSchemaEdit:(e,t)=>eU({url:"/db/{dbBranchName}/schema/apply",method:"post",...e,signal:t}),pushBranchMigrations:(e,t)=>eU({url:"/db/{dbBranchName}/schema/push",method:"post",...e,signal:t})},migrationRequests:{queryMigrationRequests:(e,t)=>eU({url:"/dbs/{dbName}/migrations/query",method:"post",...e,signal:t}),createMigrationRequest:(e,t)=>eU({url:"/dbs/{dbName}/migrations",method:"post",...e,signal:t}),getMigrationRequest:(e,t)=>eU({url:"/dbs/{dbName}/migrations/{mrNumber}",method:"get",...e,signal:t}),updateMigrationRequest:(e,t)=>eU({url:"/dbs/{dbName}/migrations/{mrNumber}",method:"patch",...e,signal:t}),listMigrationRequestsCommits:(e,t)=>eU({url:"/dbs/{dbName}/migrations/{mrNumber}/commits",method:"post",...e,signal:t}),compareMigrationRequest:(e,t)=>eU({url:"/dbs/{dbName}/migrations/{mrNumber}/compare",method:"post",...e,signal:t}),getMigrationRequestIsMerged:(e,t)=>eU({url:"/dbs/{dbName}/migrations/{mrNumber}/merge",method:"get",...e,signal:t}),mergeMigrationRequest:(e,t)=>eU({url:"/dbs/{dbName}/migrations/{mrNumber}/merge",method:"post",...e,signal:t})},table:{createTable:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}",method:"put",...e,signal:t}),deleteTable:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}",method:"delete",...e,signal:t}),updateTable:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}",method:"patch",...e,signal:t}),getTableSchema:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/schema",method:"get",...e,signal:t}),setTableSchema:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/schema",method:"put",...e,signal:t}),getTableColumns:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/columns",method:"get",...e,signal:t}),addTableColumn:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/columns",method:"post",...e,signal:t}),getColumn:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"get",...e,signal:t}),updateColumn:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"patch",...e,signal:t}),deleteColumn:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"delete",...e,signal:t})},records:{branchTransaction:ej,insertRecord:e$,getRecord:ez,insertRecordWithID:eH,updateRecordWithID:eG,upsertRecordWithID:eX,deleteRecord:eZ,bulkInsertTableRecords:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/bulk",method:"post",...e,signal:t})},files:{getFileItem:eQ,putFileItem:eJ,deleteFileItem:eK,getFile:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"get",...e,signal:t}),putFile:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"put",...e,signal:t}),deleteFile:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"delete",...e,signal:t}),fileAccess:(e,t)=>eU({url:"/file/{fileId}",method:"get",...e,signal:t}),fileUpload:(e,t)=>eU({url:"/file/{fileId}",method:"put",...e,signal:t})},searchAndFilter:{queryTable:eY,searchBranch:e0,searchTable:e1,vectorSearchTable:e2,askTable:(e,t)=>eU({url:"/db/{dbBranchName}/tables/{tableName}/ask",method:"post",...e,signal:t}),askTableSession:e8,summarizeTable:e4,aggregateTable:e6},sql:{sqlQuery:e5}},{oAuth:{getAuthorizationCode:(e,t)=>e3({url:"/oauth/authorize",method:"get",...e,signal:t}),grantAuthorizationCode:(e,t)=>e3({url:"/oauth/authorize",method:"post",...e,signal:t}),getUserOAuthClients:(e,t)=>e3({url:"/user/oauth/clients",method:"get",...e,signal:t}),deleteUserOAuthClient:(e,t)=>e3({url:"/user/oauth/clients/{clientId}",method:"delete",...e,signal:t}),getUserOAuthAccessTokens:(e,t)=>e3({url:"/user/oauth/tokens",method:"get",...e,signal:t}),deleteOAuthAccessToken:(e,t)=>e3({url:"/user/oauth/tokens/{token}",method:"delete",...e,signal:t}),updateOAuthAccessToken:(e,t)=>e3({url:"/user/oauth/tokens/{token}",method:"patch",...e,signal:t})},users:{getUser:(e,t)=>e3({url:"/user",method:"get",...e,signal:t}),updateUser:(e,t)=>e3({url:"/user",method:"put",...e,signal:t}),deleteUser:(e,t)=>e3({url:"/user",method:"delete",...e,signal:t})},authentication:{getUserAPIKeys:(e,t)=>e3({url:"/user/keys",method:"get",...e,signal:t}),createUserAPIKey:(e,t)=>e3({url:"/user/keys/{keyName}",method:"post",...e,signal:t}),deleteUserAPIKey:(e,t)=>e3({url:"/user/keys/{keyName}",method:"delete",...e,signal:t})},workspaces:{getWorkspacesList:(e,t)=>e3({url:"/workspaces",method:"get",...e,signal:t}),createWorkspace:(e,t)=>e3({url:"/workspaces",method:"post",...e,signal:t}),getWorkspace:(e,t)=>e3({url:"/workspaces/{workspaceId}",method:"get",...e,signal:t}),updateWorkspace:(e,t)=>e3({url:"/workspaces/{workspaceId}",method:"put",...e,signal:t}),deleteWorkspace:(e,t)=>e3({url:"/workspaces/{workspaceId}",method:"delete",...e,signal:t}),getWorkspaceMembersList:(e,t)=>e3({url:"/workspaces/{workspaceId}/members",method:"get",...e,signal:t}),updateWorkspaceMemberRole:(e,t)=>e3({url:"/workspaces/{workspaceId}/members/{userId}",method:"put",...e,signal:t}),removeWorkspaceMember:(e,t)=>e3({url:"/workspaces/{workspaceId}/members/{userId}",method:"delete",...e,signal:t})},invites:{inviteWorkspaceMember:(e,t)=>e3({url:"/workspaces/{workspaceId}/invites",method:"post",...e,signal:t}),updateWorkspaceMemberInvite:(e,t)=>e3({url:"/workspaces/{workspaceId}/invites/{inviteId}",method:"patch",...e,signal:t}),cancelWorkspaceMemberInvite:(e,t)=>e3({url:"/workspaces/{workspaceId}/invites/{inviteId}",method:"delete",...e,signal:t}),acceptWorkspaceMemberInvite:(e,t)=>e3({url:"/workspaces/{workspaceId}/invites/{inviteKey}/accept",method:"post",...e,signal:t}),resendWorkspaceMemberInvite:(e,t)=>e3({url:"/workspaces/{workspaceId}/invites/{inviteId}/resend",method:"post",...e,signal:t})},xbcontrolOther:{listClusters:(e,t)=>e3({url:"/workspaces/{workspaceId}/clusters",method:"get",...e,signal:t}),createCluster:(e,t)=>e3({url:"/workspaces/{workspaceId}/clusters",method:"post",...e,signal:t}),getCluster:(e,t)=>e3({url:"/workspaces/{workspaceId}/clusters/{clusterId}",method:"get",...e,signal:t}),updateCluster:(e,t)=>e3({url:"/workspaces/{workspaceId}/clusters/{clusterId}",method:"patch",...e,signal:t})},databases:{getDatabaseList:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs",method:"get",...e,signal:t}),createDatabase:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"put",...e,signal:t}),deleteDatabase:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"delete",...e,signal:t}),getDatabaseMetadata:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"get",...e,signal:t}),updateDatabaseMetadata:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"patch",...e,signal:t}),renameDatabase:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}/rename",method:"post",...e,signal:t}),getDatabaseGithubSettings:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"get",...e,signal:t}),updateDatabaseGithubSettings:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"put",...e,signal:t}),deleteDatabaseGithubSettings:(e,t)=>e3({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"delete",...e,signal:t}),listRegions:(e,t)=>e3({url:"/workspaces/{workspaceId}/regions",method:"get",...e,signal:t})}}),new WeakMap,new WeakMap;class e9{}function e7(e,...t){if(!l(e))return;let r=t.flatMap(e=>Object.entries(e).map(([e,t])=>{if("trim"===e){let{left:r=0,top:i=0,right:n=0,bottom:s=0}=t;return`${e}=${[i,n,s,r].join(";")}`}if("gravity"===e&&"object"==typeof t){let{x:r=.5,y:i=.5}=t;return`${e}=${[r,i].join("x")}`}return`${e}=${t}`})).join(","),{hostname:i,pathname:n,search:s}=new URL(e),o=n.split("/"),a=o.findIndex(e=>"transform"===e),d=a>=0?o.splice(a,2):[],h=`/transform/${[d[1],r].filter(l).join(",")}`,c=o.join("/");return`https://${i}${h}${c}${s}`}class te{constructor(e){this.id=e.id,this.name=e.name,this.mediaType=e.mediaType,this.base64Content=e.base64Content,this.enablePublicUrl=e.enablePublicUrl,this.signedUrlTimeout=e.signedUrlTimeout,this.uploadUrlTimeout=e.uploadUrlTimeout,this.size=e.size,this.version=e.version,this.url=e.url,this.signedUrl=e.signedUrl,this.uploadUrl=e.uploadUrl,this.attributes=e.attributes}static fromBuffer(e,t={}){let r=e.toString("base64");return new te({...t,base64Content:r})}toBuffer(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return Buffer.from(this.base64Content,"base64")}static fromArrayBuffer(e,t={}){let r=new Uint8Array(e);return this.fromUint8Array(r,t)}toArrayBuffer(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return new ArrayBuffer(atob(this.base64Content).length)}static fromUint8Array(e,t={}){let r="";for(let t=0;t<e.byteLength;t++)r+=String.fromCharCode(e[t]);let i=btoa(r);return new te({...t,base64Content:i})}toUint8Array(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');let e=atob(this.base64Content),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}static async fromBlob(e,t={}){let r=t.name??e.name,i=e.type,n=await e.arrayBuffer();return this.fromArrayBuffer(n,{...t,name:r,mediaType:i})}toBlob(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');let e=atob(this.base64Content),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new Blob([t],{type:this.mediaType})}static fromString(e,t={}){let r=btoa(e);return new te({...t,base64Content:r})}toString(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return atob(this.base64Content)}static fromBase64(e,t={}){return new te({...t,base64Content:e})}toBase64(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return this.base64Content}transform(...e){return{url:e7(this.url,...e),signedUrl:e7(this.signedUrl,...e),metadataUrl:e7(this.url,...e,{format:"json"}),metadataSignedUrl:e7(this.signedUrl,...e,{format:"json"})}}}let tt=async e=>{if(!l(e))return null;let{id:t,name:r,mediaType:i,base64Content:n,enablePublicUrl:s,signedUrlTimeout:o,uploadUrlTimeout:d}=await e;return a({id:t,name:r||void 0,mediaType:i,base64Content:n,enablePublicUrl:s,signedUrlTimeout:o,uploadUrlTimeout:d})};function tr(e){if(!l(e))return;if(!h(e))return e;let t=Object.fromEntries(Object.entries(e).reduce((e,[t,r])=>{if(!l(r))return e;if(Array.isArray(r)){let i=r.map(e=>tr(e)).filter(e=>l(e));return 0===i.length?e:[...e,[t,i]]}if(h(r)){let i=tr(r);return l(i)?[...e,[t,i]]:e}return[...e,[t,r]]},[]));return Object.keys(t).length>0?t:void 0}var ti=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tn=(e,t,r)=>(ti(e,t,"read from private field"),r?r.call(e):t.get(e)),ts=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},to=(e,t,r,i)=>(ti(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r);class ta{constructor(e,t,r=[]){ts(this,O,void 0),to(this,O,e),this.meta=t,this.records=new th(this,r)}async nextPage(e,t){return tn(this,O).getPaginated({pagination:{size:e,offset:t,after:this.meta.page.cursor}})}async previousPage(e,t){return tn(this,O).getPaginated({pagination:{size:e,offset:t,before:this.meta.page.cursor}})}async startPage(e,t){return tn(this,O).getPaginated({pagination:{size:e,offset:t,start:this.meta.page.cursor}})}async endPage(e,t){return tn(this,O).getPaginated({pagination:{size:e,offset:t,end:this.meta.page.cursor}})}hasNextPage(){return this.meta.page.more}}O=new WeakMap;let td=class e extends Array{constructor(...t){super(...e.parseConstructorParams(...t)),ts(this,C,void 0),to(this,C,h(t[0]?.meta)?t[0]:{meta:{page:{cursor:"",more:!1}},records:[]})}static parseConstructorParams(...e){return 1===e.length&&"number"==typeof e[0]?Array(e[0]):e.length<=2&&h(e[0]?.meta)&&Array.isArray(e[1]??[])?Array(...e[1]??e[0].records??[]):Array(...e)}toArray(){return Array(...this)}toSerializable(){return JSON.parse(this.toString())}toString(){return JSON.stringify(this.toArray())}map(e,t){return this.toArray().map(e,t)}async nextPage(t,r){return new e(await tn(this,C).nextPage(t,r))}async previousPage(t,r){return new e(await tn(this,C).previousPage(t,r))}async startPage(t,r){return new e(await tn(this,C).startPage(t,r))}async endPage(t,r){return new e(await tn(this,C).endPage(t,r))}hasNextPage(){return tn(this,C).meta.page.more}};C=new WeakMap;let th=td;var tl=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tc=(e,t,r)=>(tl(e,t,"read from private field"),r?r.call(e):t.get(e)),tu=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},tp=(e,t,r,i)=>(tl(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),tm=(e,t,r)=>(tl(e,t,"access private method"),r);let tf=class e{constructor(e,t,r,i){tu(this,A),tu(this,B,void 0),tu(this,W,void 0),tu(this,V,{filter:{}}),this.meta={page:{cursor:"start",more:!0,size:20}},this.records=new th(this,[]),tp(this,B,t),e?tp(this,W,e):tp(this,W,this);let n=function(e,t){var r;return l(r=e.pagination)&&(l(r.start)||l(r.end)||l(r.after)||l(r.before))?{...t,sort:void 0,filter:void 0}:t}(r,i);tc(this,V).filter=r.filter??n?.filter??{},tc(this,V).filter.$any=r.filter?.$any??n?.filter?.$any,tc(this,V).filter.$all=r.filter?.$all??n?.filter?.$all,tc(this,V).filter.$not=r.filter?.$not??n?.filter?.$not,tc(this,V).filter.$none=r.filter?.$none??n?.filter?.$none,tc(this,V).sort=r.sort??n?.sort,tc(this,V).columns=r.columns??n?.columns,tc(this,V).consistency=r.consistency??n?.consistency,tc(this,V).pagination=r.pagination??n?.pagination,tc(this,V).cache=r.cache??n?.cache,tc(this,V).fetchOptions=r.fetchOptions??n?.fetchOptions,this.any=this.any.bind(this),this.all=this.all.bind(this),this.not=this.not.bind(this),this.filter=this.filter.bind(this),this.sort=this.sort.bind(this),this.none=this.none.bind(this),Object.defineProperty(this,"table",{enumerable:!1}),Object.defineProperty(this,"repository",{enumerable:!1})}getQueryOptions(){return tc(this,V)}key(){let{columns:e=[],filter:t={},sort:r=[],pagination:i={}}=tc(this,V);return function(e){try{return btoa(e)}catch(t){return Buffer.from(e).toString("base64")}}(JSON.stringify({columns:e,filter:t,sort:r,pagination:i}))}any(...t){let r=t.map(e=>e.getQueryOptions().filter??{});return new e(tc(this,W),tc(this,B),{filter:{$any:r}},tc(this,V))}all(...t){let r=t.map(e=>e.getQueryOptions().filter??{});return new e(tc(this,W),tc(this,B),{filter:{$all:r}},tc(this,V))}not(...t){let r=t.map(e=>e.getQueryOptions().filter??{});return new e(tc(this,W),tc(this,B),{filter:{$not:r}},tc(this,V))}none(...t){let r=t.map(e=>e.getQueryOptions().filter??{});return new e(tc(this,W),tc(this,B),{filter:{$none:r}},tc(this,V))}filter(t,r){if(1==arguments.length){let r=Object.entries(t??{}).map(([e,t])=>({[e]:tm(this,A,q).call(this,e,t)})),i=o([tc(this,V).filter?.$all].flat().concat(r));return new e(tc(this,W),tc(this,B),{filter:{$all:i}},tc(this,V))}{let i=l(t)&&l(r)?[{[t]:tm(this,A,q).call(this,t,r)}]:void 0,n=o([tc(this,V).filter?.$all].flat().concat(i));return new e(tc(this,W),tc(this,B),{filter:{$all:n}},tc(this,V))}}sort(t,r="asc"){let i=[...[tc(this,V).sort??[]].flat(),{column:t,direction:r}];return new e(tc(this,W),tc(this,B),{sort:i},tc(this,V))}select(t){return new e(tc(this,W),tc(this,B),{columns:t},tc(this,V))}getPaginated(t={}){let r=new e(tc(this,W),tc(this,B),t,tc(this,V));return tc(this,W).query(r)}async *[Symbol.asyncIterator](){for await(let[e]of this.getIterator({batchSize:1}))yield e}async *getIterator(e={}){let{batchSize:t=1}=e,r=await this.getPaginated({...e,pagination:{size:t,offset:0}}),i=r.hasNextPage();for(yield r.records;i;)i=(r=await r.nextPage()).hasNextPage(),yield r.records}async getMany(e={}){let{pagination:t={},...r}=e,{size:i=20,offset:n}=t,s=await this.getPaginated({...r,pagination:{size:i<=1e3?i:1e3,offset:n}}),o=[...s.records];for(;s.hasNextPage()&&o.length<i;)o.push(...(s=await s.nextPage()).records);return s.hasNextPage()&&e.pagination?.size===void 0&&console.trace("Calling getMany does not return all results. Paginate to get all results or call getAll."),new th(s,o.slice(0,i))}async getAll(e={}){let{batchSize:t=1e3,...r}=e,i=[];for await(let e of this.getIterator({...r,batchSize:t}))i.push(...e);return i}async getFirst(e={}){return(await this.getMany({...e,pagination:{size:1}}))[0]??null}async getFirstOrThrow(e={}){let t=await this.getMany({...e,pagination:{size:1}});if(void 0===t[0])throw Error("No results found.");return t[0]}async summarize(t={}){let{summaries:r,summariesFilter:i,...n}=t,s=new e(tc(this,W),tc(this,B),n,tc(this,V));return tc(this,W).summarizeTable(s,r,i)}cache(t){return new e(tc(this,W),tc(this,B),{cache:t},tc(this,V))}nextPage(e,t){return this.startPage(e,t)}previousPage(e,t){return this.startPage(e,t)}startPage(e,t){return this.getPaginated({pagination:{size:e,offset:t}})}endPage(e,t){return this.getPaginated({pagination:{size:e,offset:t,before:"end"}})}hasNextPage(){return this.meta.page.more}};B=new WeakMap,W=new WeakMap,V=new WeakMap,A=new WeakSet,q=function(e,t){let r=tc(this,B).schema?.columns.find(({name:t})=>t===e)?.type;return"multiple"===r&&(c(t)||u(t))?{$includes:t}:"link"===r&&h(t)&&c(t.id)?t.id:t};let ty=tf;function tN(e){return!!Array.isArray(e)&&e.every(e=>"string"==typeof e||"object"==typeof e&&h(e)&&c(e.name))}function tb(e){return h(e)&&Object.entries(e).every(([e,t])=>"*"===e?"random"===t:"asc"===t||"desc"===t)}function tw(e){if(c(e))return{[e]:"asc"};if(Array.isArray(e))return e.map(e=>tw(e));if(tb(e))return e;if(h(e)&&!tb(e)&&void 0!==e.column)return{[e.column]:e.direction??"asc"};throw Error(`Invalid sort filter: ${e}`)}var tg=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tv=(e,t,r)=>(tg(e,t,"read from private field"),r?r.call(e):t.get(e)),tk=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},tx=(e,t,r,i)=>(tg(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),tI=(e,t,r)=>(tg(e,t,"access private method"),r);class tT extends ty{constructor(e){super(null,{name:e.table,schema:e.schemaTables?.find(t=>t.name===e.table)},{}),tk(this,R),tk(this,U),tk(this,j),tk(this,Q),tk(this,K),tk(this,H),tk(this,X),tk(this,Y),tk(this,et),tk(this,ei),tk(this,es),tk(this,ea),tk(this,S,void 0),tk(this,E,void 0),tk(this,P,void 0),tk(this,D,void 0),tk(this,_,void 0),tk(this,L,void 0),tx(this,S,e.table),tx(this,P,e.db),tx(this,D,e.pluginOptions.cache),tx(this,_,e.schemaTables),tx(this,E,()=>({...e.pluginOptions,sessionID:ex()}));let t=e.pluginOptions.trace??i;tx(this,L,async(e,r,i={})=>t(e,r,{...i,[n.TABLE]:tv(this,S),[n.KIND]:"sdk-operation",[n.VERSION]:eW}))}async create(e,t,r,i){return tv(this,L).call(this,"create",async()=>{let n=tB(t,r,i);if(Array.isArray(e)){if(0===e.length)return[];let r=await tI(this,j,$).call(this,e,{ifVersion:n,createOnly:!0}),i=tN(t)?t:["*"];return await this.read(r,i)}if(c(e)&&h(t)){if(""===e)throw Error("The id can't be empty");let i=tN(r)?r:void 0;return await tI(this,U,F).call(this,e,t,i,{createOnly:!0,ifVersion:n})}if(h(e)&&c(e.id)){if(""===e.id)throw Error("The id can't be empty");let r=tN(t)?t:void 0;return await tI(this,U,F).call(this,e.id,{...e,id:void 0},r,{createOnly:!0,ifVersion:n})}if(h(e)){let r=tN(t)?t:void 0;return tI(this,R,M).call(this,e,r)}throw Error("Invalid arguments for create method")})}async read(e,t){return tv(this,L).call(this,"read",async()=>{let r=tN(t)?t:["*"];if(Array.isArray(e)){if(0===e.length)return[];let t=e.map(e=>tC(e)),i=(await this.getAll({filter:{id:{$any:o(t)}},columns:r})).reduce((e,t)=>(e[t.id]=t,e),{});return t.map(e=>i[e??""]??null)}let i=tC(e);if(i)try{let e=await ez({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S),recordId:i},queryParams:{columns:r},...tv(this,E).call(this)}),t=await tI(this,es,eo).call(this);return tO(tv(this,P),t,tv(this,S),e,r)}catch(e){if(h(e)&&404===e.status)return null;throw e}return null})}async readOrThrow(e,t){return tv(this,L).call(this,"readOrThrow",async()=>{let r=await this.read(e,t);if(Array.isArray(r)){let t=o(e.filter((e,t)=>null===r[t]).map(e=>tC(e)));if(t.length>0)throw Error(`Could not find records with ids: ${t.join(", ")}`);return r}if(null===r){let t=tC(e)??"unknown";throw Error(`Record with id ${t} not found`)}return r})}async update(e,t,r,i){return tv(this,L).call(this,"update",async()=>{let n=tB(t,r,i);if(Array.isArray(e)){if(0===e.length)return[];let r=await this.read(e,["id"]),i=e.filter((e,t)=>null!==r[t]);await tI(this,K,z).call(this,i,{ifVersion:n,upsert:!1});let s=tN(t)?t:["*"];return await this.read(e,s)}try{if(c(e)&&h(t)){let i=tN(r)?r:void 0;return await tI(this,Q,J).call(this,e,t,i,{ifVersion:n})}if(h(e)&&c(e.id)){let r=tN(t)?t:void 0;return await tI(this,Q,J).call(this,e.id,{...e,id:void 0},r,{ifVersion:n})}}catch(e){if(422===e.status)return null;throw e}throw Error("Invalid arguments for update method")})}async updateOrThrow(e,t,r,i){return tv(this,L).call(this,"updateOrThrow",async()=>{let n=await this.update(e,t,r,i);if(Array.isArray(n)){let t=o(e.filter((e,t)=>null===n[t]).map(e=>tC(e)));if(t.length>0)throw Error(`Could not find records with ids: ${t.join(", ")}`);return n}if(null===n){let t=tC(e)??"unknown";throw Error(`Record with id ${t} not found`)}return n})}async createOrUpdate(e,t,r,i){return tv(this,L).call(this,"createOrUpdate",async()=>{let n=tB(t,r,i);if(Array.isArray(e)){if(0===e.length)return[];await tI(this,K,z).call(this,e,{ifVersion:n,upsert:!0});let r=tN(t)?t:["*"];return await this.read(e,r)}if(c(e)&&h(t)){if(""===e)throw Error("The id can't be empty");let i=tN(r)?r:void 0;return await tI(this,H,G).call(this,e,t,i,{ifVersion:n})}if(h(e)&&c(e.id)){if(""===e.id)throw Error("The id can't be empty");let t=tN(r)?r:void 0;return await tI(this,H,G).call(this,e.id,{...e,id:void 0},t,{ifVersion:n})}if(!l(e)&&h(t))return await this.create(t,r);if(h(e)&&!l(e.id))return await this.create(e,t);throw Error("Invalid arguments for createOrUpdate method")})}async createOrReplace(e,t,r,i){return tv(this,L).call(this,"createOrReplace",async()=>{let n=tB(t,r,i);if(Array.isArray(e)){if(0===e.length)return[];let r=await tI(this,j,$).call(this,e,{ifVersion:n,createOnly:!1}),i=tN(t)?t:["*"];return await this.read(r,i)}if(c(e)&&h(t)){if(""===e)throw Error("The id can't be empty");let i=tN(r)?r:void 0;return await tI(this,U,F).call(this,e,t,i,{createOnly:!1,ifVersion:n})}if(h(e)&&c(e.id)){if(""===e.id)throw Error("The id can't be empty");let t=tN(r)?r:void 0;return await tI(this,U,F).call(this,e.id,{...e,id:void 0},t,{createOnly:!1,ifVersion:n})}if(!l(e)&&h(t))return await this.create(t,r);if(h(e)&&!l(e.id))return await this.create(e,t);throw Error("Invalid arguments for createOrReplace method")})}async delete(e,t){return tv(this,L).call(this,"delete",async()=>{if(Array.isArray(e)){if(0===e.length)return[];let r=e.map(e=>{if(c(e))return e;if(c(e.id))return e.id;throw Error("Invalid arguments for delete method")}),i=tN(t)?t:["*"],n=await this.read(e,i);return await tI(this,Y,ee).call(this,r),n}if(c(e))return tI(this,X,Z).call(this,e,t);if(h(e)&&c(e.id))return tI(this,X,Z).call(this,e.id,t);throw Error("Invalid arguments for delete method")})}async deleteOrThrow(e,t){return tv(this,L).call(this,"deleteOrThrow",async()=>{let r=await this.delete(e,t);if(Array.isArray(r)){let t=o(e.filter((e,t)=>null===r[t]).map(e=>tC(e)));if(t.length>0)throw Error(`Could not find records with ids: ${t.join(", ")}`)}else if(null===r){let t=tC(e)??"unknown";throw Error(`Record with id ${t} not found`)}return r})}async search(e,t={}){return tv(this,L).call(this,"search",async()=>{let{records:r,totalCount:i}=await e1({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S)},body:{query:e,fuzziness:t.fuzziness,prefix:t.prefix,highlight:t.highlight,filter:t.filter,boosters:t.boosters,page:t.page,target:t.target},...tv(this,E).call(this)}),n=await tI(this,es,eo).call(this);return{records:r.map(e=>tO(tv(this,P),n,tv(this,S),e,["*"])),totalCount:i}})}async vectorSearch(e,t,r){return tv(this,L).call(this,"vectorSearch",async()=>{let{records:i,totalCount:n}=await e2({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S)},body:{column:e,queryVector:t,similarityFunction:r?.similarityFunction,size:r?.size,filter:r?.filter},...tv(this,E).call(this)}),s=await tI(this,es,eo).call(this);return{records:i.map(e=>tO(tv(this,P),s,tv(this,S),e,["*"])),totalCount:n}})}async aggregate(e,t){return tv(this,L).call(this,"aggregate",async()=>await e6({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S)},body:{aggs:e,filter:t},...tv(this,E).call(this)}))}async query(e){return tv(this,L).call(this,"query",async()=>{let t=await tI(this,ei,en).call(this,e);if(t)return new ta(e,t.meta,t.records);let r=e.getQueryOptions(),{meta:i,records:n}=await eY({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S)},body:{filter:tr(r.filter),sort:void 0!==r.sort?tw(r.sort):void 0,page:r.pagination,columns:r.columns??["*"],consistency:r.consistency},fetchOptions:r.fetchOptions,...tv(this,E).call(this)}),s=await tI(this,es,eo).call(this),o=n.map(e=>tO(tv(this,P),s,tv(this,S),e,r.columns??["*"]));return await tI(this,et,er).call(this,e,i,o),new ta(e,i,o)})}async summarizeTable(e,t,r){return tv(this,L).call(this,"summarize",async()=>{let i=e.getQueryOptions(),n=await e4({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S)},body:{filter:tr(i.filter),sort:void 0!==i.sort?tw(i.sort):void 0,columns:i.columns,consistency:i.consistency,page:i.pagination?.size!==void 0?{size:i.pagination?.size}:void 0,summaries:t,summariesFilter:r},...tv(this,E).call(this)}),s=await tI(this,es,eo).call(this);return{...n,summaries:n.summaries.map(e=>tO(tv(this,P),s,tv(this,S),e,i.columns??[]))}})}ask(e,t){let r=t?.sessionId?{message:e}:{question:e},i={pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S),sessionId:t?.sessionId},body:{...r,rules:t?.rules,searchType:t?.searchType,search:t?.searchType==="keyword"?t?.search:void 0,vectorSearch:t?.searchType==="vector"?t?.vectorSearch:void 0},...tv(this,E).call(this)};if(!t?.onMessage)return e8(i);!function({url:e,method:t,body:r,headers:i,pathParams:n,queryParams:s,fetch:a,apiKey:d,endpoint:h,apiUrl:c,workspacesApiUrl:u,onMessage:p,onError:m,onClose:f,signal:y,clientID:N,sessionID:b,clientName:w,xataAgentExtra:g}){let v=eD(e_({method:t,endpoint:h,path:e,workspacesApiUrl:u,pathParams:n,apiUrl:c}),s,n);(function(e,{signal:t,headers:r,onopen:i,onmessage:n,onclose:s,onerror:o,fetch:a,...d}){new Promise((o,h)=>{let l;let c={...r};c.accept||(c.accept=eO),t?.addEventListener("abort",()=>{l.abort(),o()});let u=a??fetch,p=i??eB;(async function(){l=new AbortController;try{var t;let r,i,a,h;let m=await u(e,{...d,headers:c,signal:l.signal});await p(m),await eI(m.body,(t=function(e,t,r){let i=eT(),n=new TextDecoder;return function(s,o){if(0===s.length)r?.(i),i=eT();else if(o>0){let r=n.decode(s.subarray(0,o)),a=o+(32===s[o+1]?2:1),d=n.decode(s.subarray(a));switch(r){case"data":i.data=i.data?i.data+"\n"+d:d;break;case"event":i.event=d;break;case"id":e(i.id=d);break;case"retry":let h=parseInt(d,10);isNaN(h)||t(i.retry=h)}}}}(e=>{e?c[eC]=e:delete c[eC]},e=>{},n),h=!1,function(e){void 0===r?(r=e,i=0,a=-1):r=function(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(r,e);let n=r.length,s=0;for(;i<n;){h&&(10===r[i]&&(s=++i),h=!1);let e=-1;for(;i<n&&-1===e;++i)switch(r[i]){case 58:-1===a&&(a=i-s);break;case 13:h=!0;case 10:e=i}if(-1===e)break;t(r.subarray(s,e),a),s=i,a=-1}s===n?r=void 0:0!==s&&(r=r.subarray(s),i-=s)})),s?.(),l.abort(),o()}catch(e){}})()})})(v.includes("localhost")?v.replace(/^[^.]+\./,"http://"):v,{method:t,body:JSON.stringify(r),fetch:a,signal:y,headers:{"X-Xata-Client-ID":N??eR,"X-Xata-Session-ID":b??ex(),"X-Xata-Agent":o([["client","TS_SDK"],["version",eW],l(w)?["service",w]:void 0,...Object.entries(g??{})]).map(([e,t])=>`${e}=${t}`).join("; "),...i,Authorization:`Bearer ${d}`,"Content-Type":"application/json"},onmessage(e){p?.(JSON.parse(e.data))},onerror(e){m?.(JSON.parse(e.data))},onclose(){f?.()}})}({endpoint:"dataPlane",url:"/db/{dbBranchName}/tables/{tableName}/ask/{sessionId}",method:"POST",onMessage:e=>{t.onMessage?.({answer:e.text,records:e.records})},...i})}}S=new WeakMap,E=new WeakMap,P=new WeakMap,D=new WeakMap,_=new WeakMap,L=new WeakMap,R=new WeakSet,M=async function(e,t=["*"]){let r=await tI(this,ea,ed).call(this,e),i=await e$({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S)},queryParams:{columns:t},body:r,...tv(this,E).call(this)}),n=await tI(this,es,eo).call(this);return tO(tv(this,P),n,tv(this,S),i,t)},U=new WeakSet,F=async function(e,t,r=["*"],{createOnly:i,ifVersion:n}){if(!e)return null;let s=await tI(this,ea,ed).call(this,t),o=await eH({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S),recordId:e},body:s,queryParams:{createOnly:i,columns:r,ifVersion:n},...tv(this,E).call(this)}),a=await tI(this,es,eo).call(this);return tO(tv(this,P),a,tv(this,S),o,r)},j=new WeakSet,$=async function(e,{createOnly:t,ifVersion:r}){let i=m(await y(e,async e=>{let i=await tI(this,ea,ed).call(this,e);return{insert:{table:tv(this,S),record:i,createOnly:t,ifVersion:r}}}),1e3),n=[];for(let e of i){let{results:t}=await ej({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:e},...tv(this,E).call(this)});for(let e of t)"insert"===e.operation?n.push(e.id):n.push(null)}return n},Q=new WeakSet,J=async function(e,t,r=["*"],{ifVersion:i}){if(!e)return null;let{id:n,...s}=await tI(this,ea,ed).call(this,t);try{let t=await eG({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S),recordId:e},queryParams:{columns:r,ifVersion:i},body:s,...tv(this,E).call(this)}),n=await tI(this,es,eo).call(this);return tO(tv(this,P),n,tv(this,S),t,r)}catch(e){if(h(e)&&404===e.status)return null;throw e}},K=new WeakSet,z=async function(e,{ifVersion:t,upsert:r}){let i=m(await y(e,async({id:e,...i})=>{let n=await tI(this,ea,ed).call(this,i);return{update:{table:tv(this,S),id:e,ifVersion:t,upsert:r,fields:n}}}),1e3),n=[];for(let e of i){let{results:t}=await ej({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:e},...tv(this,E).call(this)});for(let e of t)"update"===e.operation?n.push(e.id):n.push(null)}return n},H=new WeakSet,G=async function(e,t,r=["*"],{ifVersion:i}){if(!e)return null;let n=await eX({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S),recordId:e},queryParams:{columns:r,ifVersion:i},body:t,...tv(this,E).call(this)}),s=await tI(this,es,eo).call(this);return tO(tv(this,P),s,tv(this,S),n,r)},X=new WeakSet,Z=async function(e,t=["*"]){if(!e)return null;try{let r=await eZ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:tv(this,S),recordId:e},queryParams:{columns:t},...tv(this,E).call(this)}),i=await tI(this,es,eo).call(this);return tO(tv(this,P),i,tv(this,S),r,t)}catch(e){if(h(e)&&404===e.status)return null;throw e}},Y=new WeakSet,ee=async function(e){for(let t of m(o(e).map(e=>({delete:{table:tv(this,S),id:e}})),1e3))await ej({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:t},...tv(this,E).call(this)})},et=new WeakSet,er=async function(e,t,r){await tv(this,D)?.set(`query_${tv(this,S)}:${e.key()}`,{date:new Date,meta:t,records:r})},ei=new WeakSet,en=async function(e){let t=`query_${tv(this,S)}:${e.key()}`,r=await tv(this,D)?.get(t);if(!r)return null;let i=tv(this,D)?.defaultQueryTTL??-1,{cache:n=i}=e.getQueryOptions();return n<0?null:r.date.getTime()+n<Date.now()?null:r},es=new WeakSet,eo=async function(){if(tv(this,_))return tv(this,_);let{schema:e}=await eF({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},...tv(this,E).call(this)});return tx(this,_,e.tables),e.tables},ea=new WeakSet,ed=async function(e){let t=(await tI(this,es,eo).call(this)).find(e=>e.name===tv(this,S));if(!t)throw Error(`Table ${tv(this,S)} not found in schema`);let r={};for(let[i,n]of Object.entries(e))if("xata"!==i)switch(t.columns.find(e=>e.name===i)?.type){case"link":r[i]=h(n)&&c(n?.id)?n.id:n;break;case"datetime":r[i]=n instanceof Date?n.toISOString():n;break;case"file":r[i]=await tt(n);break;case"file[]":r[i]=await y(n,e=>tt(e));break;case"json":r[i]=function(e){if(!l(e)||c(e))return e;try{return JSON.stringify(e)}catch(t){return e}}(n);break;default:r[i]=n}return r};let tO=(e,t,r,i,n)=>{let s={},{xata:o,...a}=i??{};Object.assign(s,a);let{columns:d}=t.find(({name:e})=>e===r)??{};for(let i of(d||console.error(`Table ${r} not found in schema`),d??[])){if(!function(e,t){return!!e.includes("*")||e.filter(e=>c(e)&&e.startsWith(t.name)).length>0}(n,i))continue;let r=s[i.name];switch(i.type){case"datetime":{let e=void 0!==r?new Date(r):null;null!==e&&isNaN(e.getTime())?console.error(`Failed to parse date ${r} for field ${i.name}`):s[i.name]=e;break}case"link":{let o=i.link?.table;if(o){if(h(r)){let a=n.reduce((e,t)=>{if(t===i.name)return[...e,"*"];if(c(t)&&t.startsWith(`${i.name}.`)){let[,...r]=t.split(".");return[...e,r.join(".")]}return e},[]);s[i.name]=tO(e,t,o,r,a)}else s[i.name]=null}else console.error(`Failed to parse link for field ${i.name}`);break}case"file":s[i.name]=l(r)?new te(r):null;break;case"file[]":s[i.name]=r?.map(e=>new te(e))??null;break;case"json":s[i.name]=function(e){try{return JSON.parse(e)}catch(t){return e}}(r);break;default:s[i.name]=r??null,!0===i.notNull&&null===r&&console.error(`Parse error, column ${i.name} is non nullable and value resolves null`)}}let u={...s},p=void 0!==o?{...o,createdAt:new Date(o.createdAt),updatedAt:new Date(o.updatedAt)}:void 0;for(let t of(u.read=function(t){return e[r].read(u.id,t)},u.update=function(t,i,n){let s=tN(i)?i:["*"],o=tB(i,n);return e[r].update(u.id,t,s,{ifVersion:o})},u.replace=function(t,i,n){let s=tN(i)?i:["*"],o=tB(i,n);return e[r].createOrReplace(u.id,t,s,{ifVersion:o})},u.delete=function(){return e[r].delete(u.id)},void 0!==p&&(u.xata=Object.freeze(p)),u.getMetadata=function(){return u.xata},u.toSerializable=function(){return JSON.parse(JSON.stringify(u))},u.toString=function(){return JSON.stringify(u)},["read","update","replace","delete","getMetadata","toSerializable","toString"]))Object.defineProperty(u,t,{enumerable:!1});return Object.freeze(u),u};function tC(e){return c(e)?e:h(e)&&c(e.id)?e.id:void 0}function tB(...e){for(let t of e)if(h(t)&&p(t.ifVersion))return t.ifVersion}var tW=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tV=(e,t,r)=>(tW(e,t,"read from private field"),r?r.call(e):t.get(e)),tA=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},tq=(e,t,r,i)=>(tW(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r);class tS{constructor(e={}){tA(this,eh,void 0),tq(this,eh,new Map),this.capacity=e.max??500,this.defaultQueryTTL=e.defaultQueryTTL??6e4}async getAll(){return Object.fromEntries(tV(this,eh))}async get(e){return tV(this,eh).get(e)??null}async set(e,t){if(await this.delete(e),tV(this,eh).set(e,t),tV(this,eh).size>this.capacity){let e=tV(this,eh).keys().next().value;await this.delete(e)}}async delete(e){tV(this,eh).delete(e)}async clear(){return tV(this,eh).clear()}}eh=new WeakMap;var tE=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tP=(e,t,r)=>(tE(e,t,"read from private field"),r?r.call(e):t.get(e)),tD=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},t_=(e,t,r,i)=>(tE(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r);class tL extends e9{constructor(e){super(),tD(this,el,{}),tD(this,ec,void 0),t_(this,ec,e)}build(e){let t=new Proxy({},{get:(r,i)=>{if(!c(i))throw Error("Invalid table name");return void 0===tP(this,el)[i]&&(tP(this,el)[i]=new tT({db:t,pluginOptions:e,table:i,schemaTables:tP(this,ec)})),tP(this,el)[i]}});for(let r of tP(this,ec)?.map(({name:e})=>e)??[])t[r]=new tT({db:t,pluginOptions:e,table:r,schemaTables:tP(this,ec)});return t}}el=new WeakMap,ec=new WeakMap;class tR extends e9{build(e){return{download:async t=>{let{table:r,record:i,column:n,fileId:s=""}=t??{};return await eQ({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:r??"",recordId:i??"",columnName:n??"",fileId:s},...e,rawResponse:!0})},upload:async(t,r,i)=>{let{table:n,record:s,column:o,fileId:a=""}=t??{},h=await r,l=i?.mediaType||function(e){if("string"==typeof e)return"text/plain";if("mediaType"in e&&void 0!==e.mediaType)return e.mediaType;if(d(e))return e.type;try{return e.type}catch(e){}return"application/octet-stream"}(h),c=h instanceof te?h.toBlob():h;return await eJ({...e,pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:n??"",recordId:s??"",columnName:o??"",fileId:a},body:c,headers:{"Content-Type":l}})},delete:async t=>{let{table:r,record:i,column:n,fileId:s=""}=t??{};return await eK({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}",tableName:r??"",recordId:i??"",columnName:n??"",fileId:s},...e})}}}}var tM=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tU=(e,t,r)=>(tM(e,t,"read from private field"),r?r.call(e):t.get(e)),tF=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},tj=(e,t,r,i)=>(tM(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),t$=(e,t,r)=>(tM(e,t,"access private method"),r);class tQ extends e9{constructor(e,t){super(),this.db=e,tF(this,ep),tF(this,ef),tF(this,eu,void 0),tj(this,eu,t)}build(e){return{all:async(t,r={})=>{let{records:i,totalCount:n}=await t$(this,ep,em).call(this,t,r,e),s=await t$(this,ef,ey).call(this,e);return{totalCount:n,records:i.map(e=>{let{table:t="orphan"}=e.xata;return{table:t,record:tO(this.db,s,t,e,["*"])}})}},byTable:async(t,r={})=>{let{records:i,totalCount:n}=await t$(this,ep,em).call(this,t,r,e),s=await t$(this,ef,ey).call(this,e);return{totalCount:n,records:i.reduce((e,t)=>{let{table:r="orphan"}=t.xata,i=e[r]??[],n=tO(this.db,s,r,t,["*"]);return{...e,[r]:[...i,n]}},{})}}}}}function tJ(e){if(!l(e))return null;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return function e(t){let r="{";for(let i=0;i<t.length;i++)(i>0&&(r+=","),null===t[i]||void 0===t[i])?r+="NULL":Array.isArray(t[i])?r+=e(t[i]):t[i]instanceof Buffer?r+="\\\\x"+t[i].toString("hex"):r+='"'+tJ(t[i]).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"';return r+"}"}(e);if(h(e))return JSON.stringify(e);try{return e.toString()}catch(t){return e}}eu=new WeakMap,ep=new WeakSet,em=async function(e,t,r){let{tables:i,fuzziness:n,highlight:s,prefix:o,page:a}=t??{},{records:d,totalCount:h}=await e0({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{tables:i,query:e,fuzziness:n,prefix:o,highlight:s,page:a},...r});return{records:d,totalCount:h}},ef=new WeakSet,ey=async function(e){if(tU(this,eu))return tU(this,eu);let{schema:t}=await eF({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},...e});return tj(this,eu,t.tables),t.tables};class tK extends e9{build(e){return async(t,...r)=>{let{statement:i,params:n,consistency:s}=function(e,t){if(c(e))return{statement:e,params:t?.map(e=>tJ(e))};if(u(e))return{statement:e.reduce((e,r,i)=>e+r+(i<(t?.length??0)?"$"+(i+1):""),""),params:t?.map(e=>tJ(e))};if(h(e)){let{statement:t,params:r,consistency:i}=e;return{statement:t,params:r?.map(e=>tJ(e)),consistency:i}}throw Error("Invalid query")}(t,r),{records:o,warning:a}=await e5({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{statement:i,params:n,consistency:s},...e});return{records:o,warning:a}}}}class tz extends e9{build(e){return{run:async t=>await ej({pathParams:{workspace:"{workspaceId}",dbBranchName:"{dbBranch}",region:"{region}"},body:{operations:t},...e})}}}var tH=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tG=(e,t,r)=>(tH(e,t,"read from private field"),r?r.call(e):t.get(e)),tX=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},tZ=(e,t,r,i)=>(tH(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),tY=(e,t,r)=>(tH(e,t,"access private method"),r);let t0=e=>{var t,r,n,s,o,a;return a=class{constructor(i={},a){tX(this,r),tX(this,s),tX(this,t,void 0);let d=tY(this,r,n).call(this,i);tZ(this,t,d);let h={...tY(this,s,o).call(this,d),cache:d.cache,host:d.host},l=new tL(a).build(h),c=new tQ(l,a).build(h),u=new tz().build(h),p=new tK().build(h),m=new tR().build(h);for(let[t,r]of(this.db=l,this.search=c,this.transactions=u,this.sql=p,this.files=m,Object.entries(e??{})))void 0!==r&&(this[t]=r.build(h))}async getConfig(){return{databaseURL:tG(this,t).databaseURL,branch:tG(this,t).branch}}},t=new WeakMap,r=new WeakSet,n=function(e){let t=e?.enableBrowser??function(){try{if(h(process)&&h(process.env)&&void 0!==process.env.XATA_ENABLE_BROWSER)return"true"===process.env.XATA_ENABLE_BROWSER}catch(e){}try{if(h(Deno)&&h(Deno.env)&&void 0!==Deno.env.get("XATA_ENABLE_BROWSER"))return"true"===Deno.env.get("XATA_ENABLE_BROWSER")}catch(e){}try{return!0===XATA_ENABLE_BROWSER||"true"===XATA_ENABLE_BROWSER}catch(e){return}}()??!1;if("undefined"!=typeof window&&"undefined"==typeof Deno&&!t)throw Error("You are trying to use Xata from the browser, which is potentially a non-secure environment. If you understand the security concerns, such as leaking your credentials, pass `enableBrowser: true` to the client options to remove this error.");let r=function(e){let t="undefined"!=typeof fetch?fetch:void 0,r="undefined"!=typeof globalThis?globalThis.fetch:void 0,i=e??t??r;if(!i)throw Error("Couldn't find a global `fetch`. Pass a fetch implementation explicitly.");return i}(e?.fetch),n=e?.databaseURL||function(){try{let{databaseURL:e}=N();return e}catch(e){return}}(),s=e?.apiKey||function(){try{let{apiKey:e}=N();return e}catch(e){return}}(),o=e?.cache??new tS({defaultQueryTTL:0}),a=e?.trace??i,d=e?.clientName,l=e?.host??"production",c=e?.xataAgentExtra;if(!s)throw Error("Option apiKey is required");if(!n)throw Error("Option databaseURL is required");let u=function(){try{let{branch:e}=N();return e}catch(e){return}}(),p=function(){try{let{deployPreview:e,deployPreviewBranch:t,vercelGitCommitRef:r,vercelGitRepoOwner:i}=N();if(t)return t;switch(e){case"vercel":if(!r||!i){console.warn("XATA_PREVIEW=vercel but VERCEL_GIT_COMMIT_REF or VERCEL_GIT_REPO_OWNER is not valid");break}return function({org:e,branch:t}){return`preview-${e}-${t}`}({org:i,branch:r})}return}catch(e){return}}(),m=e?.branch||p||u||"main";return p&&m!==p?console.warn(`Ignoring preview branch ${p} because branch option was passed to the client constructor with value ${m}`):u&&m!==u?console.warn(`Ignoring branch ${u} because branch option was passed to the client constructor with value ${m}`):p&&u&&p!==u?console.warn(`Ignoring preview branch ${p} and branch ${u} because branch option was passed to the client constructor with value ${m}`):p||u||e?.branch!==void 0||console.warn(`No branch was passed to the client constructor. Using default branch ${m}. You can set the branch with the environment variable XATA_BRANCH or by passing the branch option to the client constructor.`),{fetch:r,databaseURL:n,apiKey:s,branch:m,cache:o,trace:a,host:l,clientID:ex(),enableBrowser:t,clientName:d,xataAgentExtra:c}},s=new WeakSet,o=function({fetch:e,apiKey:t,databaseURL:r,branch:i,trace:n,clientID:s,clientName:o,xataAgentExtra:a}){return{fetch:e,apiKey:t,apiUrl:"",workspacesApiUrl:(e,t)=>{let n=t.dbBranchName??t.branch;return r+e.replace(/^\/db\/[^/]+/,void 0!==n?`:${i}`:"")},trace:n,clientID:s,clientName:o,xataAgentExtra:a}},a};class t1{constructor(){this.classes={}}add(e){this.classes[e.name]=e}toJSON(e){return JSON.stringify(function e(t){if(Array.isArray(t))return t.map(e);let r=typeof t;if("undefined"===r)return{__:"undefined"};if("bigint"===r)return{__:"bigint",___:t.toString()};if(null===t||"object"!==r)return t;let i=t.constructor,n={__:i.name};for(let[r,i]of Object.entries(t))n[r]=e(i);return i===Date&&(n.___=t.toISOString()),i===Map&&(n.___=Object.fromEntries(t)),i===Set&&(n.___=[...t]),n}(e))}fromJSON(e){return JSON.parse(e,(e,t)=>{if(t&&"object"==typeof t&&!Array.isArray(t)){let{__:e,___:r,...i}=t,n=this.classes[e];if(n)return Object.assign(Object.create(n.prototype),i);if("Date"===e)return new Date(r);if("Set"===e)return new Set(r);if("Map"===e)return new Map(Object.entries(r));if("bigint"===e)return BigInt(r);if("undefined"===e)return;return i}return t})}}new t1},80635:(e,t,r)=>{r.d(t,{pe:()=>eH});let i={KIND:"xata.trace.kind",HTTP_REQUEST_ID:"http.request_id",HTTP_STATUS_CODE:"http.status_code",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_ROUTE:"http.route",HTTP_TARGET:"http.target",CLOUDFLARE_RAY_ID:"cf.ray"},n=[],s=[],o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let e=0,t=o.length;e<t;++e)n[e]=o[e],s[o.charCodeAt(e)]=e;function a(e){let t;let r=e.length,i=r%3,s=[];for(let t=0,o=r-i;t<o;t+=16383)s.push(function(e,t,r){let i;let s=[];for(let o=t;o<r;o+=3)s.push(n[(i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}(e,t,t+16383>o?o:t+16383));return 1===i?s.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===i&&s.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),s.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63;class d extends Uint8Array{constructor(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError("The first argument must be of type string, received type number");if(e<0)throw RangeError("The buffer size cannot be negative");super(e<0?0:0|d._checked(e))}else if("string"==typeof e){if("string"!=typeof t&&(t="utf8"),!d.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|d.byteLength(e,t);super(r);let i=this.write(e,0,this.length,t);if(i!==r)throw TypeError("Number of bytes written did not match expected length (wrote "+i+", expected "+r+")")}else if(ArrayBuffer.isView(e)){if(d._isInstance(e,Uint8Array)){let t=new Uint8Array(e),r=t.buffer,i=t.byteOffset,n=t.byteLength;if(i<0||r.byteLength<i)throw RangeError("offset is outside of buffer bounds");if(r.byteLength<i+(n||0))throw RangeError("length is outside of buffer bounds");super(new Uint8Array(r,i,n))}else{let t=e.length<0?0:0|d._checked(e.length);super(new Uint8Array(t));for(let r=0;r<t;r++)this[r]=255&e[r]}}else if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);else if(d._isInstance(e,ArrayBuffer)||e&&d._isInstance(e.buffer,ArrayBuffer)){let i=t;if(i<0||e.byteLength<i)throw RangeError("offset is outside of buffer bounds");if(e.byteLength<i+(r||0))throw RangeError("length is outside of buffer bounds");super(new Uint8Array(e,i,r))}else if(Array.isArray(e)){let t=e.length<0?0:0|d._checked(e.length);super(new Uint8Array(t));for(let r=0;r<t;r++)this[r]=255&e[r]}else throw TypeError("Unable to determine the correct way to allocate buffer for type "+typeof e)}toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this)}}write(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else if("number"==typeof t&&isFinite(t))t>>>=0,"number"==typeof r&&isFinite(r)?(r>>>=0,i??(i="utf8")):"string"==typeof r&&(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");switch(i||(i="utf8"),d._getEncoding(i)){case"hex":return d._hexWrite(this,e,t,r);case"utf8":return d._utf8Write(this,e,t,r);case"ascii":case"latin1":case"binary":return d._asciiWrite(this,e,t,r);case"ucs2":case"utf16le":return d._ucs2Write(this,e,t,r);case"base64":return d._base64Write(this,e,t,r)}}toString(e,t,r){let i=this.length;if(0===i)return"";if(0==arguments.length)return d._utf8Slice(this,0,i);if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,t>>>=0,r<=t))return"";switch(e||(e="utf8"),d._getEncoding(e)){case"hex":return d._hexSlice(this,t,r);case"utf8":return d._utf8Slice(this,t,r);case"ascii":return d._asciiSlice(this,t,r);case"latin1":case"binary":return d._latin1Slice(this,t,r);case"ucs2":case"utf16le":return d._utf16leSlice(this,t,r);case"base64":return d._base64Slice(this,t,r)}}equals(e){if(!d.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)}compare(e,t,r,i,n){if(d._isInstance(e,Uint8Array)&&(e=d.from(e,e.byteOffset,e.byteLength)),!d.isBuffer(e))throw TypeError("Argument must be a Buffer or Uint8Array");if(t??(t=0),r??(r=e?e.length:0),i??(i=0),n??(n=this.length),t<0||r>e.length||i<0||n>this.length)throw RangeError("Out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,n>>>=0,this===e)return 0;let s=n-i,o=r-t,a=Math.min(s,o),h=this.slice(i,n),l=e.slice(t,r);for(let e=0;e<a;++e)if(h[e]!==l[e]){s=h[e],o=l[e];break}return s<o?-1:o<s?1:0}copy(e,t,r,i){if(!d.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),t||(t=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);let n=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),n}slice(e,t){e||(e=0);let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,d.prototype),i}writeUIntLE(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;d._checkInt(this,e,t,r,i,0)}let n=1,s=0;for(this[t]=255&e;++s<r&&(n*=256);)this[t+s]=e/n&255;return t+r}writeUIntBE(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;d._checkInt(this,e,t,r,i,0)}let n=r-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+r}writeIntLE(e,t,r,i){if(e=+e,t>>>=0,!i){let i=Math.pow(2,8*r-1);d._checkInt(this,e,t,r,i-1,-i)}let n=0,s=1,o=0;for(this[t]=255&e;++n<r&&(s*=256);)e<0&&0===o&&0!==this[t+n-1]&&(o=1),this[t+n]=(e/s>>0)-o&255;return t+r}writeIntBE(e,t,r,i){if(e=+e,t>>>=0,!i){let i=Math.pow(2,8*r-1);d._checkInt(this,e,t,r,i-1,-i)}let n=r-1,s=1,o=0;for(this[t+n]=255&e;--n>=0&&(s*=256);)e<0&&0===o&&0!==this[t+n+1]&&(o=1),this[t+n]=(e/s>>0)-o&255;return t+r}readUIntLE(e,t,r){e>>>=0,t>>>=0,r||d._checkOffset(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return i}readUIntBE(e,t,r){e>>>=0,t>>>=0,r||d._checkOffset(e,t,this.length);let i=this[e+--t],n=1;for(;t>0&&(n*=256);)i+=this[e+--t]*n;return i}readIntLE(e,t,r){e>>>=0,t>>>=0,r||d._checkOffset(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i}readIntBE(e,t,r){e>>>=0,t>>>=0,r||d._checkOffset(e,t,this.length);let i=t,n=1,s=this[e+--i];for(;i>0&&(n*=256);)s+=this[e+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s}readUInt8(e,t){return e>>>=0,t||d._checkOffset(e,1,this.length),this[e]}readUInt16LE(e,t){return e>>>=0,t||d._checkOffset(e,2,this.length),this[e]|this[e+1]<<8}readUInt16BE(e,t){return e>>>=0,t||d._checkOffset(e,2,this.length),this[e]<<8|this[e+1]}readUInt32LE(e,t){return e>>>=0,t||d._checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]}readUInt32BE(e,t){return e>>>=0,t||d._checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])}readInt8(e,t){return(e>>>=0,t||d._checkOffset(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]}readInt16LE(e,t){e>>>=0,t||d._checkOffset(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r}readInt16BE(e,t){e>>>=0,t||d._checkOffset(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r}readInt32LE(e,t){return e>>>=0,t||d._checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24}readInt32BE(e,t){return e>>>=0,t||d._checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]}swap16(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)this._swap(this,t,t+1);return this}swap32(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)this._swap(this,t,t+3),this._swap(this,t+1,t+2);return this}swap64(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)this._swap(this,t,t+7),this._swap(this,t+1,t+6),this._swap(this,t+2,t+5),this._swap(this,t+3,t+4);return this}_swap(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}writeUInt8(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,1,255,0),this[t]=255&e,t+1}writeUInt16LE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2}writeUInt16BE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2}writeUInt32LE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4}writeUInt32BE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4}writeInt8(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1}writeInt16LE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2}writeInt16BE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2}writeInt32LE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4}writeInt32BE(e,t,r){return e=+e,t>>>=0,r||d._checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4}fill(e,t,r,i){let n;if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!d.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){let t=e.charCodeAt(0);"utf8"===i&&t<128&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t??(t=0),r??(r=this.length),t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{let s=d.isBuffer(e)?e:d.from(e,i),o=s.length;if(0===o)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=s[n%o]}return this}indexOf(e,t,r){return this._bidirectionalIndexOf(this,e,t,r,!0)}lastIndexOf(e,t,r){return this._bidirectionalIndexOf(this,e,t,r,!1)}_bidirectionalIndexOf(e,t,r,i,n){if(0===e.length)return -1;if("string"==typeof r?(i=r,r=0):void 0===r?r=0:r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(r=+r)!=r&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return -1;r=e.length-1}else if(r<0){if(!n)return -1;r=0}if("string"==typeof t&&(t=d.from(t,i)),d.isBuffer(t))return 0===t.length?-1:d._arrayIndexOf(e,t,r,i,n);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):d._arrayIndexOf(e,d.from([t]),r,i,n);throw TypeError("val must be string, number or Buffer")}includes(e,t,r){return -1!==this.indexOf(e,t,r)}static from(e,t,r){return new d(e,t,r)}static isBuffer(e){return null!=e&&e!==d.prototype&&d._isInstance(e,d)}static isEncoding(e){switch(e.toLowerCase()){case"hex":case"utf8":case"ascii":case"binary":case"latin1":case"ucs2":case"utf16le":case"base64":return!0;default:return!1}}static byteLength(e,t){if(d.isBuffer(e))return e.length;if("string"!=typeof e&&(ArrayBuffer.isView(e)||d._isInstance(e,ArrayBuffer)))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;switch(t?.toLowerCase()){case"ascii":case"latin1":case"binary":return r;case"utf8":return d._utf8ToBytes(e).length;case"hex":return r>>>1;case"ucs2":case"utf16le":return 2*r;case"base64":return d._base64ToBytes(e).length;default:return i?-1:d._utf8ToBytes(e).length}}static concat(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let i=d.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){let t=e[r];if(d._isInstance(t,Uint8Array))n+t.length>i.length?(d.isBuffer(t)||(t=d.from(t)),t.copy(i,n)):Uint8Array.prototype.set.call(i,t,n);else if(d.isBuffer(t))t.copy(i,n);else throw TypeError('"list" argument must be an Array of Buffers');n+=t.length}return i}static compare(e,t){if(d._isInstance(e,Uint8Array)&&(e=d.from(e,e.byteOffset,e.byteLength)),d._isInstance(t,Uint8Array)&&(t=d.from(t,t.byteOffset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,i=t.length;for(let n=0,s=Math.min(r,i);n<s;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0}static alloc(e,t,r){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"');return e<=0?new d(e):void 0!==t?"string"==typeof r?new d(e).fill(t,0,e,r):new d(e).fill(t):new d(e)}static allocUnsafe(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"');return new d(e<0?0:0|d._checked(e))}static _isInstance(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}static _checked(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}static _blitBuffer(e,t,r,i){let n;for(n=0;n<i&&!(n+r>=t.length)&&!(n>=e.length);++n)t[n+r]=e[n];return n}static _utf8Write(e,t,r,i){return d._blitBuffer(d._utf8ToBytes(t,e.length-r),e,r,i)}static _asciiWrite(e,t,r,i){return d._blitBuffer(d._asciiToBytes(t),e,r,i)}static _base64Write(e,t,r,i){return d._blitBuffer(d._base64ToBytes(t),e,r,i)}static _ucs2Write(e,t,r,i){return d._blitBuffer(d._utf16leToBytes(t,e.length-r),e,r,i)}static _hexWrite(e,t,r,i){let n;r=Number(r)||0;let s=e.length-r;i?(i=Number(i))>s&&(i=s):i=s;let o=t.length;for(i>o/2&&(i=o/2),n=0;n<i;++n){let i=parseInt(t.substr(2*n,2),16);if(i!=i)break;e[r+n]=i}return n}static _utf8ToBytes(e,t){let r;t=t||1/0;let i=e.length,n=[],s=null;for(let o=0;o<i;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!s){if(r>56319||o+1===i){(t-=3)>-1&&n.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&n.push(239,191,189),s=r;continue}r=(s-55296<<10|r-56320)+65536}else s&&(t-=3)>-1&&n.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;n.push(r)}else if(r<2048){if((t-=2)<0)break;n.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;n.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;n.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return n}static _base64ToBytes(e){return function(e){let t,r;let i=function(e){let t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");let r=e.indexOf("=");-1===r&&(r=t);let i=r===t?0:4-r%4;return[r,i]}(e),n=i[0],o=i[1],a=new Uint8Array((n+o)*3/4-o),d=0,h=o>0?n-4:n;for(r=0;r<h;r+=4)t=s[e.charCodeAt(r)]<<18|s[e.charCodeAt(r+1)]<<12|s[e.charCodeAt(r+2)]<<6|s[e.charCodeAt(r+3)],a[d++]=t>>16&255,a[d++]=t>>8&255,a[d++]=255&t;return 2===o&&(t=s[e.charCodeAt(r)]<<2|s[e.charCodeAt(r+1)]>>4,a[d++]=255&t),1===o&&(t=s[e.charCodeAt(r)]<<10|s[e.charCodeAt(r+1)]<<4|s[e.charCodeAt(r+2)]>>2,a[d++]=t>>8&255,a[d++]=255&t),a}(function(e){if((e=(e=e.split("=")[0]).trim().replace(l,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}static _asciiToBytes(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}static _utf16leToBytes(e,t){let r,i;let n=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)i=(r=e.charCodeAt(s))>>8,n.push(r%256),n.push(i);return n}static _hexSlice(e,t,r){let i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);let n="";for(let i=t;i<r;++i)n+=h[e[i]];return n}static _base64Slice(e,t,r){return 0===t&&r===e.length?a(e):a(e.slice(t,r))}static _utf8Slice(e,t,r){r=Math.min(e.length,r);let i=[],n=t;for(;n<r;){let t=e[n],s=null,o=t>239?4:t>223?3:t>191?2:1;if(n+o<=r){let r,i,a,d;switch(o){case 1:t<128&&(s=t);break;case 2:(192&(r=e[n+1]))==128&&(d=(31&t)<<6|63&r)>127&&(s=d);break;case 3:r=e[n+1],i=e[n+2],(192&r)==128&&(192&i)==128&&(d=(15&t)<<12|(63&r)<<6|63&i)>2047&&(d<55296||d>57343)&&(s=d);break;case 4:r=e[n+1],i=e[n+2],a=e[n+3],(192&r)==128&&(192&i)==128&&(192&a)==128&&(d=(15&t)<<18|(63&r)<<12|(63&i)<<6|63&a)>65535&&d<1114112&&(s=d)}}null===s?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),n+=o}return d._decodeCodePointsArray(i)}static _decodeCodePointsArray(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}static _asciiSlice(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}static _latin1Slice(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}static _utf16leSlice(e,t,r){let i=e.slice(t,r),n="";for(let e=0;e<i.length-1;e+=2)n+=String.fromCharCode(i[e]+256*i[e+1]);return n}static _arrayIndexOf(e,t,r,i,n){let s,o=1,a=e.length,h=t.length;if(void 0!==i&&("ucs2"===(i=d._getEncoding(i))||"utf16le"===i)){if(e.length<2||t.length<2)return -1;o=2,a/=2,h/=2,r/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(n){let i=-1;for(s=r;s<a;s++)if(l(e,s)===l(t,-1===i?0:s-i)){if(-1===i&&(i=s),s-i+1===h)return i*o}else -1!==i&&(s-=s-i),i=-1}else for(r+h>a&&(r=a-h),s=r;s>=0;s--){let r=!0;for(let i=0;i<h;i++)if(l(e,s+i)!==l(t,i)){r=!1;break}if(r)return s}return -1}static _checkOffset(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}static _checkInt(e,t,r,i,n,s){if(!d.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw RangeError('"value" argument is out of bounds');if(r+i>e.length)throw RangeError("Index out of range")}static _getEncoding(e){let t=!1,r="";for(;;)switch(e){case"hex":return"hex";case"utf8":return"utf8";case"ascii":return"ascii";case"binary":return"binary";case"latin1":return"latin1";case"ucs2":return"ucs2";case"utf16le":return"utf16le";case"base64":return"base64";default:if(t)throw TypeError("Unknown or unsupported encoding: "+r);t=!0,r=e,e=e.toLowerCase()}}}let h=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let i=16*r;for(let n=0;n<16;++n)t[i+n]=e[r]+e[n]}return t}(),l=/[^+/0-9A-Za-z-_]/g;function c(e){return null!=e}function u(e){return Object.fromEntries(Object.entries(e).filter(([,e])=>c(e)))}function p(e){try{return e instanceof Blob}catch(e){return!1}}function m(e){return!!e&&"object"==typeof e&&!Array.isArray(e)&&!(e instanceof Date)&&!p(e)}function f(e){return null!=e}function y(e){return f(e)&&"string"==typeof e}function N(e){return f(e)&&"number"==typeof e}async function b(e){return new Promise(t=>setTimeout(t,e))}var w,g,v,k,x,I,T,O,C,B,W,V,A,q=e=>{throw TypeError(e)},S=(e,t,r)=>t.has(e)||q("Cannot "+r),E=(e,t,r)=>(S(e,t,"read from private field"),r?r.call(e):t.get(e)),P=(e,t,r)=>t.has(e)?q("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),D=(e,t,r,i)=>(S(e,t,"write to private field"),t.set(e,r),r),_=(e,t,r)=>(S(e,t,"access private method"),r);class L{constructor(e=10){P(this,k),P(this,w),P(this,g),P(this,v),D(this,g,[]),D(this,v,e),this.running=0,this.started=0}setFetch(e){D(this,w,e)}getFetch(){if(!E(this,w))throw Error("Fetch not set");return E(this,w)}request(e,t){let r=new Date,i=this.getFetch(),n=async(s=!1)=>{let o;let{promise:a,cancel:d}={cancel:()=>clearTimeout(o),promise:new Promise(e=>{o=setTimeout(()=>{e()},3e5)})},h=await Promise.race([i(e,t),a.then(()=>null)]).finally(d);if(!h)throw Error("Request timed out");if(429===h.status){let e=function(e){if(N(e))return e;if(y(e)){let t=Number(e);if(!Number.isNaN(t))return t}}(h.headers?.get("x-ratelimit-reset"))??1;return await b(1e3*e),await n(!0)}if(s){let e=new Date().getTime()-r.getTime();console.warn(`A request to Xata hit branch rate limits, was retried and stalled for ${e}ms`)}return h};return _(this,k,x).call(this,async()=>await n())}}function R(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}w=new WeakMap,g=new WeakMap,v=new WeakMap,k=new WeakSet,x=function(e){let t=new Promise(e=>E(this,g).push(e)).finally(()=>{this.started--,this.running++}).then(()=>e()).finally(()=>{this.running--;let e=E(this,g).shift();void 0!==e&&(this.started++,e())});if(this.running+this.started<E(this,v)){let e=E(this,g).shift();void 0!==e&&(this.started++,e())}return t};class M extends Error{constructor(e,t){super(e,t)}}class U extends M{constructor(e,t,r){super(j(t)),this.status=e,this.errors=F(t)?t.errors:[{message:j(t),status:e}],this.requestId=r,t instanceof Error&&(this.stack=t.stack,this.cause=t.cause)}toString(){let e=super.toString();return`[${this.status}] (${this.requestId??"Unknown"}): ${e}`}}function F(e){return m(e)&&Array.isArray(e.errors)}function j(e){return e instanceof Error?e.message:y(e)?e:m(e)&&y(e.message)?e.message:F(e)?"Bulk operation failed":"Unexpected error"}let $={production:{main:"https://api.xata.io",workspaces:"https://{workspaceId}.{region}.xata.sh"},staging:{main:"https://api.staging-xata.dev",workspaces:"https://{workspaceId}.{region}.staging-xata.dev"},dev:{main:"https://api.dev-xata.dev",workspaces:"https://{workspaceId}.{region}.dev-xata.dev"},local:{main:"http://localhost:6001",workspaces:"http://{workspaceId}.{region}.localhost:6001"}},Q=new L,J=(e,t={},r={})=>{let i=new URLSearchParams(Object.entries(t).reduce((e,[t,r])=>null==r?e:{...e,[t]:r},{})).toString(),n=i.length>0?`?${i}`:"",s=Object.entries(r).reduce((e,[t,r])=>({...e,[t]:encodeURIComponent(String(r??"")).replace("%3A",":")}),{});return e.replace(/\{\w*\}/g,e=>s[e.slice(1,-1)])+n};async function K(e,t){if(!f(e))return;if(p(e)||"function"==typeof e.text)return e;let{"Content-Type":r}=t??{};return"application/json"===String(r).toLowerCase()&&m(e)?JSON.stringify(e):e}let z=R();async function H({url:e,method:t,body:r,headers:n,pathParams:s,queryParams:o,fetch:a,apiKey:d,endpoint:h,apiUrl:l,workspacesApiUrl:p,trace:m,signal:N,clientID:b,sessionID:w,clientName:g,xataAgentExtra:v,fetchOptions:k={},rawResponse:x=!1}){return Q.setFetch(a),await m(`${t.toUpperCase()} ${e}`,async({setAttributes:a})=>{let m=J(function({method:e,endpoint:t,path:r,workspacesApiUrl:i,apiUrl:n,pathParams:s={}}){if("dataPlane"===t){let t=y(i)?`${i}${r}`:i(r,s);if("PUT"===e.toUpperCase()&&["/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file","/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}"].includes(r)){let{host:e}=function(e){if(!y(e))return null;let[t,r]=Object.entries({production:e.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.xata\.sh\/db\/([^:]+):?(.*)?/),staging:e.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.staging-xata\.dev\/db\/([^:]+):?(.*)?/),dev:e.match(/(?:https:\/\/)?([^.]+)(?:\.([^.]+))\.dev-xata\.dev\/db\/([^:]+):?(.*)?/),local:e.match(/(?:https?:\/\/)?([^.]+)(?:\.([^.]+))\.localhost:(?:\d+)\/db\/([^:]+):?(.*)?/)}).find(([,e])=>null!==e)??[];return y(t)&&Object.keys($).includes(t)&&r?{workspace:r[1],region:r[2],database:r[3],branch:r[4],host:t}:null}(t)??{};switch(e){case"production":t=t.replace("xata.sh","upload.xata.sh");break;case"staging":t=t.replace("staging-xata.dev","upload.staging-xata.dev");break;case"dev":t=t.replace("dev-xata.dev","upload.dev-xata.dev")}}let n=y(s.workspace)?t.replace("{workspaceId}",String(s.workspace)):t;return y(s.region)?n.replace("{region}",String(s.region)):n}return`${n}${r}`}({method:t,endpoint:h,path:e,workspacesApiUrl:p,pathParams:s,apiUrl:l}),o,s),I=m.includes("localhost")?m.replace(/^[^.]+\.[^.]+\./,"http://"):m;a({[i.HTTP_URL]:I,[i.HTTP_TARGET]:J(e,o,s)});let T=[["client","TS_SDK"],["version","0.29.5"],f(g)?["service",g]:void 0,...Object.entries(v??{})].filter(c).map(([e,t])=>`${e}=${t}`).join("; "),O=u({"Accept-Encoding":"identity","Content-Type":"application/json","X-Xata-Client-ID":b??z,"X-Xata-Session-ID":w??R(),"X-Xata-Agent":T,...n,...function(e){let{groups:t}=/.*:\/\/(?<host>[^/]+).*/.exec(e)??{};return t?.host?{Host:t.host}:{}}(m),Authorization:`Bearer ${d}`}),C=await Q.request(I,{...k,method:t.toUpperCase(),body:await K(r,O),headers:O,signal:N}),{host:B,protocol:W}=function(e){try{let{host:t,protocol:r}=new URL(e);return{host:t,protocol:r}}catch(e){return{}}}(C.url),V=C.headers?.get("x-request-id")??void 0;a({[i.KIND]:"http",[i.HTTP_REQUEST_ID]:V,[i.HTTP_STATUS_CODE]:C.status,[i.HTTP_HOST]:B,[i.HTTP_SCHEME]:W?.replace(":",""),[i.CLOUDFLARE_RAY_ID]:C.headers?.get("cf-ray")??void 0});let A=C.headers?.get("x-xata-message");if(A&&console.warn(A),204===C.status)return{};if(429===C.status)throw new U(C.status,"Rate limit exceeded",V);try{let e=x?await C.blob():await C.json();if(C.ok)return e;throw new U(C.status,e,V)}catch(e){throw new U(C.status,e,V)}},{[i.HTTP_METHOD]:t.toUpperCase(),[i.HTTP_ROUTE]:e})}let G=async e=>H({...e,endpoint:"dataPlane"}),X=(e,t)=>G({url:"/db/{dbBranchName}",method:"get",...e,signal:t}),Z=async e=>H({...e,endpoint:"controlPlane"});!function e(t,r){let i={...t};for(let[t,n]of Object.entries(r))m(n)&&m(i[t])?i[t]=e(i[t],n):i[t]=n;return i}({migrations:{applyMigration:(e,t)=>G({url:"/db/{dbBranchName}/migrations/apply",method:"post",...e,signal:t}),startMigration:(e,t)=>G({url:"/db/{dbBranchName}/migrations/start",method:"post",...e,signal:t}),completeMigration:(e,t)=>G({url:"/db/{dbBranchName}/migrations/complete",method:"post",...e,signal:t}),rollbackMigration:(e,t)=>G({url:"/db/{dbBranchName}/migrations/rollback",method:"post",...e,signal:t}),adaptTable:(e,t)=>G({url:"/db/{dbBranchName}/migrations/adapt/{tableName}",method:"post",...e,signal:t}),adaptAllTables:(e,t)=>G({url:"/db/{dbBranchName}/migrations/adapt",method:"post",...e,signal:t}),getBranchMigrationJobStatus:(e,t)=>G({url:"/db/{dbBranchName}/migrations/status",method:"get",...e,signal:t}),getMigrationJobStatus:(e,t)=>G({url:"/db/{dbBranchName}/migrations/jobs/{jobId}",method:"get",...e,signal:t}),getMigrationHistory:(e,t)=>G({url:"/db/{dbBranchName}/migrations/history",method:"get",...e,signal:t}),getSchema:(e,t)=>G({url:"/db/{dbBranchName}/schema",method:"get",...e,signal:t}),getBranchMigrationHistory:(e,t)=>G({url:"/db/{dbBranchName}/migrations",method:"get",...e,signal:t}),getBranchMigrationPlan:(e,t)=>G({url:"/db/{dbBranchName}/migrations/plan",method:"post",...e,signal:t}),executeBranchMigrationPlan:(e,t)=>G({url:"/db/{dbBranchName}/migrations/execute",method:"post",...e,signal:t}),getBranchSchemaHistory:(e,t)=>G({url:"/db/{dbBranchName}/schema/history",method:"post",...e,signal:t}),compareBranchWithUserSchema:(e,t)=>G({url:"/db/{dbBranchName}/schema/compare",method:"post",...e,signal:t}),compareBranchSchemas:(e,t)=>G({url:"/db/{dbBranchName}/schema/compare/{branchName}",method:"post",...e,signal:t}),updateBranchSchema:(e,t)=>G({url:"/db/{dbBranchName}/schema/update",method:"post",...e,signal:t}),previewBranchSchemaEdit:(e,t)=>G({url:"/db/{dbBranchName}/schema/preview",method:"post",...e,signal:t}),applyBranchSchemaEdit:(e,t)=>G({url:"/db/{dbBranchName}/schema/apply",method:"post",...e,signal:t}),pushBranchMigrations:(e,t)=>G({url:"/db/{dbBranchName}/schema/push",method:"post",...e,signal:t})},branch:{getBranchList:(e,t)=>G({url:"/dbs/{dbName}",method:"get",...e,signal:t}),getBranchDetails:X,createBranch:(e,t)=>G({url:"/db/{dbBranchName}",method:"put",...e,signal:t}),deleteBranch:(e,t)=>G({url:"/db/{dbBranchName}",method:"delete",...e,signal:t}),copyBranch:(e,t)=>G({url:"/db/{dbBranchName}/copy",method:"post",...e,signal:t}),updateBranchMetadata:(e,t)=>G({url:"/db/{dbBranchName}/metadata",method:"put",...e,signal:t}),getBranchMetadata:(e,t)=>G({url:"/db/{dbBranchName}/metadata",method:"get",...e,signal:t}),getBranchStats:(e,t)=>G({url:"/db/{dbBranchName}/stats",method:"get",...e,signal:t}),getGitBranchesMapping:(e,t)=>G({url:"/dbs/{dbName}/gitBranches",method:"get",...e,signal:t}),addGitBranchesEntry:(e,t)=>G({url:"/dbs/{dbName}/gitBranches",method:"post",...e,signal:t}),removeGitBranchesEntry:(e,t)=>G({url:"/dbs/{dbName}/gitBranches",method:"delete",...e,signal:t}),resolveBranch:(e,t)=>G({url:"/dbs/{dbName}/resolveBranch",method:"get",...e,signal:t})},database:{getDatabaseSettings:(e,t)=>G({url:"/dbs/{dbName}/settings",method:"get",...e,signal:t}),updateDatabaseSettings:(e,t)=>G({url:"/dbs/{dbName}/settings",method:"patch",...e,signal:t})},migrationRequests:{queryMigrationRequests:(e,t)=>G({url:"/dbs/{dbName}/migrations/query",method:"post",...e,signal:t}),createMigrationRequest:(e,t)=>G({url:"/dbs/{dbName}/migrations",method:"post",...e,signal:t}),getMigrationRequest:(e,t)=>G({url:"/dbs/{dbName}/migrations/{mrNumber}",method:"get",...e,signal:t}),updateMigrationRequest:(e,t)=>G({url:"/dbs/{dbName}/migrations/{mrNumber}",method:"patch",...e,signal:t}),listMigrationRequestsCommits:(e,t)=>G({url:"/dbs/{dbName}/migrations/{mrNumber}/commits",method:"post",...e,signal:t}),compareMigrationRequest:(e,t)=>G({url:"/dbs/{dbName}/migrations/{mrNumber}/compare",method:"post",...e,signal:t}),getMigrationRequestIsMerged:(e,t)=>G({url:"/dbs/{dbName}/migrations/{mrNumber}/merge",method:"get",...e,signal:t}),mergeMigrationRequest:(e,t)=>G({url:"/dbs/{dbName}/migrations/{mrNumber}/merge",method:"post",...e,signal:t})},table:{createTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}",method:"put",...e,signal:t}),deleteTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}",method:"delete",...e,signal:t}),updateTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}",method:"patch",...e,signal:t}),getTableSchema:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/schema",method:"get",...e,signal:t}),setTableSchema:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/schema",method:"put",...e,signal:t}),getTableColumns:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/columns",method:"get",...e,signal:t}),addTableColumn:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/columns",method:"post",...e,signal:t}),getColumn:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"get",...e,signal:t}),updateColumn:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"patch",...e,signal:t}),deleteColumn:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/columns/{columnName}",method:"delete",...e,signal:t})},records:{branchTransaction:(e,t)=>G({url:"/db/{dbBranchName}/transaction",method:"post",...e,signal:t}),insertRecord:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data",method:"post",...e,signal:t}),getRecord:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"get",...e,signal:t}),insertRecordWithID:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"put",...e,signal:t}),updateRecordWithID:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"patch",...e,signal:t}),upsertRecordWithID:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"post",...e,signal:t}),deleteRecord:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}",method:"delete",...e,signal:t}),bulkInsertTableRecords:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/bulk",method:"post",...e,signal:t})},files:{getFileItem:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"get",...e,signal:t}),putFileItem:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"put",...e,signal:t}),deleteFileItem:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file/{fileId}",method:"delete",...e,signal:t}),getFile:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"get",...e,signal:t}),putFile:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"put",...e,signal:t}),deleteFile:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/data/{recordId}/column/{columnName}/file",method:"delete",...e,signal:t}),fileAccess:(e,t)=>G({url:"/file/{fileId}",method:"get",...e,signal:t}),fileUpload:(e,t)=>G({url:"/file/{fileId}",method:"put",...e,signal:t})},searchAndFilter:{queryTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/query",method:"post",...e,signal:t}),searchBranch:(e,t)=>G({url:"/db/{dbBranchName}/search",method:"post",...e,signal:t}),searchTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/search",method:"post",...e,signal:t}),vectorSearchTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/vectorSearch",method:"post",...e,signal:t}),askTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/ask",method:"post",...e,signal:t}),askTableSession:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/ask/{sessionId}",method:"post",...e,signal:t}),summarizeTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/summarize",method:"post",...e,signal:t}),aggregateTable:(e,t)=>G({url:"/db/{dbBranchName}/tables/{tableName}/aggregate",method:"post",...e,signal:t})},sql:{sqlQuery:(e,t)=>G({url:"/db/{dbBranchName}/sql",method:"post",...e,signal:t}),sqlBatchQuery:(e,t)=>G({url:"/db/{dbBranchName}/sql/batch",method:"post",...e,signal:t})}},{oAuth:{getAuthorizationCode:(e,t)=>Z({url:"/oauth/authorize",method:"get",...e,signal:t}),grantAuthorizationCode:(e,t)=>Z({url:"/oauth/authorize",method:"post",...e,signal:t}),getUserOAuthClients:(e,t)=>Z({url:"/user/oauth/clients",method:"get",...e,signal:t}),deleteUserOAuthClient:(e,t)=>Z({url:"/user/oauth/clients/{clientId}",method:"delete",...e,signal:t}),getUserOAuthAccessTokens:(e,t)=>Z({url:"/user/oauth/tokens",method:"get",...e,signal:t}),deleteOAuthAccessToken:(e,t)=>Z({url:"/user/oauth/tokens/{token}",method:"delete",...e,signal:t}),updateOAuthAccessToken:(e,t)=>Z({url:"/user/oauth/tokens/{token}",method:"patch",...e,signal:t})},users:{getUser:(e,t)=>Z({url:"/user",method:"get",...e,signal:t}),updateUser:(e,t)=>Z({url:"/user",method:"put",...e,signal:t}),deleteUser:(e,t)=>Z({url:"/user",method:"delete",...e,signal:t})},authentication:{getUserAPIKeys:(e,t)=>Z({url:"/user/keys",method:"get",...e,signal:t}),createUserAPIKey:(e,t)=>Z({url:"/user/keys/{keyName}",method:"post",...e,signal:t}),deleteUserAPIKey:(e,t)=>Z({url:"/user/keys/{keyName}",method:"delete",...e,signal:t})},workspaces:{getWorkspacesList:(e,t)=>Z({url:"/workspaces",method:"get",...e,signal:t}),createWorkspace:(e,t)=>Z({url:"/workspaces",method:"post",...e,signal:t}),getWorkspace:(e,t)=>Z({url:"/workspaces/{workspaceId}",method:"get",...e,signal:t}),updateWorkspace:(e,t)=>Z({url:"/workspaces/{workspaceId}",method:"put",...e,signal:t}),deleteWorkspace:(e,t)=>Z({url:"/workspaces/{workspaceId}",method:"delete",...e,signal:t}),getWorkspaceSettings:(e,t)=>Z({url:"/workspaces/{workspaceId}/settings",method:"get",...e,signal:t}),updateWorkspaceSettings:(e,t)=>Z({url:"/workspaces/{workspaceId}/settings",method:"patch",...e,signal:t}),getWorkspaceMembersList:(e,t)=>Z({url:"/workspaces/{workspaceId}/members",method:"get",...e,signal:t}),updateWorkspaceMemberRole:(e,t)=>Z({url:"/workspaces/{workspaceId}/members/{userId}",method:"put",...e,signal:t}),removeWorkspaceMember:(e,t)=>Z({url:"/workspaces/{workspaceId}/members/{userId}",method:"delete",...e,signal:t})},invites:{inviteWorkspaceMember:(e,t)=>Z({url:"/workspaces/{workspaceId}/invites",method:"post",...e,signal:t}),updateWorkspaceMemberInvite:(e,t)=>Z({url:"/workspaces/{workspaceId}/invites/{inviteId}",method:"patch",...e,signal:t}),cancelWorkspaceMemberInvite:(e,t)=>Z({url:"/workspaces/{workspaceId}/invites/{inviteId}",method:"delete",...e,signal:t}),acceptWorkspaceMemberInvite:(e,t)=>Z({url:"/workspaces/{workspaceId}/invites/{inviteKey}/accept",method:"post",...e,signal:t}),resendWorkspaceMemberInvite:(e,t)=>Z({url:"/workspaces/{workspaceId}/invites/{inviteId}/resend",method:"post",...e,signal:t})},xbcontrolOther:{listClusters:(e,t)=>Z({url:"/workspaces/{workspaceId}/clusters",method:"get",...e,signal:t}),createCluster:(e,t)=>Z({url:"/workspaces/{workspaceId}/clusters",method:"post",...e,signal:t}),getCluster:(e,t)=>Z({url:"/workspaces/{workspaceId}/clusters/{clusterId}",method:"get",...e,signal:t}),updateCluster:(e,t)=>Z({url:"/workspaces/{workspaceId}/clusters/{clusterId}",method:"patch",...e,signal:t}),deleteCluster:(e,t)=>Z({url:"/workspaces/{workspaceId}/clusters/{clusterId}",method:"delete",...e,signal:t})},databases:{getDatabaseList:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs",method:"get",...e,signal:t}),createDatabase:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"put",...e,signal:t}),deleteDatabase:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"delete",...e,signal:t}),getDatabaseMetadata:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"get",...e,signal:t}),updateDatabaseMetadata:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}",method:"patch",...e,signal:t}),renameDatabase:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}/rename",method:"post",...e,signal:t}),getDatabaseGithubSettings:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"get",...e,signal:t}),updateDatabaseGithubSettings:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"put",...e,signal:t}),deleteDatabaseGithubSettings:(e,t)=>Z({url:"/workspaces/{workspaceId}/dbs/{dbName}/github",method:"delete",...e,signal:t}),listRegions:(e,t)=>Z({url:"/workspaces/{workspaceId}/regions",method:"get",...e,signal:t})}});function Y(e,...t){if(!f(e))return;let r=t.flatMap(e=>Object.entries(e).map(([e,t])=>{if("trim"===e){let{left:r=0,top:i=0,right:n=0,bottom:s=0}=t;return`${e}=${[i,n,s,r].join(";")}`}if("gravity"===e&&"object"==typeof t){let{x:r=.5,y:i=.5}=t;return`${e}=${[r,i].join("x")}`}return`${e}=${t}`})).join(","),{hostname:i,pathname:n,search:s}=new URL(e),o=n.split("/"),a=o.findIndex(e=>"transform"===e),d=a>=0?o.splice(a,2):[],h=`/transform/${[d[1],r].filter(f).join(",")}`,l=o.join("/");return`https://${i}${h}${l}${s}`}new WeakMap,new WeakMap;class ee{constructor(e){this.id=e.id,this.name=e.name,this.mediaType=e.mediaType,this.base64Content=e.base64Content,this.enablePublicUrl=e.enablePublicUrl,this.signedUrlTimeout=e.signedUrlTimeout,this.uploadUrlTimeout=e.uploadUrlTimeout,this.size=e.size,this.version=e.version,this.url=e.url,this.signedUrl=e.signedUrl,this.uploadUrl=e.uploadUrl,this.attributes=e.attributes}static fromBuffer(e,t={}){let r=e.toString("base64");return new ee({...t,base64Content:r})}toBuffer(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return d.from(this.base64Content,"base64")}static fromArrayBuffer(e,t={}){let r=new Uint8Array(e);return this.fromUint8Array(r,t)}toArrayBuffer(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return new ArrayBuffer(atob(this.base64Content).length)}static fromUint8Array(e,t={}){let r="";for(let t=0;t<e.byteLength;t++)r+=String.fromCharCode(e[t]);let i=btoa(r);return new ee({...t,base64Content:i})}toUint8Array(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');let e=atob(this.base64Content),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}static async fromBlob(e,t={}){let r=t.name??e.name,i=e.type,n=await e.arrayBuffer();return this.fromArrayBuffer(n,{...t,name:r,mediaType:i})}toBlob(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');let e=atob(this.base64Content),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new Blob([t],{type:this.mediaType})}static fromString(e,t={}){let r=btoa(e);return new ee({...t,base64Content:r})}toString(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return atob(this.base64Content)}static fromBase64(e,t={}){return new ee({...t,base64Content:e})}toBase64(){if(!this.base64Content)throw Error('File content is not available, please select property "base64Content" when querying the file');return this.base64Content}transform(...e){return{url:Y(this.url,...e),signedUrl:Y(this.signedUrl,...e),metadataUrl:Y(this.url,...e,{format:"json"}),metadataSignedUrl:Y(this.signedUrl,...e,{format:"json"})}}}var et=e=>{throw TypeError(e)},er=(e,t,r)=>t.has(e)||et("Cannot "+r);new WeakMap;class ei extends Array{constructor(...e){super(...ei.parseConstructorParams(...e))}static parseConstructorParams(...e){return 1===e.length&&"number"==typeof e[0]?Array(e[0]):e.length<=1&&Array.isArray(e[0]??[])?Array(...e[0]??[]):Array(...e)}toArray(){return Array(...this)}toSerializable(){return JSON.parse(this.toString())}toString(){return JSON.stringify(this.toArray())}map(e,t){return this.toArray().map(e,t)}}new WeakMap;var en=e=>{throw TypeError(e)},es=(e,t,r)=>t.has(e)||en("Cannot "+r);Symbol.asyncIterator,new WeakMap,new WeakMap,new WeakMap,new WeakSet;var eo=e=>{throw TypeError(e)},ea=(e,t,r)=>t.has(e)||eo("Cannot "+r),ed=(e,t,r)=>(ea(e,t,"read from private field"),r?r.call(e):t.get(e)),eh=(e,t,r,i)=>(ea(e,t,"write to private field"),t.set(e,r),r);new WeakMap,C=new WeakMap,new WeakMap,new WeakMap,B=new WeakMap,new WeakMap,new WeakSet;new WeakMap;new WeakMap;new WeakSet;class el{constructor(){this.classes={}}add(e){this.classes[e.name]=e}toJSON(e){return JSON.stringify(function e(t){if(Array.isArray(t))return t.map(e);let r=typeof t;if("undefined"===r)return{__:"undefined"};if("bigint"===r)return{__:"bigint",___:t.toString()};if(null===t||"object"!==r)return t;let i=t.constructor,n={__:i.name};for(let[r,i]of Object.entries(t))n[r]=e(i);return i===Date&&(n.___=t.toISOString()),i===Map&&(n.___=Object.fromEntries(t)),i===Set&&(n.___=[...t]),n}(e))}fromJSON(e){return JSON.parse(e,(e,t)=>{if(t&&"object"==typeof t&&!Array.isArray(t)){let{__:e,___:r,...i}=t,n=this.classes[e];if(n)return Object.assign(Object.create(n.prototype),i);if("Date"===e)return new Date(r);if("Set"===e)return new Set(r);if("Map"===e)return new Map(Object.entries(r));if("bigint"===e)return BigInt(r);if("undefined"===e)return;return i}return t})}}new el;var ec=r(92528),eu=r(21282),ep=r(96307),em=r(88961),ef=r(24004),ey=r(33321),eN=r(29798),eb=r(40488),ew=r(59075),eg=r(87090),ev=r(60904),ek=r(83496);class ex{#e;constructor(e){this.#e=(0,eg.vV)(e)}get expressionType(){}get isRawBuilder(){return!0}as(e){return new eT(this,e)}$castTo(){return new ex({...this.#e})}withPlugin(e){return new ex({...this.#e,plugins:void 0!==this.#e.plugins?(0,eg.vV)([...this.#e.plugins,e]):(0,eg.vV)([e])})}toOperationNode(){return this.#t(this.#r())}compile(e){return this.#i(this.#r(e))}async execute(e){let t=this.#r(e);return t.executeQuery(this.#i(t),this.#e.queryId)}#r(e){let t=void 0!==e?e.getExecutor():ev.H;return void 0!==this.#e.plugins?t.withPlugins(this.#e.plugins):t}#t(e){return e.transformQuery(this.#e.rawNode,this.#e.queryId)}#i(e){return e.compileQuery(this.#t(e),this.#e.queryId)}}function eI(e){return new ex(e)}(0,ew.q)(ex,"don't await RawBuilder instances directly. To execute the query you need to call `execute`");class eT{#n;#s;constructor(e,t){this.#n=e,this.#s=t}get expression(){return this.#n}get alias(){return this.#s}get rawBuilder(){return this.#n}toOperationNode(){return eb.i.create(this.#n.toOperationNode(),(0,ek.x)(this.#s)?this.#s.toOperationNode():ec.T.create(this.#s))}}(0,ew.q)(eT,"don't await AliasedRawBuilder instances directly. AliasedRawBuilder should never be executed directly since it's always a part of another query.");let eO=Object.assign((e,...t)=>eI({queryId:(0,eN.y)(),rawNode:eu.x.create(e,t?.map(ey.j2)??[])}),{ref:e=>eI({queryId:(0,eN.y)(),rawNode:eu.x.createWithChild((0,em.KX)(e))}),val:e=>eI({queryId:(0,eN.y)(),rawNode:eu.x.createWithChild((0,ey.j2)(e))}),value(e){return this.val(e)},table:e=>eI({queryId:(0,eN.y)(),rawNode:eu.x.createWithChild((0,ef.G2)(e))}),id(...e){let t=Array(e.length+1).fill(".");return t[0]="",t[t.length-1]="",eI({queryId:(0,eN.y)(),rawNode:eu.x.create(t,e.map(ec.T.create))})},lit:e=>eI({queryId:(0,eN.y)(),rawNode:eu.x.createWithChild(ep.g.createImmediate(e))}),literal(e){return this.lit(e)},raw:e=>eI({queryId:(0,eN.y)(),rawNode:eu.x.createWithSql(e)}),join(e,t=eO`, `){let r=Array(2*e.length-1),i=t.toOperationNode();for(let t=0;t<e.length;++t)r[2*t]=(0,ey.j2)(e[t]),t!==e.length-1&&(r[2*t+1]=i);return eI({queryId:(0,eN.y)(),rawNode:eu.x.createWithChildren(r)})}});class eC{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}}let eB=BigInt("3853314791062309107");class eW extends eC{get supportsTransactionalDdl(){return!0}get supportsReturning(){return!0}async acquireMigrationLock(e,t){await eO`select pg_advisory_xact_lock(${eO.lit(eB)})`.execute(e)}async releaseMigrationLock(e,t){}}var eV=r(30246);class eA{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#o=(0,eg.vV)({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this)});visitNode=e=>{this.nodeStack.push(e),this.#o[e.kind](e),this.nodeStack.pop()}}var eq=r(37353),eS=r(36007),eE=r(96016),eP=r(80005),eD=r(74613);class e_ extends eA{#a="";#d=[];get numParameters(){return this.#d.length}compileQuery(e){return this.#a="",this.#d=[],this.visitNode(e),(0,eg.vV)({query:e,sql:this.getSql(),parameters:[...this.#d]})}getSql(){return this.#a}visitSelectQuery(e){let t=void 0!==this.parentNode&&!eS.L.is(this.parentNode)&&!eV.P.is(this.parentNode)&&!eP.B.is(this.parentNode)&&!eD.M.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("select"),e.distinctOn&&(this.append(" "),this.compileDistinctOn(e.distinctOn)),e.frontModifiers?.length&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.selections&&(this.append(" "),this.compileList(e.selections)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.groupBy&&(this.append(" "),this.visitNode(e.groupBy)),e.having&&(this.append(" "),this.visitNode(e.having)),e.setOperations&&(this.append(" "),this.compileList(e.setOperations," ")),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.offset&&(this.append(" "),this.visitNode(e.offset)),e.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...e.endModifiers])," ")),t&&this.append(")")}visitFrom(e){this.append("from "),this.compileList(e.froms)}visitSelection(e){this.visitNode(e.selection)}visitColumn(e){this.visitNode(e.column)}compileDistinctOn(e){this.append("distinct on ("),this.compileList(e),this.append(")")}compileList(e,t=", "){let r=e.length-1;for(let i=0;i<=r;i++)this.visitNode(e[i]),i<r&&this.append(t)}visitWhere(e){this.append("where "),this.visitNode(e.where)}visitHaving(e){this.append("having "),this.visitNode(e.having)}visitInsertQuery(e){let t=this.nodeStack.find(eE.V.is)!==e;!t&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append(e.replace?"replace":"insert"),e.ignore&&this.append(" ignore"),this.append(" into "),this.visitNode(e.into),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.values&&(this.append(" "),this.visitNode(e.values)),e.onConflict&&(this.append(" "),this.visitNode(e.onConflict)),e.onDuplicateKey&&(this.append(" "),this.visitNode(e.onDuplicateKey)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")")}visitValues(e){this.append("values "),this.compileList(e.values)}visitDeleteQuery(e){let t=this.nodeStack.find(eE.V.is)!==e;!t&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("delete "),this.visitNode(e.from),e.using&&(this.append(" "),this.visitNode(e.using)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")")}visitReturning(e){this.append("returning "),this.compileList(e.selections)}visitAlias(e){this.visitNode(e.node),this.append(" as "),this.visitNode(e.alias)}visitReference(e){e.table&&(this.visitNode(e.table),this.append(".")),this.visitNode(e.column)}visitSelectAll(e){this.append("*")}visitIdentifier(e){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(e),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(e){if(!(0,eg.HD)(e.name))throw Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(e.name))}visitAnd(e){this.visitNode(e.left),this.append(" and "),this.visitNode(e.right)}visitOr(e){this.visitNode(e.left),this.append(" or "),this.visitNode(e.right)}visitValue(e){e.immediate?this.appendImmediateValue(e.value):this.appendValue(e.value)}visitValueList(e){this.append("("),this.compileList(e.values),this.append(")")}visitTuple(e){this.append("("),this.compileList(e.values),this.append(")")}visitPrimitiveValueList(e){this.append("(");let{values:t}=e;for(let e=0;e<t.length;++e)this.appendValue(t[e]),e!==t.length-1&&this.append(", ");this.append(")")}visitParens(e){this.append("("),this.visitNode(e.node),this.append(")")}visitJoin(e){this.append(eM[e.joinType]),this.append(" "),this.visitNode(e.table),e.on&&(this.append(" "),this.visitNode(e.on))}visitOn(e){this.append("on "),this.visitNode(e.on)}visitRaw(e){let{sqlFragments:t,parameters:r}=e;for(let e=0;e<t.length;++e)this.append(t[e]),r.length>e&&this.visitNode(r[e])}visitOperator(e){this.append(e.operator)}visitTable(e){this.visitNode(e.table)}visitSchemableIdentifier(e){e.schema&&(this.visitNode(e.schema),this.append(".")),this.visitNode(e.identifier)}visitCreateTable(e){this.append("create "),e.frontModifiers&&e.frontModifiers.length>0&&(this.compileList(e.frontModifiers," "),this.append(" ")),e.temporary&&this.append("temporary "),this.append("table "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.table),this.append(" ("),this.compileList([...e.columns,...e.constraints??[]]),this.append(")"),e.onCommit&&(this.append(" on commit "),this.append(e.onCommit)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}visitColumnDefinition(e){this.visitNode(e.column),this.append(" "),this.visitNode(e.dataType),e.unsigned&&this.append(" unsigned"),e.frontModifiers&&e.frontModifiers.length>0&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.generated&&(this.append(" "),this.visitNode(e.generated)),e.defaultTo&&(this.append(" "),this.visitNode(e.defaultTo)),e.notNull&&this.append(" not null"),e.unique&&this.append(" unique"),e.primaryKey&&this.append(" primary key"),e.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),e.references&&(this.append(" "),this.visitNode(e.references)),e.check&&(this.append(" "),this.visitNode(e.check)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(e){this.append("references "),this.visitNode(e.table),this.append(" ("),this.compileList(e.columns),this.append(")"),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitDropTable(e){this.append("drop table "),e.ifExists&&this.append("if exists "),this.visitNode(e.table),e.cascade&&this.append(" cascade")}visitDataType(e){this.append(e.dataType)}visitOrderBy(e){this.append("order by "),this.compileList(e.items)}visitOrderByItem(e){this.visitNode(e.orderBy),e.direction&&(this.append(" "),this.visitNode(e.direction))}visitGroupBy(e){this.append("group by "),this.compileList(e.items)}visitGroupByItem(e){this.visitNode(e.groupBy)}visitUpdateQuery(e){let t=this.nodeStack.find(eE.V.is)!==e;!t&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("update "),this.visitNode(e.table),this.append(" set "),e.updates&&this.compileList(e.updates),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")")}visitColumnUpdate(e){this.visitNode(e.column),this.append(" = "),this.visitNode(e.value)}visitLimit(e){this.append("limit "),this.visitNode(e.limit)}visitOffset(e){this.append("offset "),this.visitNode(e.offset)}visitOnConflict(e){this.append("on conflict"),e.columns?(this.append(" ("),this.compileList(e.columns),this.append(")")):e.constraint?(this.append(" on constraint "),this.visitNode(e.constraint)):e.indexExpression&&(this.append(" ("),this.visitNode(e.indexExpression),this.append(")")),e.indexWhere&&(this.append(" "),this.visitNode(e.indexWhere)),!0===e.doNothing?this.append(" do nothing"):e.updates&&(this.append(" do update set "),this.compileList(e.updates),e.updateWhere&&(this.append(" "),this.visitNode(e.updateWhere)))}visitOnDuplicateKey(e){this.append("on duplicate key update "),this.compileList(e.updates)}visitCreateIndex(e){this.append("create "),e.unique&&this.append("unique "),this.append("index "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.using&&(this.append(" using "),this.visitNode(e.using)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.where&&(this.append(" "),this.visitNode(e.where))}visitDropIndex(e){this.append("drop index "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.cascade&&this.append(" cascade")}visitCreateSchema(e){this.append("create schema "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.schema)}visitDropSchema(e){this.append("drop schema "),e.ifExists&&this.append("if exists "),this.visitNode(e.schema),e.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("primary key ("),this.compileList(e.columns),this.append(")")}visitUniqueConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("unique ("),this.compileList(e.columns),this.append(")")}visitCheckConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("check ("),this.visitNode(e.expression),this.append(")")}visitForeignKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("foreign key ("),this.compileList(e.columns),this.append(") "),this.visitNode(e.references),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitList(e){this.compileList(e.items)}visitWith(e){this.append("with "),e.recursive&&this.append("recursive "),this.compileList(e.expressions)}visitCommonTableExpression(e){this.visitNode(e.name),this.append(" as "),(0,eg.jn)(e.materialized)&&(e.materialized||this.append("not "),this.append("materialized ")),this.visitNode(e.expression)}visitCommonTableExpressionName(e){this.visitNode(e.table),e.columns&&(this.append("("),this.compileList(e.columns),this.append(")"))}visitAlterTable(e){this.append("alter table "),this.visitNode(e.table),this.append(" "),e.renameTo&&(this.append("rename to "),this.visitNode(e.renameTo)),e.setSchema&&(this.append("set schema "),this.visitNode(e.setSchema)),e.addConstraint&&this.visitNode(e.addConstraint),e.dropConstraint&&this.visitNode(e.dropConstraint),e.columnAlterations&&this.compileList(e.columnAlterations)}visitAddColumn(e){this.append("add column "),this.visitNode(e.column)}visitRenameColumn(e){this.append("rename column "),this.visitNode(e.column),this.append(" to "),this.visitNode(e.renameTo)}visitDropColumn(e){this.append("drop column "),this.visitNode(e.column)}visitAlterColumn(e){this.append("alter column "),this.visitNode(e.column),this.append(" "),e.dataType&&(this.append("type "),this.visitNode(e.dataType),e.dataTypeExpression&&(this.append("using "),this.visitNode(e.dataTypeExpression))),e.setDefault&&(this.append("set default "),this.visitNode(e.setDefault)),e.dropDefault&&this.append("drop default"),e.setNotNull&&this.append("set not null"),e.dropNotNull&&this.append("drop not null")}visitModifyColumn(e){this.append("modify column "),this.visitNode(e.column)}visitAddConstraint(e){this.append("add "),this.visitNode(e.constraint)}visitDropConstraint(e){this.append("drop constraint "),e.ifExists&&this.append("if exists "),this.visitNode(e.constraintName),"cascade"===e.modifier?this.append(" cascade"):"restrict"===e.modifier&&this.append(" restrict")}visitSetOperation(e){this.append(e.operator),this.append(" "),e.all&&this.append("all "),this.visitNode(e.expression)}visitCreateView(e){this.append("create "),e.orReplace&&this.append("or replace "),e.materialized&&this.append("materialized "),e.temporary&&this.append("temporary "),this.append("view "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),this.append(" "),e.columns&&(this.append("("),this.compileList(e.columns),this.append(") ")),e.as&&(this.append("as "),this.visitNode(e.as))}visitDropView(e){this.append("drop "),e.materialized&&this.append("materialized "),this.append("view "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.cascade&&this.append(" cascade")}visitGenerated(e){this.append("generated "),e.always&&this.append("always "),e.byDefault&&this.append("by default "),this.append("as "),e.identity&&this.append("identity"),e.expression&&(this.append("("),this.visitNode(e.expression),this.append(")")),e.stored&&this.append(" stored")}visitDefaultValue(e){this.append("default "),this.visitNode(e.defaultValue)}visitSelectModifier(e){e.rawModifier?this.visitNode(e.rawModifier):this.append(eL[e.modifier])}visitCreateType(e){this.append("create type "),this.visitNode(e.name),e.enum&&(this.append(" as enum "),this.visitNode(e.enum))}visitDropType(e){this.append("drop type "),e.ifExists&&this.append("if exists "),this.visitNode(e.name)}visitExplain(e){this.append("explain"),(e.options||e.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),e.options&&(this.visitNode(e.options),e.format&&this.append(this.getExplainOptionsDelimiter())),e.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(e.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(e){this.append("default")}visitAggregateFunction(e){this.append(e.func),this.append("("),e.distinct&&this.append("distinct "),this.compileList(e.aggregated),this.append(")"),e.filter&&(this.append(" filter("),this.visitNode(e.filter),this.append(")")),e.over&&(this.append(" "),this.visitNode(e.over))}visitOver(e){this.append("over("),e.partitionBy&&(this.visitNode(e.partitionBy),e.orderBy&&this.append(" ")),e.orderBy&&this.visitNode(e.orderBy),this.append(")")}visitPartitionBy(e){this.append("partition by "),this.compileList(e.items)}visitPartitionByItem(e){this.visitNode(e.partitionBy)}visitBinaryOperation(e){this.visitNode(e.leftOperand),this.append(" "),this.visitNode(e.operator),this.append(" "),this.visitNode(e.rightOperand)}visitUnaryOperation(e){this.visitNode(e.operator),this.isMinusOperator(e.operator)||this.append(" "),this.visitNode(e.operand)}isMinusOperator(e){return eq.$X.is(e)&&"-"===e.operator}visitUsing(e){this.append("using "),this.compileList(e.tables)}visitFunction(e){this.append(e.func),this.append("("),this.compileList(e.arguments),this.append(")")}visitCase(e){this.append("case"),e.value&&(this.append(" "),this.visitNode(e.value)),e.when&&(this.append(" "),this.compileList(e.when," ")),e.else&&(this.append(" else "),this.visitNode(e.else)),this.append(" end"),e.isStatement&&this.append(" case")}visitWhen(e){this.append("when "),this.visitNode(e.condition),e.result&&(this.append(" then "),this.visitNode(e.result))}visitJSONReference(e){this.visitNode(e.reference),this.visitNode(e.traversal)}visitJSONPath(e){for(let t of(e.inOperator&&this.visitNode(e.inOperator),this.append("'$"),e.pathLegs))this.visitNode(t);this.append("'")}visitJSONPathLeg(e){let t="ArrayLocation"===e.type;this.append(t?"[":"."),this.append(String(e.value)),t&&this.append("]")}visitJSONOperatorChain(e){for(let t=0,r=e.values.length;t<r;t++)t===r-1?this.visitNode(e.operator):this.append("->"),this.visitNode(e.values[t])}append(e){this.#a+=e}appendValue(e){this.addParameter(e),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(e){let t=this.getLeftIdentifierWrapper(),r=this.getRightIdentifierWrapper(),i="";for(let n of e)i+=n,n===t?i+=t:n===r&&(i+=r);return i}addParameter(e){this.#d.push(e)}appendImmediateValue(e){if((0,eg.HD)(e))this.append(`'${e}'`);else if((0,eg.hj)(e)||(0,eg.jn)(e))this.append(e.toString());else if((0,eg.Ft)(e))this.append("null");else if((0,eg.J_)(e))this.appendImmediateValue(e.toISOString());else if((0,eg.C4)(e))this.appendImmediateValue(e.toString());else throw Error(`invalid immediate value ${e}`)}sortSelectModifiers(e){return e.sort((e,t)=>e.modifier&&t.modifier?eR[e.modifier]-eR[t.modifier]:1),(0,eg.vV)(e)}}let eL=(0,eg.vV)({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),eR=(0,eg.vV)({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),eM=(0,eg.vV)({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral"}),eU=/"/g;class eF extends e_{sanitizeIdentifier(e){return e.replace(eU,'""')}}(0,eg.vV)({__noMigrations__:!0});class ej{#h;constructor(e){this.#h=e}async getSchemas(){return(await this.#h.selectFrom("pg_catalog.pg_namespace").select("nspname").$castTo().execute()).map(e=>({name:e.nspname}))}async getTables(e={withInternalKyselyTables:!1}){let t=this.#h.selectFrom("pg_catalog.pg_attribute as a").innerJoin("pg_catalog.pg_class as c","a.attrelid","c.oid").innerJoin("pg_catalog.pg_namespace as ns","c.relnamespace","ns.oid").innerJoin("pg_catalog.pg_type as typ","a.atttypid","typ.oid").innerJoin("pg_catalog.pg_namespace as dtns","typ.typnamespace","dtns.oid").select(["a.attname as column","a.attnotnull as not_null","a.atthasdef as has_default","c.relname as table","c.relkind as table_type","ns.nspname as schema","typ.typname as type","dtns.nspname as type_schema",this.#h.selectFrom("pg_class").select(eO`true`.as("auto_incrementing")).whereRef("relnamespace","=","c.relnamespace").where("relkind","=","S").where("relname","=",eO`c.relname || '_' || a.attname || '_seq'`).as("auto_incrementing")]).where(e=>e.or([e("c.relkind","=","r"),e("c.relkind","=","v")])).where("ns.nspname","!~","^pg_").where("ns.nspname","!=","information_schema").where("a.attnum",">=",0).where("a.attisdropped","!=",!0).orderBy("ns.nspname").orderBy("c.relname").orderBy("a.attnum").$castTo();e.withInternalKyselyTables||(t=t.where("c.relname","!=","kysely_migration").where("c.relname","!=","kysely_migration_lock"));let r=await t.execute();return this.#l(r)}async getMetadata(e){return{tables:await this.getTables(e)}}#l(e){return e.reduce((e,t)=>{let r=e.find(e=>e.name===t.table&&e.schema===t.schema);return r||(r=(0,eg.vV)({name:t.table,isView:"v"===t.table_type,schema:t.schema,columns:[]}),e.push(r)),r.columns.push((0,eg.vV)({name:t.column,dataType:t.type,dataTypeSchema:t.type_schema,isNullable:!t.not_null,isAutoIncrementing:!!t.auto_incrementing,hasDefaultValue:t.has_default})),e},[])}}var e$=e=>{throw TypeError(e)},eQ=(e,t,r)=>t.has(e)||e$("Cannot "+r),eJ=(e,t,r)=>(eQ(e,t,"read from private field"),r?r.call(e):t.get(e)),eK=(e,t,r)=>t.has(e)?e$("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ez=(e,t,r,i)=>(eQ(e,t,"write to private field"),t.set(e,r),r);class eH{constructor(e){this.config=e}createAdapter(){return new eW}createDriver(){return new eG(this.config)}createQueryCompiler(){return new eF}createIntrospector(e){return new ej(e)}}class eG{constructor(e){this.config=e}async init(){}acquireConnection(){return Promise.resolve(new eX(this.config))}beginTransaction(){throw Error("Transactions are not supported yet.")}commitTransaction(){throw Error("Transactions are not supported yet.")}rollbackTransaction(){throw Error("Transactions are not supported yet.")}async releaseConnection(e){}async destroy(){}}class eX{constructor(e){eK(this,A),ez(this,A,e)}async executeQuery(e){let{sql:t}=eJ(this,A).xata,{sql:r,parameters:i}=e,{records:n,warning:s}=await t({statement:r,params:i,consistency:eJ(this,A).consistency});s&&console.warn(s);let o=BigInt(n.length);return{rows:n,numAffectedRows:o,numUpdatedOrDeletedRows:o}}async *streamQuery(e,t){throw Error("Driver does not support streaming")}}A=new WeakMap},75185:(e,t,r)=>{r.d(t,{Q:()=>o,a:()=>a});var i=r(83496),n=r(88961),s=r(87090);class o{#c;get dynamicReference(){return this.#c}get refType(){}constructor(e){this.#c=e}toOperationNode(){return(0,n.F9)(this.#c)}}function a(e){return(0,s.Kn)(e)&&(0,i.x)(e)&&(0,s.HD)(e.dynamicReference)}},36172:(e,t,r)=>{r.d(t,{b:()=>P,Z:()=>D});var i=r(89458),n=r(51508),s=r(24004),o=r(4351),a=r(29798),d=r(20540),h=r(88961),l=r(5152),c=r(36007),u=r(70295),p=r(37353),m=r(87090);let f=(0,m.vV)({is:e=>"UnaryOperationNode"===e.kind,create:(e,t)=>(0,m.vV)({kind:"UnaryOperationNode",operator:e,operand:t})});var y=r(33321),N=r(60904),b=r(31528),w=r(99875),g=r(40488),v=r(92528),k=r(37900);let x=(0,m.vV)({is:e=>"JSONPathLegNode"===e.kind,create:(e,t)=>(0,m.vV)({kind:"JSONPathLegNode",type:e,value:t})});var I=r(57697),T=r(65575),O=r(83496),C=r(96307);class B{#u;constructor(e){this.#u=e}at(e){return this.#p("ArrayLocation",e)}key(e){return this.#p("Member",e)}#p(e,t){return new W(T.y.cloneWithTraversal(this.#u,I.t.is(this.#u.traversal)?I.t.cloneWithLeg(this.#u.traversal,x.create(e,t)):k.s.cloneWithValue(this.#u.traversal,C.g.createImmediate(t))))}}class W extends B{#u;constructor(e){super(e),this.#u=e}get expressionType(){}as(e){return new V(this,e)}$castTo(){return new B(this.#u)}toOperationNode(){return this.#u}}class V{#m;#s;constructor(e,t){this.#m=e,this.#s=t}get expression(){return this.#m}get alias(){return this.#s}toOperationNode(){return g.i.create(this.#m.toOperationNode(),(0,O.x)(this.#s)?this.#s.toOperationNode():v.T.create(this.#s))}}var A=r(74559),q=r(25477),S=r(34581);let E=(0,m.vV)({is:e=>"TupleNode"===e.kind,create:e=>(0,m.vV)({kind:"TupleNode",values:(0,m.vV)(e)})});function P(e=N.H){function t(e,t){return new u.Pc(f.create(p.$X.create(e),(0,h.jI)(t)))}let r=Object.assign(function(e,t,r){return new u.Pc((0,l.i9)(e,t,r))},{fn:void 0,eb:void 0,selectFrom:t=>(0,i.u)({queryId:(0,a.y)(),executor:e,queryNode:n.a.createFrom((0,s._V)(t))}),selectNoFrom:t=>(0,i.u)({queryId:(0,a.y)(),executor:e,queryNode:n.a.cloneWithSelections(n.a.create(),(0,S.A)(t))}),case:e=>new b.wY({node:w.j.create((0,m.o8)(e)?void 0:(0,h.jI)(e))}),ref:(e,t)=>(0,m.o8)(t)?new u.Pc((0,h.KX)(e)):new B((0,h.D2)(e,t)),val:e=>new u.Pc((0,y.wZ)(e)),refTuple:(...e)=>new u.Pc(E.create(e.map(h.jI))),tuple:(...e)=>new u.Pc(E.create(e.map(y.j2))),lit:e=>new u.Pc((0,y.AB)(e)),cmpr:(e,t,r)=>new u.Pc((0,l.i9)(e,t,r)),bxp:(e,t,r)=>new u.Pc((0,l.i9)(e,t,r)),unary:t,not:e=>t("not",e),exists:e=>t("exists",e),neg:e=>t("-",e),between:(e,t,r)=>new u.Pc(A.a.create((0,h.jI)(e),p.$X.create("between"),q.O.create((0,y.j2)(t),(0,y.j2)(r)))),betweenSymmetric:(e,t,r)=>new u.Pc(A.a.create((0,h.jI)(e),p.$X.create("between symmetric"),q.O.create((0,y.j2)(t),(0,y.j2)(r)))),and:e=>new u.Pc((0,m.DM)(e)?(0,l.QX)(e,"and"):(0,l.Li)(e,"and")),or:e=>new u.Pc((0,m.DM)(e)?(0,l.QX)(e,"or"):(0,l.Li)(e,"or")),parens(...e){let t=(0,l.k0)(e);return new u.Pc(c.L.is(t)?t:c.L.create(t))},withSchema:t=>P(e.withPluginAtFront(new o.v(t)))});return r.fn=(0,d.W)(),r.eb=r,r}function D(e){return P()}},70295:(e,t,r)=>{r.d(t,{Pc:()=>l});var i=r(40488),n=r(25477),s=r(92528),o=r(83496),a=r(99344),d=r(36007),h=r(5152);class l{#u;constructor(e){this.#u=e}get expressionType(){}as(e){return new c(this,e)}or(...e){return new u(a.O.create(this.#u,(0,h.k0)(e)))}and(...e){return new p(n.O.create(this.#u,(0,h.k0)(e)))}$castTo(){return new l(this.#u)}toOperationNode(){return this.#u}}class c{#f;#s;constructor(e,t){this.#f=e,this.#s=t}get expression(){return this.#f}get alias(){return this.#s}toOperationNode(){return i.i.create(this.#f.toOperationNode(),(0,o.x)(this.#s)?this.#s.toOperationNode():s.T.create(this.#s))}}class u{#u;constructor(e){this.#u=e}get expressionType(){}as(e){return new c(this,e)}or(...e){return new u(a.O.create(this.#u,(0,h.k0)(e)))}$castTo(){return new u(this.#u)}toOperationNode(){return d.L.create(this.#u)}}class p{#u;constructor(e){this.#u=e}get expressionType(){}as(e){return new c(this,e)}and(...e){return new p(n.O.create(this.#u,(0,h.k0)(e)))}$castTo(){return new p(this.#u)}toOperationNode(){return d.L.create(this.#u)}}},5871:(e,t,r)=>{r.d(t,{$2:()=>eL});var i=r(87090);let n=(0,i.vV)({is:e=>"AlterTableNode"===e.kind,create:e=>(0,i.vV)({kind:"AlterTableNode",table:e}),cloneWithTableProps:(e,t)=>(0,i.vV)({...e,...t}),cloneWithColumnAlteration:(e,t)=>(0,i.vV)({...e,columnAlterations:e.columnAlterations?[...e.columnAlterations,t]:[t]})});var s=r(92528);let o=(0,i.vV)({is:e=>"CreateIndexNode"===e.kind,create:e=>(0,i.vV)({kind:"CreateIndexNode",name:s.T.create(e)}),cloneWith:(e,t)=>(0,i.vV)({...e,...t}),cloneWithColumns:(e,t)=>(0,i.vV)({...e,columns:[...e.columns||[],...t]})}),a=(0,i.vV)({is:e=>"CreateSchemaNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"CreateSchemaNode",schema:s.T.create(e),...t}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})}),d=["preserve rows","delete rows","drop"],h=(0,i.vV)({is:e=>"CreateTableNode"===e.kind,create:e=>(0,i.vV)({kind:"CreateTableNode",table:e,columns:(0,i.vV)([])}),cloneWithColumn:(e,t)=>(0,i.vV)({...e,columns:(0,i.vV)([...e.columns,t])}),cloneWithConstraint:(e,t)=>(0,i.vV)({...e,constraints:e.constraints?(0,i.vV)([...e.constraints,t]):(0,i.vV)([t])}),cloneWithFrontModifier:(e,t)=>(0,i.vV)({...e,frontModifiers:e.frontModifiers?(0,i.vV)([...e.frontModifiers,t]):(0,i.vV)([t])}),cloneWithEndModifier:(e,t)=>(0,i.vV)({...e,endModifiers:e.endModifiers?(0,i.vV)([...e.endModifiers,t]):(0,i.vV)([t])}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})});var l=r(9445);let c=(0,i.vV)({is:e=>"DropIndexNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"DropIndexNode",name:l.j.create(e),...t}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})}),u=(0,i.vV)({is:e=>"DropSchemaNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"DropSchemaNode",schema:s.T.create(e),...t}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})}),p=(0,i.vV)({is:e=>"DropTableNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"DropTableNode",table:e,...t}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})});var m=r(24004);let f=(0,i.vV)({is:e=>"AddColumnNode"===e.kind,create:e=>(0,i.vV)({kind:"AddColumnNode",column:e})});var y=r(41504);let N=(0,i.vV)({is:e=>"ColumnDefinitionNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"ColumnDefinitionNode",column:y.k.create(e),dataType:t}),cloneWithFrontModifier:(e,t)=>(0,i.vV)({...e,frontModifiers:e.frontModifiers?(0,i.vV)([...e.frontModifiers,t]):[t]}),cloneWithEndModifier:(e,t)=>(0,i.vV)({...e,endModifiers:e.endModifiers?(0,i.vV)([...e.endModifiers,t]):[t]}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})}),b=(0,i.vV)({is:e=>"DropColumnNode"===e.kind,create:e=>(0,i.vV)({kind:"DropColumnNode",column:y.k.create(e)})}),w=(0,i.vV)({is:e=>"RenameColumnNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"RenameColumnNode",column:y.k.create(e),renameTo:y.k.create(t)})});var g=r(59075);let v=(0,i.vV)({is:e=>"CheckConstraintNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"CheckConstraintNode",expression:e,name:t?s.T.create(t):void 0})}),k=["no action","restrict","cascade","set null","set default"],x=(0,i.vV)({is:e=>"ReferencesNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"ReferencesNode",table:e,columns:(0,i.vV)([...t])}),cloneWithOnDelete:(e,t)=>(0,i.vV)({...e,onDelete:t}),cloneWithOnUpdate:(e,t)=>(0,i.vV)({...e,onUpdate:t})});var I=r(68547),T=r(88961),O=r(83496),C=r(96307);function B(e){return(0,O.x)(e)?e.toOperationNode():C.g.createImmediate(e)}let W=(0,i.vV)({is:e=>"GeneratedNode"===e.kind,create:e=>(0,i.vV)({kind:"GeneratedNode",...e}),createWithExpression:e=>(0,i.vV)({kind:"GeneratedNode",always:!0,expression:e}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})}),V=(0,i.vV)({is:e=>"DefaultValueNode"===e.kind,create:e=>(0,i.vV)({kind:"DefaultValueNode",defaultValue:e})});function A(e){if(k.includes(e))return e;throw Error(`invalid OnModifyForeignAction ${e}`)}class q{#u;constructor(e){this.#u=e}autoIncrement(){return new q(N.cloneWith(this.#u,{autoIncrement:!0}))}primaryKey(){return new q(N.cloneWith(this.#u,{primaryKey:!0}))}references(e){let t=(0,T.KX)(e);if(!t.table||I.B.is(t.column))throw Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new q(N.cloneWith(this.#u,{references:x.create(t.table,[t.column])}))}onDelete(e){if(!this.#u.references)throw Error("on delete constraint can only be added for foreign keys");return new q(N.cloneWith(this.#u,{references:x.cloneWithOnDelete(this.#u.references,A(e))}))}onUpdate(e){if(!this.#u.references)throw Error("on update constraint can only be added for foreign keys");return new q(N.cloneWith(this.#u,{references:x.cloneWithOnUpdate(this.#u.references,A(e))}))}unique(){return new q(N.cloneWith(this.#u,{unique:!0}))}notNull(){return new q(N.cloneWith(this.#u,{notNull:!0}))}unsigned(){return new q(N.cloneWith(this.#u,{unsigned:!0}))}defaultTo(e){return new q(N.cloneWith(this.#u,{defaultTo:V.create(B(e))}))}check(e){return new q(N.cloneWith(this.#u,{check:v.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new q(N.cloneWith(this.#u,{generated:W.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new q(N.cloneWith(this.#u,{generated:W.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new q(N.cloneWith(this.#u,{generated:W.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#u.generated)throw Error("stored() can only be called after generatedAlwaysAs");return new q(N.cloneWith(this.#u,{generated:W.cloneWith(this.#u.generated,{stored:!0})}))}modifyFront(e){return new q(N.cloneWithFrontModifier(this.#u,e.toOperationNode()))}modifyEnd(e){return new q(N.cloneWithEndModifier(this.#u,e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return this.#u}}(0,g.q)(q,"don't await ColumnDefinitionBuilder instances directly.");let S=(0,i.vV)({is:e=>"ModifyColumnNode"===e.kind,create:e=>(0,i.vV)({kind:"ModifyColumnNode",column:e})}),E=(0,i.vV)({is:e=>"DataTypeNode"===e.kind,create:e=>(0,i.vV)({kind:"DataTypeNode",dataType:e})});function P(e){return(0,O.x)(e)?e.toOperationNode():E.create(e)}let D=(0,i.vV)({is:e=>"ForeignKeyConstraintNode"===e.kind,create:(e,t,r,n)=>(0,i.vV)({kind:"ForeignKeyConstraintNode",columns:e,references:x.create(t,r),name:n?s.T.create(n):void 0}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})});class _{#u;constructor(e){this.#u=e}onDelete(e){return new _(D.cloneWith(this.#u,{onDelete:A(e)}))}onUpdate(e){return new _(D.cloneWith(this.#u,{onUpdate:A(e)}))}$call(e){return e(this)}toOperationNode(){return this.#u}}(0,g.q)(_,"don't await ForeignKeyConstraintBuilder instances directly.");let L=(0,i.vV)({is:e=>"AddConstraintNode"===e.kind,create:e=>(0,i.vV)({kind:"AddConstraintNode",constraint:e})}),R=(0,i.vV)({is:e=>"UniqueConstraintNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"UniqueConstraintNode",columns:(0,i.vV)(e.map(y.k.create)),name:t?s.T.create(t):void 0})}),M=(0,i.vV)({is:e=>"DropConstraintNode"===e.kind,create:e=>(0,i.vV)({kind:"DropConstraintNode",constraintName:s.T.create(e)}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})}),U=(0,i.vV)({is:e=>"AlterColumnNode"===e.kind,create:(e,t,r)=>(0,i.vV)({kind:"AlterColumnNode",column:y.k.create(e),[t]:r})});class F{#y;constructor(e){this.#y=e}setDataType(e){return new j(U.create(this.#y,"dataType",P(e)))}setDefault(e){return new j(U.create(this.#y,"setDefault",B(e)))}dropDefault(){return new j(U.create(this.#y,"dropDefault",!0))}setNotNull(){return new j(U.create(this.#y,"setNotNull",!0))}dropNotNull(){return new j(U.create(this.#y,"dropNotNull",!0))}$call(e){return e(this)}}class j{#N;constructor(e){this.#N=e}toOperationNode(){return this.#N}}class ${#e;constructor(e){this.#e=(0,i.vV)(e)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)($,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");class Q{#e;constructor(e){this.#e=(0,i.vV)(e)}onDelete(e){return new Q({...this.#e,constraintBuilder:this.#e.constraintBuilder.onDelete(e)})}onUpdate(e){return new Q({...this.#e,constraintBuilder:this.#e.constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(n.cloneWithTableProps(this.#e.node,{addConstraint:L.create(this.#e.constraintBuilder.toOperationNode())}),this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(Q,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");class J{#e;constructor(e){this.#e=(0,i.vV)(e)}ifExists(){return new J({...this.#e,node:n.cloneWithTableProps(this.#e.node,{dropConstraint:M.cloneWith(this.#e.node.dropConstraint,{ifExists:!0})})})}cascade(){return new J({...this.#e,node:n.cloneWithTableProps(this.#e.node,{dropConstraint:M.cloneWith(this.#e.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new J({...this.#e,node:n.cloneWithTableProps(this.#e.node,{dropConstraint:M.cloneWith(this.#e.node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(J,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");let K=(0,i.vV)({is:e=>"PrimaryKeyConstraintNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"PrimaryKeyConstraintNode",columns:(0,i.vV)(e.map(y.k.create)),name:t?s.T.create(t):void 0})});class z{#e;constructor(e){this.#e=(0,i.vV)(e)}renameTo(e){return new $({...this.#e,node:n.cloneWithTableProps(this.#e.node,{renameTo:(0,m.G2)(e)})})}setSchema(e){return new $({...this.#e,node:n.cloneWithTableProps(this.#e.node,{setSchema:s.T.create(e)})})}alterColumn(e,t){let r=t(new F(e));return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,r.toOperationNode())})}dropColumn(e){return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,b.create(e))})}renameColumn(e,t){return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,w.create(e,t))})}addColumn(e,t,r=i.ZT){let s=r(new q(N.create(e,P(t))));return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,f.create(s.toOperationNode()))})}modifyColumn(e,t,r=i.ZT){let s=r(new q(N.create(e,P(t))));return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,S.create(s.toOperationNode()))})}addUniqueConstraint(e,t){return new $({...this.#e,node:n.cloneWithTableProps(this.#e.node,{addConstraint:L.create(R.create(t,e))})})}addCheckConstraint(e,t){return new $({...this.#e,node:n.cloneWithTableProps(this.#e.node,{addConstraint:L.create(v.create(t.toOperationNode(),e))})})}addForeignKeyConstraint(e,t,r,i){return new Q({...this.#e,constraintBuilder:new _(D.create(t.map(y.k.create),(0,m.G2)(r),i.map(y.k.create),e))})}addPrimaryKeyConstraint(e,t){return new $({...this.#e,node:n.cloneWithTableProps(this.#e.node,{addConstraint:L.create(K.create(t,e))})})}dropConstraint(e){return new J({...this.#e,node:n.cloneWithTableProps(this.#e.node,{dropConstraint:M.create(e)})})}$call(e){return e(this)}}class H{#e;constructor(e){this.#e=(0,i.vV)(e)}alterColumn(e,t){let r=t(new F(e));return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,r.toOperationNode())})}dropColumn(e){return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,b.create(e))})}renameColumn(e,t){return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,w.create(e,t))})}addColumn(e,t,r=i.ZT){let s=r(new q(N.create(e,P(t))));return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,f.create(s.toOperationNode()))})}modifyColumn(e,t,r=i.ZT){let s=r(new q(N.create(e,P(t))));return new H({...this.#e,node:n.cloneWithColumnAlteration(this.#e.node,S.create(s.toOperationNode()))})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(z,"don't await AlterTableBuilder instances"),(0,g.q)(F,"don't await AlterColumnBuilder instances"),(0,g.q)(H,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");var G=r(21282),X=r(5152),Z=r(96016),Y=r(40361);class ee extends Y.s{transformValue(e){return{...super.transformValue(e),immediate:!0}}}class et{#e;constructor(e){this.#e=(0,i.vV)(e)}ifNotExists(){return new et({...this.#e,node:o.cloneWith(this.#e.node,{ifNotExists:!0})})}unique(){return new et({...this.#e,node:o.cloneWith(this.#e.node,{unique:!0})})}on(e){return new et({...this.#e,node:o.cloneWith(this.#e.node,{table:(0,m.G2)(e)})})}column(e){return new et({...this.#e,node:o.cloneWithColumns(this.#e.node,[(0,T.Dz)(e)])})}columns(e){return new et({...this.#e,node:o.cloneWithColumns(this.#e.node,e.map(T.Dz))})}expression(e){return new et({...this.#e,node:o.cloneWithColumns(this.#e.node,[e.toOperationNode()])})}using(e){return new et({...this.#e,node:o.cloneWith(this.#e.node,{using:G.x.createWithSql(e)})})}where(...e){let t=new ee;return new et({...this.#e,node:Z.V.cloneWithWhere(this.#e.node,t.transformNode((0,X.k0)(e)))})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(et,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");class er{#e;constructor(e){this.#e=(0,i.vV)(e)}ifNotExists(){return new er({...this.#e,node:a.cloneWith(this.#e.node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(er,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");class ei{#e;constructor(e){this.#e=(0,i.vV)(e)}temporary(){return new ei({...this.#e,node:h.cloneWith(this.#e.node,{temporary:!0})})}onCommit(e){return new ei({...this.#e,node:h.cloneWith(this.#e.node,{onCommit:function(e){if(d.includes(e))return e;throw Error(`invalid OnCommitAction ${e}`)}(e)})})}ifNotExists(){return new ei({...this.#e,node:h.cloneWith(this.#e.node,{ifNotExists:!0})})}addColumn(e,t,r=i.ZT){let n=r(new q(N.create(e,P(t))));return new ei({...this.#e,node:h.cloneWithColumn(this.#e.node,n.toOperationNode())})}addPrimaryKeyConstraint(e,t){return new ei({...this.#e,node:h.cloneWithConstraint(this.#e.node,K.create(t,e))})}addUniqueConstraint(e,t){return new ei({...this.#e,node:h.cloneWithConstraint(this.#e.node,R.create(t,e))})}addCheckConstraint(e,t){return new ei({...this.#e,node:h.cloneWithConstraint(this.#e.node,v.create(t.toOperationNode(),e))})}addForeignKeyConstraint(e,t,r,n,s=i.ZT){let o=s(new _(D.create(t.map(y.k.create),(0,m.G2)(r),n.map(y.k.create),e)));return new ei({...this.#e,node:h.cloneWithConstraint(this.#e.node,o.toOperationNode())})}modifyFront(e){return new ei({...this.#e,node:h.cloneWithFrontModifier(this.#e.node,e.toOperationNode())})}modifyEnd(e){return new ei({...this.#e,node:h.cloneWithEndModifier(this.#e.node,e.toOperationNode())})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(ei,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");class en{#e;constructor(e){this.#e=(0,i.vV)(e)}on(e){return new en({...this.#e,node:c.cloneWith(this.#e.node,{table:(0,m.G2)(e)})})}ifExists(){return new en({...this.#e,node:c.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new en({...this.#e,node:c.cloneWith(this.#e.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(en,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");class es{#e;constructor(e){this.#e=(0,i.vV)(e)}ifExists(){return new es({...this.#e,node:u.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new es({...this.#e,node:u.cloneWith(this.#e.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(es,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");class eo{#e;constructor(e){this.#e=(0,i.vV)(e)}ifExists(){return new eo({...this.#e,node:p.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new eo({...this.#e,node:p.cloneWith(this.#e.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(eo,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");var ea=r(29798),ed=r(4351),eh=r(80005);class el{#b=new ee;transformQuery(e){return this.#b.transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}class ec{#e;constructor(e){this.#e=(0,i.vV)(e)}temporary(){return new ec({...this.#e,node:eh.B.cloneWith(this.#e.node,{temporary:!0})})}materialized(){return new ec({...this.#e,node:eh.B.cloneWith(this.#e.node,{materialized:!0})})}ifNotExists(){return new ec({...this.#e,node:eh.B.cloneWith(this.#e.node,{ifNotExists:!0})})}orReplace(){return new ec({...this.#e,node:eh.B.cloneWith(this.#e.node,{orReplace:!0})})}columns(e){return new ec({...this.#e,node:eh.B.cloneWith(this.#e.node,{columns:e.map(T.xM)})})}as(e){let t=e.withPlugin(new el).toOperationNode();return new ec({...this.#e,node:eh.B.cloneWith(this.#e.node,{as:t})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(ec,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");let eu=(0,i.vV)({is:e=>"DropViewNode"===e.kind,create:e=>(0,i.vV)({kind:"DropViewNode",name:l.j.create(e)}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})});class ep{#e;constructor(e){this.#e=(0,i.vV)(e)}materialized(){return new ep({...this.#e,node:eu.cloneWith(this.#e.node,{materialized:!0})})}ifExists(){return new ep({...this.#e,node:eu.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new ep({...this.#e,node:eu.cloneWith(this.#e.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(ep,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");var em=r(76031);let ef=(0,i.vV)({is:e=>"CreateTypeNode"===e.kind,create:e=>(0,i.vV)({kind:"CreateTypeNode",name:e}),cloneWithEnum:(e,t)=>(0,i.vV)({...e,enum:em.F.create(t.map(e=>C.g.createImmediate(e)))})});class ey{#e;constructor(e){this.#e=(0,i.vV)(e)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}asEnum(e){return new ey({...this.#e,node:ef.cloneWithEnum(this.#e.node,e)})}$call(e){return e(this)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}(0,g.q)(ey,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");let eN=(0,i.vV)({is:e=>"DropTypeNode"===e.kind,create:e=>(0,i.vV)({kind:"DropTypeNode",name:e}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})});class eb{#e;constructor(e){this.#e=(0,i.vV)(e)}ifExists(){return new eb({...this.#e,node:eN.cloneWith(this.#e.node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile(),this.#e.queryId)}}function ew(e){if(!e.includes("."))return l.j.create(e);{let t=e.split(".").map(eg);if(2===t.length)return l.j.createWithSchema(t[0],t[1]);throw Error(`invalid schemable identifier ${e}`)}}function eg(e){return e.trim()}(0,g.q)(eb,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");class ev{#w;constructor(e){this.#w=e}createTable(e){return new ei({queryId:(0,ea.y)(),executor:this.#w,node:h.create((0,m.G2)(e))})}dropTable(e){return new eo({queryId:(0,ea.y)(),executor:this.#w,node:p.create((0,m.G2)(e))})}createIndex(e){return new et({queryId:(0,ea.y)(),executor:this.#w,node:o.create(e)})}dropIndex(e){return new en({queryId:(0,ea.y)(),executor:this.#w,node:c.create(e)})}createSchema(e){return new er({queryId:(0,ea.y)(),executor:this.#w,node:a.create(e)})}dropSchema(e){return new es({queryId:(0,ea.y)(),executor:this.#w,node:u.create(e)})}alterTable(e){return new z({queryId:(0,ea.y)(),executor:this.#w,node:n.create((0,m.G2)(e))})}createView(e){return new ec({queryId:(0,ea.y)(),executor:this.#w,node:eh.B.create(e)})}dropView(e){return new ep({queryId:(0,ea.y)(),executor:this.#w,node:eu.create(e)})}createType(e){return new ey({queryId:(0,ea.y)(),executor:this.#w,node:ef.create(ew(e))})}dropType(e){return new eb({queryId:(0,ea.y)(),executor:this.#w,node:eN.create(ew(e))})}withPlugin(e){return new ev(this.#w.withPlugin(e))}withoutPlugins(){return new ev(this.#w.withoutPlugins())}withSchema(e){return new ev(this.#w.withPluginAtFront(new ed.v(e)))}}var ek=r(75185);class ex{ref(e){return new ek.Q(e)}}class eI{#g;constructor(e){this.#g=e}async provideConnection(e){let t=await this.#g.acquireConnection();try{return await e(t)}finally{await this.#g.releaseConnection(t)}}}var eT=r(52463),eO=r(26508);class eC extends eO.u{#v;#k;#x;constructor(e,t,r,i=[]){super(i),this.#v=e,this.#k=t,this.#x=r}get adapter(){return this.#k}compileQuery(e){return this.#v.compileQuery(e)}provideConnection(e){return this.#x.provideConnection(e)}withPlugins(e){return new eC(this.#v,this.#k,this.#x,[...this.plugins,...e])}withPlugin(e){return new eC(this.#v,this.#k,this.#x,[...this.plugins,e])}withPluginAtFront(e){return new eC(this.#v,this.#k,this.#x,[e,...this.plugins])}withConnectionProvider(e){return new eC(this.#v,this.#k,e,[...this.plugins])}withoutPlugins(){return new eC(this.#v,this.#k,this.#x,[])}}function eB(){return"undefined"!=typeof performance&&(0,i.mf)(performance.now)?performance.now():Date.now()}class eW{#g;#I;#T;#O;#C;#B=new WeakSet;constructor(e,t){this.#O=!1,this.#g=e,this.#I=t}async init(){if(this.#C)throw Error("driver has already been destroyed");this.#T||(this.#T=this.#g.init().then(()=>{this.#O=!0}).catch(e=>(this.#T=void 0,Promise.reject(e)))),await this.#T}async acquireConnection(){if(this.#C)throw Error("driver has already been destroyed");this.#O||await this.init();let e=await this.#g.acquireConnection();return this.#B.has(e)||(this.#W()&&this.#V(e),this.#B.add(e)),e}async releaseConnection(e){await this.#g.releaseConnection(e)}beginTransaction(e,t){return this.#g.beginTransaction(e,t)}commitTransaction(e){return this.#g.commitTransaction(e)}rollbackTransaction(e){return this.#g.rollbackTransaction(e)}async destroy(){this.#T&&(await this.#T,this.#C||(this.#C=this.#g.destroy().catch(e=>(this.#C=void 0,Promise.reject(e)))),await this.#C)}#W(){return this.#I.isLevelEnabled("query")||this.#I.isLevelEnabled("error")}#V(e){let t=e.executeQuery;e.executeQuery=async r=>{let i=eB();try{return await t.call(e,r)}catch(e){throw await this.#A(e,r,i),e}finally{await this.#q(r,i)}}}async #A(e,t,r){await this.#I.error(()=>({level:"error",error:e,query:t,queryDurationMillis:this.#S(r)}))}async #q(e,t){await this.#I.query(()=>({level:"query",query:e,queryDurationMillis:this.#S(t)}))}#S(e){return eB()-e}}class eV{#E;#P;constructor(e){this.#E=e}async provideConnection(e){for(;this.#P;)await this.#P;let t=this.#D(e);return this.#P=t.then(()=>{this.#P=void 0}).catch(()=>{this.#P=void 0}),t}async #D(e){return await e(this.#E)}}let eA=["read uncommitted","read committed","repeatable read","serializable"];var eq=r(20540);(0,i.vV)(["query","error"]);class eS{#_;#L;constructor(e){(0,i.mf)(e)?(this.#L=e,this.#_=(0,i.vV)({query:!0,error:!0})):(this.#L=eE,this.#_=(0,i.vV)({query:e.includes("query"),error:e.includes("error")}))}isLevelEnabled(e){return this.#_[e]}async query(e){this.#_.query&&await this.#L(e())}async error(e){this.#_.error&&await this.#L(e())}}function eE(e){"query"===e.level?(console.log(`kysely:query: ${e.query.sql}`),console.log(`kysely:query: duration: ${e.queryDurationMillis.toFixed(1)}ms`)):"error"===e.level&&(e.error instanceof Error?console.error(`kysely:error: ${e.error.stack??e.error.message}`):console.error(`kysely:error: ${e}`))}var eP=r(31528),eD=r(99875),e_=r(77836);class eL extends eT.x{#e;constructor(e){let t,r;if(function(e){return(0,i.Kn)(e)&&(0,i.Kn)(e.config)&&(0,i.Kn)(e.driver)&&(0,i.Kn)(e.executor)&&(0,i.Kn)(e.dialect)}(e))t={executor:e.executor},r={...e};else{let i=e.dialect,n=i.createDriver(),s=i.createQueryCompiler(),o=i.createAdapter(),a=new eW(n,new eS(e.log??[])),d=new eC(s,o,new eI(a),e.plugins??[]);t={executor:d},r={config:e,executor:d,dialect:i,driver:a}}super(t),this.#e=(0,i.vV)(r)}get schema(){return new ev(this.#e.executor)}get dynamic(){return new ex}get introspection(){return this.#e.dialect.createIntrospector(this.withoutPlugins())}case(e){return new eP.wY({node:eD.j.create((0,i.o8)(e)?void 0:(0,e_.BJ)(e))})}get fn(){return(0,eq.W)()}transaction(){return new eU({...this.#e})}connection(){return new eM({...this.#e})}withPlugin(e){return new eL({...this.#e,executor:this.#e.executor.withPlugin(e)})}withoutPlugins(){return new eL({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(e){return new eL({...this.#e,executor:this.#e.executor.withPluginAtFront(new ed.v(e))})}withTables(){return new eL({...this.#e})}async destroy(){await this.#e.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#e.executor}executeQuery(e,t=(0,ea.y)()){let r=(0,i.Kn)(e)&&(0,i.mf)(e.compile)?e.compile():e;return this.getExecutor().executeQuery(r,t)}}class eR extends eL{#e;constructor(e){super(e),this.#e=e}get isTransaction(){return!0}transaction(){throw Error("calling the transaction method for a Transaction is not supported")}connection(){throw Error("calling the connection method for a Transaction is not supported")}async destroy(){throw Error("calling the destroy method for a Transaction is not supported")}withPlugin(e){return new eR({...this.#e,executor:this.#e.executor.withPlugin(e)})}withoutPlugins(){return new eR({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(e){return new eR({...this.#e,executor:this.#e.executor.withPluginAtFront(new ed.v(e))})}withTables(){return new eR({...this.#e})}}class eM{#e;constructor(e){this.#e=(0,i.vV)(e)}async execute(e){return this.#e.executor.provideConnection(async t=>{let r=this.#e.executor.withConnectionProvider(new eV(t)),i=new eL({...this.#e,executor:r});return await e(i)})}}(0,g.q)(eM,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");class eU{#e;constructor(e){this.#e=(0,i.vV)(e)}setIsolationLevel(e){return new eU({...this.#e,isolationLevel:e})}async execute(e){let{isolationLevel:t,...r}=this.#e,i={isolationLevel:t};return function(e){if(e.isolationLevel&&!eA.includes(e.isolationLevel))throw Error(`invalid transaction isolation level ${e.isolationLevel}`)}(i),this.#e.executor.provideConnection(async t=>{let n=this.#e.executor.withConnectionProvider(new eV(t)),s=new eR({...r,executor:n});try{await this.#e.driver.beginTransaction(t,i);let r=await e(s);return await this.#e.driver.commitTransaction(t),r}catch(e){throw await this.#e.driver.rollbackTransaction(t),e}})}}(0,g.q)(eU,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method")},40488:(e,t,r)=>{r.d(t,{i:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"AliasNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"AliasNode",node:e,alias:t})})},25477:(e,t,r)=>{r.d(t,{O:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"AndNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"AndNode",left:e,right:t})})},74559:(e,t,r)=>{r.d(t,{a:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"BinaryOperationNode"===e.kind,create:(e,t,r)=>(0,i.vV)({kind:"BinaryOperationNode",leftOperand:e,operator:t,rightOperand:r})})},99875:(e,t,r)=>{r.d(t,{j:()=>s});var i=r(87090),n=r(71827);let s=(0,i.vV)({is:e=>"CaseNode"===e.kind,create:e=>(0,i.vV)({kind:"CaseNode",value:e}),cloneWithWhen:(e,t)=>(0,i.vV)({...e,when:(0,i.vV)(e.when?[...e.when,t]:[t])}),cloneWithThen:(e,t)=>(0,i.vV)({...e,when:e.when?(0,i.vV)([...e.when.slice(0,-1),n.$.cloneWithResult(e.when[e.when.length-1],t)]):void 0}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})})},41504:(e,t,r)=>{r.d(t,{k:()=>s});var i=r(87090),n=r(92528);let s=(0,i.vV)({is:e=>"ColumnNode"===e.kind,create:e=>(0,i.vV)({kind:"ColumnNode",column:n.T.create(e)})})},80005:(e,t,r)=>{r.d(t,{B:()=>s});var i=r(87090),n=r(9445);let s=(0,i.vV)({is:e=>"CreateViewNode"===e.kind,create:e=>(0,i.vV)({kind:"CreateViewNode",name:n.j.create(e)}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})})},30621:(e,t,r)=>{r.d(t,{U:()=>a});var i=r(87090),n=r(81247),s=r(48610);let o=(0,i.vV)({is:e=>"UsingNode"===e.kind,create:e=>(0,i.vV)({kind:"UsingNode",tables:(0,i.vV)(e)}),cloneWithTables:(e,t)=>(0,i.vV)({...e,tables:(0,i.vV)([...e.tables,...t])})}),a=(0,i.vV)({is:e=>"DeleteQueryNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"DeleteQueryNode",from:n.e.create(e),...t&&{with:t}}),cloneWithOrderByItems:(e,t)=>(0,i.vV)({...e,orderBy:e.orderBy?s.r.cloneWithItems(e.orderBy,t):s.r.create(t)}),cloneWithLimit:(e,t)=>(0,i.vV)({...e,limit:t}),cloneWithUsing:(e,t)=>(0,i.vV)({...e,using:void 0!==e.using?o.cloneWithTables(e.using,t):o.create(t)})})},81247:(e,t,r)=>{r.d(t,{e:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"FromNode"===e.kind,create:e=>(0,i.vV)({kind:"FromNode",froms:(0,i.vV)(e)}),cloneWithFroms:(e,t)=>(0,i.vV)({...e,froms:(0,i.vV)([...e.froms,...t])})})},92528:(e,t,r)=>{r.d(t,{T:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"IdentifierNode"===e.kind,create:e=>(0,i.vV)({kind:"IdentifierNode",name:e})})},30246:(e,t,r)=>{r.d(t,{P:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"InsertQueryNode"===e.kind,create:(e,t,r)=>(0,i.vV)({kind:"InsertQueryNode",into:e,...t&&{with:t},replace:r}),cloneWith:(e,t)=>(0,i.vV)({...e,...t})})},94492:(e,t,r)=>{r.d(t,{u:()=>a});var i=r(87090),n=r(25477),s=r(99344);let o=(0,i.vV)({is:e=>"OnNode"===e.kind,create:e=>(0,i.vV)({kind:"OnNode",on:e}),cloneWithOperation:(e,t,r)=>(0,i.vV)({...e,on:"And"===t?n.O.create(e.on,r):s.O.create(e.on,r)})}),a=(0,i.vV)({is:e=>"JoinNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"JoinNode",joinType:e,table:t,on:void 0}),createWithOn:(e,t,r)=>(0,i.vV)({kind:"JoinNode",joinType:e,table:t,on:o.create(r)}),cloneWithOn:(e,t)=>(0,i.vV)({...e,on:e.on?o.cloneWithOperation(e.on,"And",t):o.create(t)})})},37900:(e,t,r)=>{r.d(t,{s:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"JSONOperatorChainNode"===e.kind,create:e=>(0,i.vV)({kind:"JSONOperatorChainNode",operator:e,values:(0,i.vV)([])}),cloneWithValue:(e,t)=>(0,i.vV)({...e,values:(0,i.vV)([...e.values,t])})})},57697:(e,t,r)=>{r.d(t,{t:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"JSONPathNode"===e.kind,create:e=>(0,i.vV)({kind:"JSONPathNode",inOperator:e,pathLegs:(0,i.vV)([])}),cloneWithLeg:(e,t)=>(0,i.vV)({...e,pathLegs:(0,i.vV)([...e.pathLegs,t])})})},65575:(e,t,r)=>{r.d(t,{y:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"JSONReferenceNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"JSONReferenceNode",reference:e,traversal:t}),cloneWithTraversal:(e,t)=>(0,i.vV)({...e,traversal:t})})},89800:(e,t,r)=>{r.d(t,{Z:()=>s});var i=r(87090),n=r(96307);let s=(0,i.vV)({is:e=>"LimitNode"===e.kind,create:e=>(0,i.vV)({kind:"LimitNode",limit:n.g.create(e)})})},83496:(e,t,r)=>{r.d(t,{x:()=>n});var i=r(87090);function n(e){return(0,i.Kn)(e)&&(0,i.mf)(e.toOperationNode)}},40361:(e,t,r)=>{r.d(t,{s:()=>n});var i=r(87090);class n{nodeStack=[];#R=(0,i.vV)({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this)});transformNode(e){if(!e)return e;this.nodeStack.push(e);let t=this.transformNodeImpl(e);return this.nodeStack.pop(),(0,i.vV)(t)}transformNodeImpl(e){return this.#R[e.kind](e)}transformNodeList(e){return e?(0,i.vV)(e.map(e=>this.transformNode(e))):e}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:(0,i.vV)([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where)}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),materialized:e.materialized,expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformTuple(e){return{kind:"TupleNode",values:this.transformNodeList(e.values)}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}},37353:(e,t,r)=>{r.d(t,{$X:()=>o,fP:()=>s,rt:()=>a});var i=r(87090);let n=["->","->>"],s=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","&&","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","+","-","*","/","%","^","&","|","#","<<",">>","&&","||",...n,"not","-","exists","not exists","between","between symmetric"],o=(0,i.vV)({is:e=>"OperatorNode"===e.kind,create:e=>(0,i.vV)({kind:"OperatorNode",operator:e})});function a(e){return(0,i.HD)(e)&&n.includes(e)}},99344:(e,t,r)=>{r.d(t,{O:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"OrNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"OrNode",left:e,right:t})})},48610:(e,t,r)=>{r.d(t,{r:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"OrderByNode"===e.kind,create:e=>(0,i.vV)({kind:"OrderByNode",items:(0,i.vV)([...e])}),cloneWithItems:(e,t)=>(0,i.vV)({...e,items:(0,i.vV)([...e.items,...t])})})},36007:(e,t,r)=>{r.d(t,{L:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"ParensNode"===e.kind,create:e=>(0,i.vV)({kind:"ParensNode",node:e})})},26309:(e,t,r)=>{r.d(t,{c:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"PrimitiveValueListNode"===e.kind,create:e=>(0,i.vV)({kind:"PrimitiveValueListNode",values:(0,i.vV)([...e])})})},96016:(e,t,r)=>{r.d(t,{V:()=>c});var i=r(30246),n=r(51508),s=r(86921),o=r(30621),a=r(17017),d=r(87090);let h=(0,d.vV)({is:e=>"ReturningNode"===e.kind,create:e=>(0,d.vV)({kind:"ReturningNode",selections:(0,d.vV)(e)}),cloneWithSelections:(e,t)=>(0,d.vV)({...e,selections:e.selections?(0,d.vV)([...e.selections,...t]):(0,d.vV)(t)})}),l=(0,d.vV)({is:e=>"ExplainNode"===e.kind,create:(e,t)=>(0,d.vV)({kind:"ExplainNode",format:e,options:t})}),c=(0,d.vV)({is:e=>n.a.is(e)||i.P.is(e)||s.j.is(e)||o.U.is(e),cloneWithWhere:(e,t)=>(0,d.vV)({...e,where:e.where?a.F.cloneWithOperation(e.where,"And",t):a.F.create(t)}),cloneWithJoin:(e,t)=>(0,d.vV)({...e,joins:e.joins?(0,d.vV)([...e.joins,t]):(0,d.vV)([t])}),cloneWithReturning:(e,t)=>(0,d.vV)({...e,returning:e.returning?h.cloneWithSelections(e.returning,t):h.create(t)}),cloneWithoutWhere:e=>(0,d.vV)({...e,where:void 0}),cloneWithExplain:(e,t,r)=>(0,d.vV)({...e,explain:l.create(t,r?.toOperationNode())})})},21282:(e,t,r)=>{r.d(t,{x:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"RawNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"RawNode",sqlFragments:(0,i.vV)(e),parameters:(0,i.vV)(t)}),createWithSql:e=>n.create([e],[]),createWithChild:e=>n.create(["",""],[e]),createWithChildren:e=>n.create(Array(e.length+1).fill(""),e)})},8225:(e,t,r)=>{r.d(t,{b:()=>s});var i=r(68547),n=r(87090);let s=(0,n.vV)({is:e=>"ReferenceNode"===e.kind,create:(e,t)=>(0,n.vV)({kind:"ReferenceNode",table:t,column:e}),createSelectAll:e=>(0,n.vV)({kind:"ReferenceNode",table:e,column:i.B.create()})})},9445:(e,t,r)=>{r.d(t,{j:()=>s});var i=r(87090),n=r(92528);let s=(0,i.vV)({is:e=>"SchemableIdentifierNode"===e.kind,create:e=>(0,i.vV)({kind:"SchemableIdentifierNode",identifier:n.T.create(e)}),createWithSchema:(e,t)=>(0,i.vV)({kind:"SchemableIdentifierNode",schema:n.T.create(e),identifier:n.T.create(t)})})},68547:(e,t,r)=>{r.d(t,{B:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"SelectAllNode"===e.kind,create:()=>(0,i.vV)({kind:"SelectAllNode"})})},51508:(e,t,r)=>{r.d(t,{a:()=>l});var i=r(87090),n=r(81247);let s=(0,i.vV)({is:e=>"GroupByNode"===e.kind,create:e=>(0,i.vV)({kind:"GroupByNode",items:(0,i.vV)(e)}),cloneWithItems:(e,t)=>(0,i.vV)({...e,items:(0,i.vV)([...e.items,...t])})});var o=r(25477),a=r(99344);let d=(0,i.vV)({is:e=>"HavingNode"===e.kind,create:e=>(0,i.vV)({kind:"HavingNode",having:e}),cloneWithOperation:(e,t,r)=>(0,i.vV)({...e,having:"And"===t?o.O.create(e.having,r):a.O.create(e.having,r)})});var h=r(48610);let l=(0,i.vV)({is:e=>"SelectQueryNode"===e.kind,create:e=>(0,i.vV)({kind:"SelectQueryNode",...e&&{with:e}}),createFrom:(e,t)=>(0,i.vV)({kind:"SelectQueryNode",from:n.e.create(e),...t&&{with:t}}),cloneWithSelections:(e,t)=>(0,i.vV)({...e,selections:e.selections?(0,i.vV)([...e.selections,...t]):(0,i.vV)(t)}),cloneWithDistinctOn:(e,t)=>(0,i.vV)({...e,distinctOn:e.distinctOn?(0,i.vV)([...e.distinctOn,...t]):(0,i.vV)(t)}),cloneWithFrontModifier:(e,t)=>(0,i.vV)({...e,frontModifiers:e.frontModifiers?(0,i.vV)([...e.frontModifiers,t]):(0,i.vV)([t])}),cloneWithEndModifier:(e,t)=>(0,i.vV)({...e,endModifiers:e.endModifiers?(0,i.vV)([...e.endModifiers,t]):(0,i.vV)([t])}),cloneWithOrderByItems:(e,t)=>(0,i.vV)({...e,orderBy:e.orderBy?h.r.cloneWithItems(e.orderBy,t):h.r.create(t)}),cloneWithGroupByItems:(e,t)=>(0,i.vV)({...e,groupBy:e.groupBy?s.cloneWithItems(e.groupBy,t):s.create(t)}),cloneWithLimit:(e,t)=>(0,i.vV)({...e,limit:t}),cloneWithOffset:(e,t)=>(0,i.vV)({...e,offset:t}),cloneWithHaving:(e,t)=>(0,i.vV)({...e,having:e.having?d.cloneWithOperation(e.having,"And",t):d.create(t)}),cloneWithSetOperations:(e,t)=>(0,i.vV)({...e,setOperations:e.setOperations?(0,i.vV)([...e.setOperations,...t]):(0,i.vV)([...t])}),cloneWithoutSelections:e=>(0,i.vV)({...e,selections:[]}),cloneWithoutLimit:e=>(0,i.vV)({...e,limit:void 0}),cloneWithoutOffset:e=>(0,i.vV)({...e,offset:void 0}),cloneWithoutOrderBy:e=>(0,i.vV)({...e,orderBy:void 0})})},74613:(e,t,r)=>{r.d(t,{M:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"SetOperationNode"===e.kind,create:(e,t,r)=>(0,i.vV)({kind:"SetOperationNode",operator:e,expression:t,all:r})})},78711:(e,t,r)=>{r.d(t,{F:()=>s});var i=r(87090),n=r(9445);let s=(0,i.vV)({is:e=>"TableNode"===e.kind,create:e=>(0,i.vV)({kind:"TableNode",table:n.j.create(e)}),createWithSchema:(e,t)=>(0,i.vV)({kind:"TableNode",table:n.j.createWithSchema(e,t)})})},86921:(e,t,r)=>{r.d(t,{j:()=>s});var i=r(87090),n=r(81247);let s=(0,i.vV)({is:e=>"UpdateQueryNode"===e.kind,create:(e,t)=>(0,i.vV)({kind:"UpdateQueryNode",table:e,...t&&{with:t}}),cloneWithFromItems:(e,t)=>(0,i.vV)({...e,from:e.from?n.e.cloneWithFroms(e.from,t):n.e.create(t)}),cloneWithUpdates:(e,t)=>(0,i.vV)({...e,updates:e.updates?(0,i.vV)([...e.updates,...t]):t})})},76031:(e,t,r)=>{r.d(t,{F:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"ValueListNode"===e.kind,create:e=>(0,i.vV)({kind:"ValueListNode",values:(0,i.vV)(e)})})},96307:(e,t,r)=>{r.d(t,{g:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"ValueNode"===e.kind,create:e=>(0,i.vV)({kind:"ValueNode",value:e}),createImmediate:e=>(0,i.vV)({kind:"ValueNode",value:e,immediate:!0})})},71827:(e,t,r)=>{r.d(t,{$:()=>n});var i=r(87090);let n=(0,i.vV)({is:e=>"WhenNode"===e.kind,create:e=>(0,i.vV)({kind:"WhenNode",condition:e}),cloneWithResult:(e,t)=>(0,i.vV)({...e,result:t})})},17017:(e,t,r)=>{r.d(t,{F:()=>o});var i=r(87090),n=r(25477),s=r(99344);let o=(0,i.vV)({is:e=>"WhereNode"===e.kind,create:e=>(0,i.vV)({kind:"WhereNode",where:e}),cloneWithOperation:(e,t,r)=>(0,i.vV)({...e,where:"And"===t?n.O.create(e.where,r):s.O.create(e.where,r)})})},5152:(e,t,r)=>{r.d(t,{L4:()=>f,Li:()=>y,QX:()=>N,i9:()=>m,k0:()=>p});var i=r(74559),n=r(87090),s=r(83496),o=r(37353),a=r(88961),d=r(33321),h=r(96307),l=r(25477),c=r(36007),u=r(99344);function p(e){if(3===e.length)return m(e[0],e[1],e[2]);if(1===e.length)return(0,d.j2)(e[0]);throw Error(`invalid arguments: ${JSON.stringify(e)}`)}function m(e,t,r){return("is"===t||"is not"===t)&&b(r)?i.a.create((0,a.jI)(e),w(t),h.g.createImmediate(r)):i.a.create((0,a.jI)(e),w(t),(0,d.wZ)(r))}function f(e,t,r){return i.a.create((0,a.jI)(e),w(t),(0,a.jI)(r))}function y(e,t){return N(Object.entries(e).filter(([,e])=>!(0,n.o8)(e)).map(([e,t])=>m(e,b(t)?"is":"=",t)),t)}function N(e,t){let r="and"===t?l.O.create:u.O.create;if(0===e.length)return h.g.createImmediate("and"===t);let i=g(e[0]);for(let t=1;t<e.length;++t)i=r(i,g(e[t]));return e.length>1?c.L.create(i):i}function b(e){return(0,n.Ft)(e)||(0,n.jn)(e)}function w(e){if((0,n.HD)(e)&&o.fP.includes(e))return o.$X.create(e);if((0,s.x)(e))return e.toOperationNode();throw Error(`invalid operator ${JSON.stringify(e)}`)}function g(e){return(0,s.x)(e)?e.toOperationNode():e}},77836:(e,t,r)=>{r.d(t,{Yb:()=>d,Jx:()=>a,BJ:()=>o});var i=r(83496),n=r(87090),s=r(36172);function o(e){if((0,i.x)(e))return e.toOperationNode();if((0,n.mf)(e))return e((0,s.Z)()).toOperationNode();throw Error(`invalid expression: ${JSON.stringify(e)}`)}function a(e){if((0,i.x)(e))return e.toOperationNode();if((0,n.mf)(e))return e((0,s.Z)()).toOperationNode();throw Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function d(e){return(0,n.Kn)(e)&&"expressionType"in e&&(0,i.x)(e)||(0,n.Kn)(e)&&"expression"in e&&(0,n.HD)(e.alias)&&(0,i.x)(e)||(0,n.mf)(e)}},1615:(e,t,r)=>{r.d(t,{h:()=>a});var i=r(94492),n=r(24004),s=r(5152),o=r(30103);function a(e,t){var r,a,d,h;if(3===t.length)return r=t[0],a=t[1],d=t[2],i.u.createWithOn(e,(0,n.Lr)(r),(0,s.L4)(a,"=",d));if(2===t.length)return h=t[0],(0,t[1])((0,o.$h)(e,h)).toOperationNode();throw Error("not implemented")}},34139:(e,t,r)=>{r.d(t,{Wr:()=>h,bX:()=>l});var i=r(75185),n=r(87090);let s=(0,n.vV)({is:e=>"OrderByItemNode"===e.kind,create:(e,t)=>(0,n.vV)({kind:"OrderByItemNode",orderBy:e,direction:t})});var o=r(21282),a=r(77836),d=r(88961);function h(e){return"asc"===e||"desc"===e}function l(e){if(2===e.length)return[c(e[0],e[1])];if(1===e.length){let[t]=e;return Array.isArray(t)?t.map(e=>c(e)):[c(t)]}throw Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function c(e,t){let r=function(e){if((0,a.Yb)(e))return(0,a.BJ)(e);if((0,i.a)(e))return e.toOperationNode();let[t,r]=e.split(" ");if(r){if(!h(r))throw Error(`Invalid order by direction: ${r}`);return s.create((0,d.KX)(t),u(r))}return(0,d.KX)(e)}(e);if(s.is(r)){if(t)throw Error("Cannot specify direction twice!");return r}return s.create(r,u(t))}function u(e){return e?"asc"===e||"desc"===e?o.x.createWithSql(e):e.toOperationNode():void 0}},30103:(e,t,r)=>{r.d(t,{$h:()=>g,gs:()=>v,$l:()=>w});var i=r(94492),n=r(87090),s=r(48610);let o=(0,n.vV)({is:e=>"PartitionByNode"===e.kind,create:e=>(0,n.vV)({kind:"PartitionByNode",items:(0,n.vV)(e)}),cloneWithItems:(e,t)=>(0,n.vV)({...e,items:(0,n.vV)([...e.items,...t])})}),a=(0,n.vV)({is:e=>"OverNode"===e.kind,create:()=>(0,n.vV)({kind:"OverNode"}),cloneWithOrderByItems:(e,t)=>(0,n.vV)({...e,orderBy:e.orderBy?s.r.cloneWithItems(e.orderBy,t):s.r.create(t)}),cloneWithPartitionByItems:(e,t)=>(0,n.vV)({...e,partitionBy:e.partitionBy?o.cloneWithItems(e.partitionBy,t):o.create(t)})});var d=r(21282),h=r(5152),l=r(59075);class c{#e;constructor(e){this.#e=(0,n.vV)(e)}on(...e){return new c({...this.#e,joinNode:i.u.cloneWithOn(this.#e.joinNode,(0,h.k0)(e))})}onRef(e,t,r){return new c({...this.#e,joinNode:i.u.cloneWithOn(this.#e.joinNode,(0,h.L4)(e,t,r))})}onTrue(){return new c({...this.#e,joinNode:i.u.cloneWithOn(this.#e.joinNode,d.x.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return this.#e.joinNode}}(0,l.q)(c,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");var u=r(34139);let p=(0,n.vV)({is:e=>"PartitionByItemNode"===e.kind,create:e=>(0,n.vV)({kind:"PartitionByItemNode",partitionBy:e})});var m=r(88961);class f{#e;constructor(e){this.#e=(0,n.vV)(e)}orderBy(e,t){return new f({overNode:a.cloneWithOrderByItems(this.#e.overNode,(0,u.bX)([e,t]))})}partitionBy(e){return new f({overNode:a.cloneWithPartitionByItems(this.#e.overNode,(0,m.ik)(e).map(p.create))})}$call(e){return e(this)}toOperationNode(){return this.#e.overNode}}(0,l.q)(f,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");var y=r(52463),N=r(60904),b=r(24004);function w(){return new y.x({executor:N.H})}function g(e,t){return new c({joinNode:i.u.create(e,(0,b.Lr)(t))})}function v(){return new f({overNode:a.create()})}},88961:(e,t,r)=>{r.d(t,{D2:()=>b,Dz:()=>k,F9:()=>f,Ji:()=>g,KX:()=>w,ik:()=>y,jI:()=>N,xM:()=>v});var i=r(40488),n=r(41504),s=r(8225),o=r(78711),a=r(87090),d=r(77836),h=r(92528),l=r(34139),c=r(37353),u=r(65575),p=r(37900),m=r(57697);function f(e){return(0,a.HD)(e)?w(e):e.toOperationNode()}function y(e){return(0,a.DM)(e)?e.map(e=>N(e)):[N(e)]}function N(e){return(0,d.Yb)(e)?(0,d.BJ)(e):f(e)}function b(e,t){let r=w(e);if((0,c.rt)(t))return u.y.create(r,p.s.create(c.$X.create(t)));let i=t.slice(0,-1);if((0,c.rt)(i))return u.y.create(r,m.t.create(c.$X.create(i)));throw Error(`Invalid JSON operator: ${t}`)}function w(e){if(!e.includes("."))return s.b.create(n.k.create(e));let t=e.split(".").map(x);if(3===t.length)return function(e){let[t,r,i]=e;return s.b.create(n.k.create(i),o.F.createWithSchema(t,r))}(t);if(2===t.length)return function(e){let[t,r]=e;return s.b.create(n.k.create(r),o.F.create(t))}(t);throw Error(`invalid column reference ${e}`)}function g(e){let t=" as ";if(!e.includes(t))return w(e);{let[r,n]=e.split(t).map(x);return i.i.create(w(r),h.T.create(n))}}function v(e){return n.k.create(e)}function k(e){if(!e.includes(" "))return v(e);{let[t,r]=e.split(" ").map(x);if(!(0,l.Wr)(r))throw Error(`invalid order direction "${r}" next to "${t}"`);return(0,l.bX)([t,r])[0]}}function x(e){return e.trim()}},34581:(e,t,r)=>{r.d(t,{L:()=>p,A:()=>function e(t){return(0,i.mf)(t)?e(t((0,c.Z)())):(0,i.DM)(t)?t.map(e=>u(e)):[u(t)]}});var i=r(87090),n=r(8225),s=r(68547);let o=(0,i.vV)({is:e=>"SelectionNode"===e.kind,create:e=>(0,i.vV)({kind:"SelectionNode",selection:e}),createSelectAll:()=>(0,i.vV)({kind:"SelectionNode",selection:s.B.create()}),createSelectAllFromTable:e=>(0,i.vV)({kind:"SelectionNode",selection:n.b.createSelectAll(e)})});var a=r(88961),d=r(75185),h=r(77836),l=r(24004),c=r(36172);function u(e){return(0,i.HD)(e)?o.create((0,a.Ji)(e)):(0,d.a)(e)?o.create(e.toOperationNode()):o.create((0,h.Jx)(e))}function p(e){return e?Array.isArray(e)?e.map(m):[m(e)]:[o.createSelectAll()]}function m(e){if((0,i.HD)(e))return o.createSelectAllFromTable((0,l.G2)(e));throw Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}},24004:(e,t,r)=>{r.d(t,{G2:()=>l,Lr:()=>h,_V:()=>d});var i=r(87090),n=r(40488),s=r(78711),o=r(77836),a=r(92528);function d(e){return(0,i.DM)(e)?e.map(e=>h(e)):[h(e)]}function h(e){return(0,i.HD)(e)?function(e){let t=" as ";if(!e.includes(t))return l(e);{let[r,i]=e.split(t).map(c);return n.i.create(l(r),a.T.create(i))}}(e):(0,o.Jx)(e)}function l(e){if(!e.includes("."))return s.F.create(e);{let[t,r]=e.split(".").map(c);return s.F.createWithSchema(t,r)}}function c(e){return e.trim()}},33321:(e,t,r)=>{r.d(t,{$0:()=>l,AB:()=>c,j2:()=>h,wZ:()=>d});var i=r(26309),n=r(76031),s=r(96307),o=r(87090),a=r(77836);function d(e){return(0,o.DM)(e)?e.some(a.Yb)?n.F.create(e.map(e=>h(e))):i.c.create(e):h(e)}function h(e){return(0,a.Yb)(e)?(0,a.BJ)(e):s.g.create(e)}function l(e){return(0,o.hj)(e)||(0,o.jn)(e)||(0,o.Ft)(e)}function c(e){if(!l(e))throw Error(`unsafe immediate value ${JSON.stringify(e)}`);return s.g.createImmediate(e)}},4351:(e,t,r)=>{r.d(t,{v:()=>l});var i=r(40488),n=r(92528),s=r(40361),o=r(9445),a=r(78711);let d=(0,r(87090).vV)({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0});class h extends s.s{#M;#U=new Set;#F=new Set;constructor(e){super(),this.#M=e}transformNodeImpl(e){if(!this.#j(e))return super.transformNodeImpl(e);let t=this.#$(e);for(let e of t)this.#F.add(e);let r=this.#Q(e);for(let e of r)this.#U.add(e);let i=super.transformNodeImpl(e);for(let e of r)this.#U.delete(e);for(let e of t)this.#F.delete(e);return i}transformSchemableIdentifier(e){let t=super.transformSchemableIdentifier(e);return t.schema||!this.#U.has(e.identifier.name)?t:{...t,schema:n.T.create(this.#M)}}transformReferences(e){let t=super.transformReferences(e);return t.table.table.schema?t:{...t,table:a.F.createWithSchema(this.#M,t.table.table.identifier.name)}}#j(e){return e.kind in d}#Q(e){let t=new Set;if("name"in e&&e.name&&o.j.is(e.name)&&this.#J(e.name,t),"from"in e&&e.from)for(let r of e.from.froms)this.#K(r,t);if("into"in e&&e.into&&this.#K(e.into,t),"table"in e&&e.table&&this.#K(e.table,t),"joins"in e&&e.joins)for(let r of e.joins)this.#K(r.table,t);return t}#$(e){let t=new Set;return"with"in e&&e.with&&this.#z(e.with,t),t}#K(e,t){let r=a.F.is(e)?e:i.i.is(e)&&a.F.is(e.node)?e.node:null;r&&this.#J(r.table,t)}#J(e,t){let r=e.identifier.name;this.#U.has(r)||this.#F.has(r)||t.add(r)}#z(e,t){for(let r of e.expressions){let e=r.name.table.table.identifier.name;this.#F.has(e)||t.add(e)}}}class l{#b;constructor(e){this.#b=new h(e)}transformQuery(e){return this.#b.transformNode(e.node)}async transformResult(e){return e.result}}},31528:(e,t,r)=>{r.d(t,{wY:()=>h});var i=r(70295),n=r(87090),s=r(99875),o=r(71827),a=r(5152),d=r(33321);class h{#e;constructor(e){this.#e=(0,n.vV)(e)}when(...e){return new l({...this.#e,node:s.j.cloneWithWhen(this.#e.node,o.$.create((0,a.k0)(e)))})}}class l{#e;constructor(e){this.#e=(0,n.vV)(e)}then(e){return new c({...this.#e,node:s.j.cloneWithThen(this.#e.node,(0,d.$0)(e)?(0,d.AB)(e):(0,d.j2)(e))})}}class c{#e;constructor(e){this.#e=(0,n.vV)(e)}when(...e){return new l({...this.#e,node:s.j.cloneWithWhen(this.#e.node,o.$.create((0,a.k0)(e)))})}else(e){return new u({...this.#e,node:s.j.cloneWith(this.#e.node,{else:(0,d.$0)(e)?(0,d.AB)(e):(0,d.j2)(e)})})}end(){return new i.Pc(s.j.cloneWith(this.#e.node,{isStatement:!1}))}endCase(){return new i.Pc(s.j.cloneWith(this.#e.node,{isStatement:!0}))}}class u{#e;constructor(e){this.#e=(0,n.vV)(e)}end(){return new i.Pc(s.j.cloneWith(this.#e.node,{isStatement:!1}))}endCase(){return new i.Pc(s.j.cloneWith(this.#e.node,{isStatement:!0}))}}},20540:(e,t,r)=>{r.d(t,{W:()=>N});var i=r(70295),n=r(87090),s=r(17017);let o=(0,n.vV)({is:e=>"AggregateFunctionNode"===e.kind,create:(e,t=[])=>(0,n.vV)({kind:"AggregateFunctionNode",func:e,aggregated:t}),cloneWithDistinct:e=>(0,n.vV)({...e,distinct:!0}),cloneWithFilter:(e,t)=>(0,n.vV)({...e,filter:e.filter?s.F.cloneWithOperation(e.filter,"And",t):s.F.create(t)}),cloneWithOrFilter:(e,t)=>(0,n.vV)({...e,filter:e.filter?s.F.cloneWithOperation(e.filter,"Or",t):s.F.create(t)}),cloneWithOver:(e,t)=>(0,n.vV)({...e,over:t})}),a=(0,n.vV)({is:e=>"FunctionNode"===e.kind,create:(e,t)=>(0,n.vV)({kind:"FunctionNode",func:e,arguments:t})});var d=r(88961),h=r(34581),l=r(40488),c=r(92528),u=r(59075),p=r(30103),m=r(5152);class f{#e;constructor(e){this.#e=(0,n.vV)(e)}get expressionType(){}as(e){return new y(this,e)}distinct(){return new f({...this.#e,aggregateFunctionNode:o.cloneWithDistinct(this.#e.aggregateFunctionNode)})}filterWhere(...e){return new f({...this.#e,aggregateFunctionNode:o.cloneWithFilter(this.#e.aggregateFunctionNode,(0,m.k0)(e))})}filterWhereRef(e,t,r){return new f({...this.#e,aggregateFunctionNode:o.cloneWithFilter(this.#e.aggregateFunctionNode,(0,m.L4)(e,t,r))})}over(e){let t=(0,p.gs)();return new f({...this.#e,aggregateFunctionNode:o.cloneWithOver(this.#e.aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}toOperationNode(){return this.#e.aggregateFunctionNode}}(0,u.q)(f,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class y{#H;#s;constructor(e,t){this.#H=e,this.#s=t}get expression(){return this.#H}get alias(){return this.#s}toOperationNode(){return l.i.create(this.#H.toOperationNode(),c.T.create(this.#s))}}function N(){let e=(e,t)=>new i.Pc(a.create(e,(0,d.ik)(t))),t=(e,t)=>new f({aggregateFunctionNode:o.create(e,t?(0,d.ik)(t):void 0)});return Object.assign(e,{agg:t,avg:e=>t("avg",[e]),coalesce:(t,...r)=>e("coalesce",[t,...r]),count:e=>t("count",[e]),countAll:e=>new f({aggregateFunctionNode:o.create("count",(0,h.L)(e))}),max:e=>t("max",[e]),min:e=>t("min",[e]),sum:e=>t("sum",[e]),any:t=>e("any",[t])})}},84206:(e,t,r)=>{r.d(t,{G:()=>i,b:()=>n});class i extends Error{node;constructor(e){super("no result"),this.node=e}}function n(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}},89458:(e,t,r)=>{r.d(t,{u:()=>O});var i=r(40488),n=r(87090);let s=(0,n.vV)({is:e=>"SelectModifierNode"===e.kind,create:e=>(0,n.vV)({kind:"SelectModifierNode",modifier:e}),createWithExpression:e=>(0,n.vV)({kind:"SelectModifierNode",rawModifier:e})});var o=r(1615),a=r(34581),d=r(88961),h=r(51508),l=r(96016),c=r(34139),u=r(59075),p=r(89800),m=r(96307);let f=(0,n.vV)({is:e=>"OffsetNode"===e.kind,create:e=>(0,n.vV)({kind:"OffsetNode",offset:m.g.create(e)})}),y=(0,n.vV)({is:e=>"GroupByItemNode"===e.kind,create:e=>(0,n.vV)({kind:"GroupByItemNode",groupBy:e})});var N=r(36172),b=r(84206),w=r(92528),g=r(74613),v=r(77836);function k(e,t,r){return(0,n.mf)(t)&&(t=t((0,N.b)())),(0,n.DM)(t)||(t=[t]),t.map(t=>g.M.create(e,(0,v.BJ)(t),r))}var x=r(5152),I=r(70295);class T{#e;constructor(e){this.#e=(0,n.vV)(e)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new T({...this.#e,queryNode:l.V.cloneWithWhere(this.#e.queryNode,(0,x.k0)(e))})}whereRef(e,t,r){return new T({...this.#e,queryNode:l.V.cloneWithWhere(this.#e.queryNode,(0,x.L4)(e,t,r))})}having(...e){return new T({...this.#e,queryNode:h.a.cloneWithHaving(this.#e.queryNode,(0,x.k0)(e))})}havingRef(e,t,r){return new T({...this.#e,queryNode:h.a.cloneWithHaving(this.#e.queryNode,(0,x.L4)(e,t,r))})}select(e){return new T({...this.#e,queryNode:h.a.cloneWithSelections(this.#e.queryNode,(0,a.A)(e))})}distinctOn(e){return new T({...this.#e,queryNode:h.a.cloneWithDistinctOn(this.#e.queryNode,(0,d.ik)(e))})}modifyFront(e){return new T({...this.#e,queryNode:h.a.cloneWithFrontModifier(this.#e.queryNode,s.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new T({...this.#e,queryNode:h.a.cloneWithEndModifier(this.#e.queryNode,s.createWithExpression(e.toOperationNode()))})}distinct(){return new T({...this.#e,queryNode:h.a.cloneWithFrontModifier(this.#e.queryNode,s.create("Distinct"))})}forUpdate(){return new T({...this.#e,queryNode:h.a.cloneWithEndModifier(this.#e.queryNode,s.create("ForUpdate"))})}forShare(){return new T({...this.#e,queryNode:h.a.cloneWithEndModifier(this.#e.queryNode,s.create("ForShare"))})}forKeyShare(){return new T({...this.#e,queryNode:h.a.cloneWithEndModifier(this.#e.queryNode,s.create("ForKeyShare"))})}forNoKeyUpdate(){return new T({...this.#e,queryNode:h.a.cloneWithEndModifier(this.#e.queryNode,s.create("ForNoKeyUpdate"))})}skipLocked(){return new T({...this.#e,queryNode:h.a.cloneWithEndModifier(this.#e.queryNode,s.create("SkipLocked"))})}noWait(){return new T({...this.#e,queryNode:h.a.cloneWithEndModifier(this.#e.queryNode,s.create("NoWait"))})}selectAll(e){return new T({...this.#e,queryNode:h.a.cloneWithSelections(this.#e.queryNode,(0,a.L)(e))})}innerJoin(...e){return new T({...this.#e,queryNode:l.V.cloneWithJoin(this.#e.queryNode,(0,o.h)("InnerJoin",e))})}leftJoin(...e){return new T({...this.#e,queryNode:l.V.cloneWithJoin(this.#e.queryNode,(0,o.h)("LeftJoin",e))})}rightJoin(...e){return new T({...this.#e,queryNode:l.V.cloneWithJoin(this.#e.queryNode,(0,o.h)("RightJoin",e))})}fullJoin(...e){return new T({...this.#e,queryNode:l.V.cloneWithJoin(this.#e.queryNode,(0,o.h)("FullJoin",e))})}innerJoinLateral(...e){return new T({...this.#e,queryNode:l.V.cloneWithJoin(this.#e.queryNode,(0,o.h)("LateralInnerJoin",e))})}leftJoinLateral(...e){return new T({...this.#e,queryNode:l.V.cloneWithJoin(this.#e.queryNode,(0,o.h)("LateralLeftJoin",e))})}orderBy(...e){return new T({...this.#e,queryNode:h.a.cloneWithOrderByItems(this.#e.queryNode,(0,c.bX)(e))})}groupBy(e){var t;return new T({...this.#e,queryNode:h.a.cloneWithGroupByItems(this.#e.queryNode,(t=e,t=(0,n.mf)(t)?t((0,N.Z)()):t,(0,d.ik)(t).map(y.create)))})}limit(e){return new T({...this.#e,queryNode:h.a.cloneWithLimit(this.#e.queryNode,p.Z.create(e))})}offset(e){return new T({...this.#e,queryNode:h.a.cloneWithOffset(this.#e.queryNode,f.create(e))})}union(e){return new T({...this.#e,queryNode:h.a.cloneWithSetOperations(this.#e.queryNode,k("union",e,!1))})}unionAll(e){return new T({...this.#e,queryNode:h.a.cloneWithSetOperations(this.#e.queryNode,k("union",e,!0))})}intersect(e){return new T({...this.#e,queryNode:h.a.cloneWithSetOperations(this.#e.queryNode,k("intersect",e,!1))})}intersectAll(e){return new T({...this.#e,queryNode:h.a.cloneWithSetOperations(this.#e.queryNode,k("intersect",e,!0))})}except(e){return new T({...this.#e,queryNode:h.a.cloneWithSetOperations(this.#e.queryNode,k("except",e,!1))})}exceptAll(e){return new T({...this.#e,queryNode:h.a.cloneWithSetOperations(this.#e.queryNode,k("except",e,!0))})}as(e){return new C(this,e)}clearSelect(){return new T({...this.#e,queryNode:h.a.cloneWithoutSelections(this.#e.queryNode)})}clearWhere(){return new T({...this.#e,queryNode:l.V.cloneWithoutWhere(this.#e.queryNode)})}clearLimit(){return new T({...this.#e,queryNode:h.a.cloneWithoutLimit(this.#e.queryNode)})}clearOffset(){return new T({...this.#e,queryNode:h.a.cloneWithoutOffset(this.#e.queryNode)})}clearOrderBy(){return new T({...this.#e,queryNode:h.a.cloneWithoutOrderBy(this.#e.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new T({...this.#e})}$castTo(){return new T(this.#e)}$narrowType(){return new T(this.#e)}$assertType(){return new T(this.#e)}$asTuple(){return new I.Pc(this.toOperationNode())}withPlugin(e){return new T({...this.#e,executor:this.#e.executor.withPlugin(e)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){let e=this.compile();return(await this.#e.executor.executeQuery(e,this.#e.queryId)).rows}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=b.G){let t=await this.executeTakeFirst();if(void 0===t)throw(0,b.b)(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#e.executor.stream(t,e,this.#e.queryId))yield*r.rows}async explain(e,t){let r=new T({...this.#e,queryNode:l.V.cloneWithExplain(this.#e.queryNode,e,t)});return await r.execute()}}function O(e){return new T(e)}(0,u.q)(T,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class C{#G;#s;constructor(e,t){this.#G=e,this.#s=t}get expression(){return this.#G}get alias(){return this.#s}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return i.i.create(this.#G.toOperationNode(),w.T.create(this.#s))}}(0,u.q)(C,"don't await AliasedSelectQueryBuilder instances directly. AliasedSelectQueryBuilder should never be executed directly since it's always a part of another query.")},52463:(e,t,r)=>{r.d(t,{x:()=>X});var i=r(89458),n=r(34581),s=r(41504),o=r(26309),a=r(76031),d=r(87090),h=r(33321);let l=(0,d.vV)({is:e=>"ValuesNode"===e.kind,create:e=>(0,d.vV)({kind:"ValuesNode",values:(0,d.vV)(e)})});var c=r(77836);let u=(0,d.vV)({is:e=>"DefaultInsertValueNode"===e.kind,create:()=>(0,d.vV)({kind:"DefaultInsertValueNode"})});var p=r(36172),m=r(30246),f=r(96016);let y=(0,d.vV)({is:e=>"ColumnUpdateNode"===e.kind,create:(e,t)=>(0,d.vV)({kind:"ColumnUpdateNode",column:e,value:t})});function N(e){return Object.entries((0,d.mf)(e)?e((0,p.Z)()):e).filter(([e,t])=>void 0!==t).map(([e,t])=>y.create(s.k.create(e),(0,h.j2)(t)))}var b=r(59075);let w=(0,d.vV)({is:e=>"OnDuplicateKeyNode"===e.kind,create:e=>(0,d.vV)({kind:"OnDuplicateKeyNode",updates:e})});class g{insertId;numInsertedOrUpdatedRows;constructor(e,t){this.insertId=e,this.numInsertedOrUpdatedRows=t}}var v=r(84206),k=r(92528),x=r(17017);let I=(0,d.vV)({is:e=>"OnConflictNode"===e.kind,create:()=>(0,d.vV)({kind:"OnConflictNode"}),cloneWith:(e,t)=>(0,d.vV)({...e,...t}),cloneWithIndexWhere:(e,t)=>(0,d.vV)({...e,indexWhere:e.indexWhere?x.F.cloneWithOperation(e.indexWhere,"And",t):x.F.create(t)}),cloneWithIndexOrWhere:(e,t)=>(0,d.vV)({...e,indexWhere:e.indexWhere?x.F.cloneWithOperation(e.indexWhere,"Or",t):x.F.create(t)}),cloneWithUpdateWhere:(e,t)=>(0,d.vV)({...e,updateWhere:e.updateWhere?x.F.cloneWithOperation(e.updateWhere,"And",t):x.F.create(t)}),cloneWithUpdateOrWhere:(e,t)=>(0,d.vV)({...e,updateWhere:e.updateWhere?x.F.cloneWithOperation(e.updateWhere,"Or",t):x.F.create(t)}),cloneWithoutIndexWhere:e=>(0,d.vV)({...e,indexWhere:void 0}),cloneWithoutUpdateWhere:e=>(0,d.vV)({...e,updateWhere:void 0})});var T=r(5152);class O{#e;constructor(e){this.#e=(0,d.vV)(e)}column(e){let t=s.k.create(e);return new O({...this.#e,onConflictNode:I.cloneWith(this.#e.onConflictNode,{columns:this.#e.onConflictNode.columns?(0,d.vV)([...this.#e.onConflictNode.columns,t]):(0,d.vV)([t])})})}columns(e){let t=e.map(s.k.create);return new O({...this.#e,onConflictNode:I.cloneWith(this.#e.onConflictNode,{columns:this.#e.onConflictNode.columns?(0,d.vV)([...this.#e.onConflictNode.columns,...t]):(0,d.vV)(t)})})}constraint(e){return new O({...this.#e,onConflictNode:I.cloneWith(this.#e.onConflictNode,{constraint:k.T.create(e)})})}expression(e){return new O({...this.#e,onConflictNode:I.cloneWith(this.#e.onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new O({...this.#e,onConflictNode:I.cloneWithIndexWhere(this.#e.onConflictNode,(0,T.k0)(e))})}whereRef(e,t,r){return new O({...this.#e,onConflictNode:I.cloneWithIndexWhere(this.#e.onConflictNode,(0,T.L4)(e,t,r))})}clearWhere(){return new O({...this.#e,onConflictNode:I.cloneWithoutIndexWhere(this.#e.onConflictNode)})}doNothing(){return new C({...this.#e,onConflictNode:I.cloneWith(this.#e.onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new B({...this.#e,onConflictNode:I.cloneWith(this.#e.onConflictNode,{updates:N(e)})})}$call(e){return e(this)}}(0,b.q)(O,"don't await OnConflictBuilder instances.");class C{#e;constructor(e){this.#e=(0,d.vV)(e)}toOperationNode(){return this.#e.onConflictNode}}(0,b.q)(C,"don't await OnConflictDoNothingBuilder instances.");class B{#e;constructor(e){this.#e=(0,d.vV)(e)}where(...e){return new B({...this.#e,onConflictNode:I.cloneWithUpdateWhere(this.#e.onConflictNode,(0,T.k0)(e))})}whereRef(e,t,r){return new B({...this.#e,onConflictNode:I.cloneWithUpdateWhere(this.#e.onConflictNode,(0,T.L4)(e,t,r))})}clearWhere(){return new B({...this.#e,onConflictNode:I.cloneWithoutUpdateWhere(this.#e.onConflictNode)})}$call(e){return e(this)}toOperationNode(){return this.#e.onConflictNode}}(0,b.q)(B,"don't await OnConflictUpdateBuilder instances.");class W{#e;constructor(e){this.#e=(0,d.vV)(e)}values(e){let[t,r]=function(e){let t=(0,d.mf)(e)?e((0,p.Z)()):e;return function(e){let t=function(e){let t=new Map;for(let r of e)for(let e of Object.keys(r))t.has(e)||void 0===r[e]||t.set(e,t.size);return t}(e);return[(0,d.vV)([...t.keys()].map(s.k.create)),l.create(e.map(e=>(function(e,t){let r=Object.keys(e),i=Array.from({length:t.size}),n=!1;for(let s of r){let r=t.get(s);if((0,d.o8)(r))continue;let o=e[s];((0,d.o8)(o)||(0,c.Yb)(o))&&(n=!0),i[r]=o}if(r.length<t.size||n){let e=u.create();return a.F.create(i.map(t=>(0,d.o8)(t)?e:(0,h.j2)(t)))}return o.c.create(i)})(e,t)))]}((0,d.DM)(t)?t:(0,d.vV)([t]))}(e);return new W({...this.#e,queryNode:m.P.cloneWith(this.#e.queryNode,{columns:t,values:r})})}columns(e){return new W({...this.#e,queryNode:m.P.cloneWith(this.#e.queryNode,{columns:(0,d.vV)(e.map(s.k.create))})})}expression(e){return new W({...this.#e,queryNode:m.P.cloneWith(this.#e.queryNode,{values:(0,c.BJ)(e)})})}ignore(){return new W({...this.#e,queryNode:m.P.cloneWith(this.#e.queryNode,{ignore:!0})})}onConflict(e){return new W({...this.#e,queryNode:m.P.cloneWith(this.#e.queryNode,{onConflict:e(new O({onConflictNode:I.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new W({...this.#e,queryNode:m.P.cloneWith(this.#e.queryNode,{onDuplicateKey:w.create(N(e))})})}returning(e){return new W({...this.#e,queryNode:f.V.cloneWithReturning(this.#e.queryNode,(0,n.A)(e))})}returningAll(){return new W({...this.#e,queryNode:f.V.cloneWithReturning(this.#e.queryNode,(0,n.L)())})}$call(e){return e(this)}$if(e,t){return e?t(this):new W({...this.#e})}$castTo(){return new W(this.#e)}$narrowType(){return new W(this.#e)}$assertType(){return new W(this.#e)}withPlugin(e){return new W({...this.#e,executor:this.#e.executor.withPlugin(e)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){let e=this.compile(),t=e.query,r=await this.#e.executor.executeQuery(e,this.#e.queryId);return this.#e.executor.adapter.supportsReturning&&t.returning?r.rows:[new g(r.insertId,r.numAffectedRows??r.numUpdatedOrDeletedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=v.G){let t=await this.executeTakeFirst();if(void 0===t)throw(0,v.b)(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#e.executor.stream(t,e,this.#e.queryId))yield*r.rows}async explain(e,t){let r=new W({...this.#e,queryNode:f.V.cloneWithExplain(this.#e.queryNode,e,t)});return await r.execute()}}(0,b.q)(W,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");var V=r(1615),A=r(24004);class q{numDeletedRows;constructor(e){this.numDeletedRows=e}}var S=r(30621),E=r(89800),P=r(34139);class D{#e;constructor(e){this.#e=(0,d.vV)(e)}where(...e){return new D({...this.#e,queryNode:f.V.cloneWithWhere(this.#e.queryNode,(0,T.k0)(e))})}whereRef(e,t,r){return new D({...this.#e,queryNode:f.V.cloneWithWhere(this.#e.queryNode,(0,T.L4)(e,t,r))})}clearWhere(){return new D({...this.#e,queryNode:f.V.cloneWithoutWhere(this.#e.queryNode)})}using(e){return new D({...this.#e,queryNode:S.U.cloneWithUsing(this.#e.queryNode,(0,A._V)(e))})}innerJoin(...e){return new D({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("InnerJoin",e))})}leftJoin(...e){return new D({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("LeftJoin",e))})}rightJoin(...e){return new D({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("RightJoin",e))})}fullJoin(...e){return new D({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("FullJoin",e))})}returning(e){return new D({...this.#e,queryNode:f.V.cloneWithReturning(this.#e.queryNode,(0,n.A)(e))})}returningAll(e){return new D({...this.#e,queryNode:f.V.cloneWithReturning(this.#e.queryNode,(0,n.L)(e))})}orderBy(e,t){return new D({...this.#e,queryNode:S.U.cloneWithOrderByItems(this.#e.queryNode,(0,P.bX)([e,t]))})}limit(e){return new D({...this.#e,queryNode:S.U.cloneWithLimit(this.#e.queryNode,E.Z.create(e))})}$call(e){return e(this)}$if(e,t){return e?t(this):new D({...this.#e})}$castTo(){return new D(this.#e)}$narrowType(){return new D(this.#e)}$assertType(){return new D(this.#e)}withPlugin(e){return new D({...this.#e,executor:this.#e.executor.withPlugin(e)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){let e=this.compile(),t=e.query,r=await this.#e.executor.executeQuery(e,this.#e.queryId);return this.#e.executor.adapter.supportsReturning&&t.returning?r.rows:[new q(r.numAffectedRows??r.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=v.G){let t=await this.executeTakeFirst();if(void 0===t)throw(0,v.b)(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#e.executor.stream(t,e,this.#e.queryId))yield*r.rows}async explain(e,t){let r=new D({...this.#e,queryNode:f.V.cloneWithExplain(this.#e.queryNode,e,t)});return await r.execute()}}(0,b.q)(D,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");var _=r(86921);class L{numUpdatedRows;numChangedRows;constructor(e,t){this.numUpdatedRows=e,this.numChangedRows=t}}class R{#e;constructor(e){this.#e=(0,d.vV)(e)}where(...e){return new R({...this.#e,queryNode:f.V.cloneWithWhere(this.#e.queryNode,(0,T.k0)(e))})}whereRef(e,t,r){return new R({...this.#e,queryNode:f.V.cloneWithWhere(this.#e.queryNode,(0,T.L4)(e,t,r))})}clearWhere(){return new R({...this.#e,queryNode:f.V.cloneWithoutWhere(this.#e.queryNode)})}from(e){return new R({...this.#e,queryNode:_.j.cloneWithFromItems(this.#e.queryNode,(0,A._V)(e))})}innerJoin(...e){return new R({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("InnerJoin",e))})}leftJoin(...e){return new R({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("LeftJoin",e))})}rightJoin(...e){return new R({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("RightJoin",e))})}fullJoin(...e){return new R({...this.#e,queryNode:f.V.cloneWithJoin(this.#e.queryNode,(0,V.h)("FullJoin",e))})}set(e){return new R({...this.#e,queryNode:_.j.cloneWithUpdates(this.#e.queryNode,N(e))})}returning(e){return new R({...this.#e,queryNode:f.V.cloneWithReturning(this.#e.queryNode,(0,n.A)(e))})}returningAll(){return new R({...this.#e,queryNode:f.V.cloneWithReturning(this.#e.queryNode,(0,n.L)())})}$call(e){return e(this)}$if(e,t){return e?t(this):new R({...this.#e})}$castTo(){return new R(this.#e)}$narrowType(){return new R(this.#e)}$assertType(){return new R(this.#e)}withPlugin(e){return new R({...this.#e,executor:this.#e.executor.withPlugin(e)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){let e=this.compile(),t=e.query,r=await this.#e.executor.executeQuery(e,this.#e.queryId);return this.#e.executor.adapter.supportsReturning&&t.returning?r.rows:[new L(r.numAffectedRows??r.numUpdatedOrDeletedRows??BigInt(0),r.numChangedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=v.G){let t=await this.executeTakeFirst();if(void 0===t)throw(0,v.b)(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#e.executor.stream(t,e,this.#e.queryId))yield*r.rows}async explain(e,t){let r=new R({...this.#e,queryNode:f.V.cloneWithExplain(this.#e.queryNode,e,t)});return await r.execute()}}(0,b.q)(R,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");var M=r(51508),U=r(78711);let F=(0,d.vV)({is:e=>"CommonTableExpressionNameNode"===e.kind,create:(e,t)=>(0,d.vV)({kind:"CommonTableExpressionNameNode",table:U.F.create(e),columns:t?(0,d.vV)(t.map(s.k.create)):void 0})});var j=r(30103);let $=(0,d.vV)({is:e=>"CommonTableExpressionNode"===e.kind,create:(e,t)=>(0,d.vV)({kind:"CommonTableExpressionNode",name:e,expression:t}),cloneWith:(e,t)=>(0,d.vV)({...e,...t})});class Q{#e;constructor(e){this.#e=(0,d.vV)(e)}materialized(){return new Q({...this.#e,node:$.cloneWith(this.#e.node,{materialized:!0})})}notMaterialized(){return new Q({...this.#e,node:$.cloneWith(this.#e.node,{materialized:!1})})}toOperationNode(){return this.#e.node}}function J(e,t){let r=t((0,j.$l)()).toOperationNode();return(0,d.mf)(e)?e(e=>new Q({node:$.create(K(e),r)})).toOperationNode():$.create(K(e),r)}function K(e){if(!e.includes("("))return F.create(e);{let t=e.split(/[\(\)]/),r=t[0],i=t[1].split(",").map(e=>e.trim());return F.create(r,i)}}(0,b.q)(Q,"don't await CTEBuilder instances. They are never executed directly and are always just a part of a query.");let z=(0,d.vV)({is:e=>"WithNode"===e.kind,create:(e,t)=>(0,d.vV)({kind:"WithNode",expressions:(0,d.vV)([e]),...t}),cloneWithExpression:(e,t)=>(0,d.vV)({...e,expressions:(0,d.vV)([...e.expressions,t])})});var H=r(29798),G=r(4351);class X{#e;constructor(e){this.#e=(0,d.vV)(e)}selectFrom(e){return(0,i.u)({queryId:(0,H.y)(),executor:this.#e.executor,queryNode:M.a.createFrom((0,A._V)(e),this.#e.withNode)})}selectNoFrom(e){return(0,i.u)({queryId:(0,H.y)(),executor:this.#e.executor,queryNode:M.a.cloneWithSelections(M.a.create(this.#e.withNode),(0,n.A)(e))})}insertInto(e){return new W({queryId:(0,H.y)(),executor:this.#e.executor,queryNode:m.P.create((0,A.G2)(e),this.#e.withNode)})}replaceInto(e){return new W({queryId:(0,H.y)(),executor:this.#e.executor,queryNode:m.P.create((0,A.G2)(e),this.#e.withNode,!0)})}deleteFrom(e){return new D({queryId:(0,H.y)(),executor:this.#e.executor,queryNode:S.U.create((0,A._V)(e),this.#e.withNode)})}updateTable(e){return new R({queryId:(0,H.y)(),executor:this.#e.executor,queryNode:_.j.create((0,A.Lr)(e),this.#e.withNode)})}with(e,t){let r=J(e,t);return new X({...this.#e,withNode:this.#e.withNode?z.cloneWithExpression(this.#e.withNode,r):z.create(r)})}withRecursive(e,t){let r=J(e,t);return new X({...this.#e,withNode:this.#e.withNode?z.cloneWithExpression(this.#e.withNode,r):z.create(r,{recursive:!0})})}withPlugin(e){return new X({...this.#e,executor:this.#e.executor.withPlugin(e)})}withoutPlugins(){return new X({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(e){return new X({...this.#e,executor:this.#e.executor.withPluginAtFront(new G.v(e))})}}},60904:(e,t,r)=>{r.d(t,{H:()=>s});var i=r(26508);class n extends i.u{get adapter(){throw Error("this query cannot be compiled to SQL")}compileQuery(){throw Error("this query cannot be compiled to SQL")}provideConnection(){throw Error("this query cannot be executed")}withConnectionProvider(){throw Error("this query cannot have a connection provider")}withPlugin(e){return new n([...this.plugins,e])}withPlugins(e){return new n([...this.plugins,...e])}withPluginAtFront(e){return new n([e,...this.plugins])}withoutPlugins(){return new n([])}}let s=new n},26508:(e,t,r)=>{r.d(t,{u:()=>a});var i=r(87090);class n{#X;#Z;#Y;constructor(){this.#X=new Promise((e,t)=>{this.#Y=t,this.#Z=e})}get promise(){return this.#X}resolve=e=>{this.#Z&&this.#Z(e)};reject=e=>{this.#Y&&this.#Y(e)}}let s=new Set,o=(0,i.vV)([]);class a{#ee;constructor(e=o){this.#ee=e}get plugins(){return this.#ee}transformQuery(e,t){for(let r of this.#ee){let i=r.transformQuery({node:e,queryId:t});if(i.kind===e.kind)e=i;else throw Error(`KyselyPlugin.transformQuery must return a node of the same kind that was given to it. The plugin was given a ${e.kind} but it returned a ${i.kind}`)}return e}async executeQuery(e,t){return await this.provideConnection(async r=>{let i=await r.executeQuery(e),n=await this.#et(i,t);return function(e,t){let{numAffectedRows:r}=e;if((void 0!==r||void 0!==e.numUpdatedOrDeletedRows)&&(void 0===r||void 0===t.numAffectedRows)){var i;i="kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.",s.has(i)||(s.add(i),console.log(i))}}(i,n),n})}async *stream(e,t,r){let i=new n,s=new n;this.provideConnection(async e=>(i.resolve(e),await s.promise)).catch(e=>i.reject(e));let o=await i.promise;try{for await(let i of o.streamQuery(e,t))yield await this.#et(i,r)}finally{s.resolve()}}async #et(e,t){for(let r of this.#ee)e=await r.transformResult({result:e,queryId:t});return e}}},87090:(e,t,r)=>{function i(e){return void 0===e||void 0===e}function n(e){return"string"==typeof e}function s(e){return"number"==typeof e}function o(e){return"boolean"==typeof e}function a(e){return null===e}function d(e){return e instanceof Date}function h(e){return"bigint"==typeof e}function l(e){return"function"==typeof e}function c(e){return"object"==typeof e&&null!==e}function u(e){return Object.freeze(e)}function p(e){return Array.isArray(e)}function m(e){return e}r.d(t,{C4:()=>h,DM:()=>p,Ft:()=>a,HD:()=>n,J_:()=>d,Kn:()=>c,ZT:()=>m,hj:()=>s,jn:()=>o,mf:()=>l,o8:()=>i,vV:()=>u})},59075:(e,t,r)=>{r.d(t,{q:()=>i});function i(e,t){Object.defineProperties(e.prototype,{then:{enumerable:!1,value:()=>{throw Error(t)}}})}},29798:(e,t,r)=>{r.d(t,{y:()=>n});let i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function n(){return new s}class s{#er;get queryId(){return void 0===this.#er&&(this.#er=function(e){let t="";for(let e=0;e<8;++e)t+=i[~~(Math.random()*i.length)];return t}(0)),this.#er}}}};